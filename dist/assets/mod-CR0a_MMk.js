import{_ as Ae,o as Ee,u as Pe,a as qe,g as Ge,c as re,r,z as Re,$ as je,B as s,C as Ke,d as i,e as y,f as t,w as e,j as a,l as E,k as m,i as p,q as Xe,p as U,m as c,t as u,F as I,v as P,n as x,s as He,X as Je,y as S,A as Qe}from"./index-DLH8rKkR.js";import{s as b}from"./index-B4Rl1bGd.js";import{e as ce}from"./index-C2p8WvF0.js";import We from"./modInfo-pgUDKO7G.js";const Ye={class:"page-div"},Ze={class:"item-container"},et={class:"card-footer",style:{"margin-top":"20px"}},tt={class:"card-header"},at={style:{display:"flex"}},lt={style:{display:"flex","margin-left":"5px","flex-direction":"column","justify-content":"center"}},ot={class:"card-header"},nt=Je({name:"settingsMod"}),dt=Object.assign(nt,{setup(st){Ee(async()=>{await V(),Ce()});const{t:d}=Pe(),{isMobile:v}=qe(),te=Ge(),me=re(()=>te.isDark),ge=re(()=>te.language),ae=r("Download"),pe=(l,n)=>{l.paneName==="Add"&&$(),l.paneName==="Setting"&&le()},h=r([]),q=r(!1),le=()=>{q.value=!0,f.value=0,z.value="",b.mod.settingFormat.get().then(l=>{h.value=l.data}).finally(()=>{q.value=!1})},f=r(0),z=r(""),oe=(l,n)=>{f.value=l,z.value=n,fe()},D=r(!1),L=r({id:"",configOptions:[]}),fe=()=>{D.value=!0,b.mod.configOptions.get({id:f.value}).then(l=>{L.value=l.data}).finally(()=>{D.value=!1})},_e=()=>{D.value=!0,b.mod.configChange.post({modFormattedData:h.value}).then(l=>{S(l.message)}).finally(()=>{D.value=!1})},G=r(!1),O=r({total:0,rows:[]}),ve=r(),g=r({page:1,pageSize:30,searchText:"",searchType:"text"}),V=(l=!0)=>{l&&(g.value.page=1),G.value=!0,ce.modSearch.get(g.value).then(n=>{O.value.rows=n.data.rows,O.value.total=n.data.total,g.value.searchType==="id"&&Re(ge.value==="zh"?"ID搜索不显示评分":"Search by ID will not display the vote data")}).finally(()=>{G.value=!1})},he=l=>{V(!1)},ye=l=>{V(!1)},ne=r([]),R=r(!1),$=()=>{R.value=!0,ce.modInfoDownloaded.get().then(l=>{ne.value=l.data}).finally(()=>{R.value=!1})},j=r(!1),be=()=>{j.value=!0,b.mod.sync.post().then(l=>{S(l.message),$()}).finally(()=>{j.value=!1})},F=r(!1),we=l=>{let n=l.cmd,_=l.row;switch(F.value=!0,n){case"enable":ke(_);break;case"delete":xe(_);break;default:F.value=!1,Qe("error")}},ke=l=>{const _={isUgc:l.file_url==="",id:l.id};b.mod.enable.post(_).then(C=>{S(C.message)}).finally(()=>{F.value=!1})},xe=l=>{const _={isUgc:l.file_url==="",id:l.id};b.mod.delete.post(_).then(C=>{S(C.message),$()}).finally(()=>{F.value=!1})},K=r(!1),Se=()=>{K.value=!0;const n={isUgc:z.value==="",id:f.value};b.mod.disable.post(n).then(_=>{S(_.message),le()}).finally(()=>{K.value=!1})},X=r(""),Ce=()=>{je.osInfo.get().then(l=>{X.value=l.data.Platform})},H=r(!1),Me=()=>{H.value=!0,b.mod.macosExport.post().then(l=>{S(l.message)}).finally(()=>{H.value=!1})},J=r(!1),Ue=()=>{J.value=!0;const l={isUgc:z.value==="",id:f.value,fileURL:z.value};b.mod.update.post(l).then(n=>{S(n.message)}).finally(()=>{J.value=!1})};return(l,n)=>{const _=s("el-option"),C=s("el-select"),w=s("el-button"),ze=s("el-input"),B=s("el-form-item"),de=s("el-form"),Q=s("el-scrollbar"),De=s("el-pagination"),N=s("el-card"),W=s("el-tab-pane"),se=s("el-tooltip"),Ve=s("el-alert"),T=s("el-table-column"),M=s("el-tag"),Fe=s("arrow-down"),Te=s("el-icon"),ie=s("el-dropdown-item"),Ie=s("el-dropdown-menu"),Le=s("el-dropdown"),Oe=s("el-table"),Y=s("el-col"),ue=s("el-row"),$e=s("el-image"),Be=s("el-divider"),Z=s("el-result"),Ne=s("el-tabs"),A=Ke("loading");return i(),y("div",Ye,[t(Ne,{modelValue:ae.value,"onUpdate:modelValue":n[6]||(n[6]=o=>ae.value=o),onTabClick:pe},{default:e(()=>[t(W,{label:a(d)("setting.mod.tab.download"),name:"Download"},{default:e(()=>[E((i(),m(N,{style:{height:"78vh"},shadow:"never"},{default:e(()=>[p("div",null,[t(de,{ref_key:"modSearchFormRef",ref:ve,model:g.value,inline:!0,onKeyup:Xe(V,["enter"])},{default:e(()=>[t(B,null,{default:e(()=>[t(ze,{modelValue:g.value.searchText,"onUpdate:modelValue":n[1]||(n[1]=o=>g.value.searchText=o),style:U(a(v)?"width: 75vw;":"width: 50vw;")},{prepend:e(()=>[t(C,{modelValue:g.value.searchType,"onUpdate:modelValue":n[0]||(n[0]=o=>g.value.searchType=o),style:{width:"85px"}},{default:e(()=>[t(_,{label:l.$t("setting.mod.download.searchTypeText"),value:"text"},null,8,["label"]),t(_,{label:l.$t("setting.mod.download.searchTypeId"),value:"id"},null,8,["label"])]),_:1},8,["modelValue"])]),append:e(()=>[t(w,{type:"primary",onClick:V},{default:e(()=>[c(u(a(d)("setting.mod.download.search")),1)]),_:1})]),_:1},8,["modelValue","style"])]),_:1})]),_:1},8,["model"])]),p("div",null,[t(Q,{"max-height":"60vh"},{default:e(()=>[p("div",Ze,[(i(!0),y(I,null,P(O.value.rows,o=>(i(),m(We,{mod:o},null,8,["mod"]))),256))])]),_:1})]),p("div",et,[t(De,{"current-page":g.value.page,"onUpdate:currentPage":n[2]||(n[2]=o=>g.value.page=o),"page-size":g.value.pageSize,"onUpdate:pageSize":n[3]||(n[3]=o=>g.value.pageSize=o),"page-sizes":[10,20,30,40,50,100],layout:"total, sizes, prev, pager, next",total:O.value.total,onSizeChange:n[4]||(n[4]=o=>he(g.value.pageSize)),onCurrentChange:n[5]||(n[5]=o=>ye(g.value.page))},null,8,["current-page","page-size","total"])])]),_:1})),[[A,G.value]])]),_:1},8,["label"]),t(W,{label:a(d)("setting.mod.tab.add"),name:"Add"},{default:e(()=>[t(ue,{gutter:10},{default:e(()=>[t(Y,{span:24},{default:e(()=>[E((i(),m(N,{style:{height:"70vh"},shadow:"never"},{header:e(()=>[p("div",tt,[p("span",null,u(a(d)("setting.mod.add.header.title")),1),p("div",null,[t(w,{onClick:$},{default:e(()=>[c(u(a(d)("setting.mod.add.header.refresh")),1)]),_:1}),t(se,{effect:"light","show-after":500,content:a(d)("setting.mod.add.header.syncTooltip"),placement:"top"},{default:e(()=>[t(w,{type:"primary",loading:j.value,onClick:be},{default:e(()=>[c(u(a(d)("setting.mod.add.header.sync")),1)]),_:1},8,["loading"])]),_:1},8,["content"]),X.value==="darwin"?(i(),m(w,{key:0,onClick:Me,loading:H.value,type:"success"},{default:e(()=>[c(u(a(d)("setting.mod.add.header.export")),1)]),_:1},8,["loading"])):x("",!0)])])]),default:e(()=>[t(Ve,{closable:!1,effect:me.value?"light":"dark",type:"warning"},{default:e(()=>[c(u(a(d)("setting.mod.add.alert")),1)]),_:1},8,["effect"]),t(Oe,{data:ne.value,border:"",style:{height:"55vh","margin-top":"10px"}},{default:e(()=>[t(T,{label:a(d)("setting.mod.add.table.name"),prop:"name"},null,8,["label"]),t(T,{label:"ID",prop:"id"}),t(T,{label:"UGC"},{default:e(o=>[o.row.file_url===""?(i(),m(M,{key:0,type:"primary"},{default:e(()=>[c(u(a(d)("setting.mod.add.table.ugc.yes")),1)]),_:1})):(i(),m(M,{key:1,type:"info"},{default:e(()=>[c(u(a(d)("setting.mod.add.table.ugc.no")),1)]),_:1}))]),_:1}),t(T,{label:a(d)("setting.mod.add.table.size")},{default:e(o=>[c(u(a(He)(o.row.size)),1)]),_:1},8,["label"]),t(T,{label:a(d)("setting.mod.add.table.action")},{default:e(o=>[t(Le,{onCommand:we,trigger:"click"},{dropdown:e(()=>[t(Ie,null,{default:e(()=>[t(ie,{command:{cmd:"enable",row:o.row}},{default:e(()=>[c(u(a(d)("setting.mod.add.table.enable")),1)]),_:2},1032,["command"]),t(ie,{command:{cmd:"delete",row:o.row}},{default:e(()=>[c(u(a(d)("setting.mod.add.table.delete")),1)]),_:2},1032,["command"])]),_:2},1024)]),default:e(()=>[t(w,{type:"primary",link:"",loading:F.value},{default:e(()=>[c(u(a(d)("setting.mod.add.table.action")),1),t(Te,{class:"el-icon--right"},{default:e(()=>[t(Fe)]),_:1})]),_:1},8,["loading"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})),[[A,R.value]])]),_:1})]),_:1})]),_:1},8,["label"]),X.value!=="darwin"?(i(),m(W,{key:0,label:a(d)("setting.mod.tab.setting"),name:"Setting"},{default:e(()=>[t(ue,{gutter:10},{default:e(()=>[t(Y,{lg:8,md:8,sm:24,span:8,xs:24},{default:e(()=>[E((i(),m(N,{style:U(a(v)?"height: 50vh":"height: 70vh"),shadow:"never"},{default:e(()=>[t(Q,{"max-height":a(v)?"45vh":"65vh"},{default:e(()=>[h.value?(i(!0),y(I,{key:0},P(h.value,(o,k)=>(i(),y(I,null,[p("div",at,[p("div",null,[t($e,{src:o.preview_url,fit:"fill",onClick:ee=>oe(o.id,o.file_url),style:{width:"75px",height:"75px"}},null,8,["src","onClick"])]),p("div",lt,[t(w,{link:"",type:"primary",onClick:ee=>oe(o.id,o.file_url)},{default:e(()=>[c(u(o.name),1)]),_:2},1032,["onClick"]),p("div",null,[o.enable?(i(),m(M,{key:0,type:"success"},{default:e(()=>[c(u(a(d)("setting.mod.setting.left.enable")),1)]),_:1})):x("",!0),o.enable?x("",!0):(i(),m(M,{key:1,type:"info"},{default:e(()=>[c(u(a(d)("setting.mod.setting.left.disable")),1)]),_:1}))])])]),k!==h.value.length-1?(i(),m(Be,{key:0})):x("",!0)],64))),256)):(i(),y("div",{key:1,class:"fcc",style:U(a(v)?"height: 50vh":"height: 70vh")},[t(Z,{icon:"warning",title:a(d)("setting.mod.setting.left.result")},null,8,["title"])],4))]),_:1},8,["max-height"])]),_:1},8,["style"])),[[A,q.value]])]),_:1}),t(Y,{lg:16,md:16,sm:24,span:16,xs:24},{default:e(()=>[E((i(),m(N,{style:U(a(v)?"height: 50vh; margin-top: 10px":"height: 70vh"),shadow:"never"},{header:e(()=>[p("div",ot,[p("span",null,u(a(d)("setting.mod.setting.right.header.title")),1),p("div",null,[t(w,{type:"primary",disabled:f.value===0,loading:J.value,onClick:Ue},{default:e(()=>[c(u(a(d)("setting.mod.setting.right.header.update")),1)]),_:1},8,["disabled","loading"]),t(w,{type:"danger",disabled:f.value===0,loading:K.value,onClick:Se},{default:e(()=>[c(u(a(d)("setting.mod.setting.right.header.disable")),1)]),_:1},8,["disabled","loading"])])])]),default:e(()=>[f.value!==0?(i(),m(Q,{key:0,"max-height":a(v)?"45vh":"65vh"},{default:e(()=>[L.value.configOptions?(i(),m(de,{key:0,ref:"modSettingFormRef",size:a(v)?"small":"large","label-position":a(v)?"top":"left","label-width":a(v)?"70":"auto"},{default:e(()=>[t(B,{label:"ID"},{default:e(()=>[t(M,null,{default:e(()=>[c(u(L.value.id),1)]),_:1})]),_:1}),t(B,{label:a(d)("setting.mod.setting.right.name")},{default:e(()=>[t(M,{type:"info"},{default:e(()=>[c(u(h.value[h.value.findIndex(o=>o.id===f.value)].name),1)]),_:1})]),_:1},8,["label"]),(i(!0),y(I,null,P(L.value.configOptions,o=>(i(),m(se,{"show-after":500,effect:"light",content:o.hover,placement:"top"},{default:e(()=>[t(B,{label:o.label},{default:e(()=>[t(C,{modelValue:h.value[h.value.findIndex(k=>k.id===f.value)].configurationOptions[o.name],"onUpdate:modelValue":k=>h.value[h.value.findIndex(ee=>ee.id===f.value)].configurationOptions[o.name]=k,onChange:_e},{default:e(()=>[(i(!0),y(I,null,P(o.options,k=>(i(),m(_,{label:k.description,value:k.data},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1032,["content"]))),256))]),_:1},8,["size","label-position","label-width"])):(i(),y("div",{key:1,class:"fcc",style:U(a(v)?"height: 40vh; margin-top: 10px":"height: 60vh")},[t(Z,{icon:"info",title:a(d)("setting.mod.setting.right.result")},null,8,["title"])],4))]),_:1},8,["max-height"])):x("",!0),f.value===0?(i(),y("div",{key:1,class:"fcc",style:U(a(v)?"height: 40vh; margin-top: 10px":"height: 60vh")},[t(Z,{icon:"info",title:a(d)("setting.mod.setting.right.result2")},null,8,["title"])],4)):x("",!0)]),_:1},8,["style"])),[[A,D.value]])]),_:1})]),_:1})]),_:1},8,["label"])):x("",!0)]),_:1},8,["modelValue"])])}}}),mt=Ae(dt,[["__scopeId","data-v-af9ecff6"]]);export{mt as default};
