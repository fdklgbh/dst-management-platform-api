import{u as G,g as R,c as V,a as F,r as b,o as L,b as X,B as n,d as u,e as P,f as t,w as e,p as $,j as i,i as p,t as s,m as o,k as S,n as I,X as H,$ as x,ad as J,y as K}from"./index-BhMAzN__.js";const Q={class:"page-div"},W={class:"card-header"},Y={class:"card-header"},Z={class:"card-header"},ee={style:{"margin-top":"10px"}},te={key:0},le={key:1},se=H({name:"toolsInstall"}),ne=Object.assign(se,{setup(ae){const{t:c}=G(),z=R(),y=V(()=>z.language),{isMobile:k}=F(),D=V(()=>z.isDark),_=b(!1),d=b(0),m=b({zh:"",en:""}),a=b({}),M=()=>{x.osInfo.get().then(l=>{a.value=l.data,a.value.Uptime=J(l.data.Uptime,y.value)})},B=()=>{x.install.post().then(l=>{K(l.message),_.value=!0,O()})},T=()=>{x.installStatus.get().then(l=>{const h=l.data;d.value=h.process,m.value.zh=h.zh,m.value.en=h.en,(d.value===100||d.value===0)&&g()})};let f=null;const O=()=>{f=setInterval(()=>{T()},1e3)},g=()=>{f&&(clearInterval(f),f=null)};return L(()=>{M()}),X(()=>{g(),window.removeEventListener("beforeunload",g)}),(l,h)=>{const r=n("el-descriptions-item"),j=n("el-descriptions"),w=n("el-card"),v=n("el-col"),N=n("el-button"),U=n("el-result"),C=n("el-row"),q=n("el-alert"),A=n("el-tag"),E=n("el-progress");return u(),P("div",Q,[t(C,{gutter:20},{default:e(()=>[t(v,{span:12,lg:12,md:12,sm:24,xs:24},{default:e(()=>[t(w,{shadow:"never",style:$(i(k)?"min-height: 300px":"min-height: 500px")},{header:e(()=>[p("span",W,s(i(c)("tools.install.systemInfo")),1)]),default:e(()=>[t(j,{border:"",column:1},{default:e(()=>[t(r,{label:l.$t("tools.install.architecture")},{default:e(()=>[o(s(a.value.Architecture),1)]),_:1},8,["label"]),t(r,{label:l.$t("tools.install.osType")},{default:e(()=>[o(s(a.value.OS),1)]),_:1},8,["label"]),t(r,{label:l.$t("tools.install.osName")},{default:e(()=>[o(s(a.value.Platform),1)]),_:1},8,["label"]),t(r,{label:l.$t("tools.install.osVersion")},{default:e(()=>[o(s(a.value.PlatformVersion),1)]),_:1},8,["label"]),t(r,{label:"CPU"},{default:e(()=>[o(s(a.value.CPUModel),1)]),_:1}),t(r,{label:i(c)("tools.install.cpuCore")},{default:e(()=>[o(s(a.value.CPUCores),1)]),_:1},8,["label"]),t(r,{label:l.$t("tools.install.memory")},{default:e(()=>[o(s((a.value.MemorySize/1024**3).toFixed(2))+" GB",1)]),_:1},8,["label"]),t(r,{label:l.$t("tools.install.uptime")},{default:e(()=>[o(s(a.value.Uptime),1)]),_:1},8,["label"])]),_:1})]),_:1},8,["style"])]),_:1}),t(v,{span:12,lg:12,md:12,sm:24,xs:24,style:$(i(k)?"margin-top: 20px":"margin-top: 0px")},{default:e(()=>[t(w,{shadow:"never",style:$(i(k)?"min-height: 300px":"min-height: 500px")},{header:e(()=>[p("span",Y,s(l.$t("tools.install.installCheck")),1)]),default:e(()=>[a.value.Platform==="ubuntu"||a.value.Platform==="centos"||a.value.Platform==="rocky"?(u(),S(U,{key:0,icon:"success",title:l.$t("tools.install.checkPass"),"sub-title":l.$t("tools.install.checkPassDesc")},{extra:e(()=>[t(N,{type:"primary",loading:_.value,onClick:B},{default:e(()=>[o(s(i(c)("tools.install.install")),1)]),_:1},8,["loading"])]),_:1},8,["title","sub-title"])):(u(),S(U,{key:1,icon:"warning",title:l.$t("tools.install.checkNotPass"),"sub-title":l.$t("tools.install.checkNotPassDesc")},{extra:e(()=>[t(N,{type:"warning",loading:_.value,onClick:B},{default:e(()=>[o(s(i(c)("tools.install.install")),1)]),_:1},8,["loading"])]),_:1},8,["title","sub-title"]))]),_:1},8,["style"])]),_:1},8,["style"])]),_:1}),t(C,{gutter:20},{default:e(()=>[t(v,{span:24,lg:24,md:24,sm:24,xs:24,style:{"margin-top":"20px"}},{default:e(()=>[t(q,{effect:D.value?"light":"dark",type:"success",closable:!1},{default:e(()=>[o(s(i(c)("tools.install.installTip")),1)]),_:1},8,["effect"])]),_:1})]),_:1}),_.value?(u(),S(C,{key:0,gutter:20},{default:e(()=>[t(v,{span:24,lg:24,md:24,sm:24,xs:24,style:{"margin-top":"20px"}},{default:e(()=>[t(w,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[p("div",Z,[p("span",null,s(i(c)("tools.install.installProgress")),1),t(A,{type:"warning",style:{"font-weight":"lighter"}},{default:e(()=>[o(s(i(c)("tools.install.noClose")),1)]),_:1})])]),default:e(()=>[t(E,{percentage:d.value,status:d.value===100?"success":"","stroke-width":15,striped:"","striped-flow":""},null,8,["percentage","status"]),p("div",ee,[y.value==="zh"?(u(),P("span",te,s(m.value.zh),1)):I("",!0),y.value==="en"?(u(),P("span",le,s(m.value.en),1)):I("",!0)])]),_:1})]),_:1})]),_:1})):I("",!0)])}}});export{ne as default};
