import{_ as Ae,o as Ee,u as Pe,a as qe,g as Ge,c as ce,r,z as je,$ as Ke,B as s,C as Xe,d as i,e as y,f as t,w as e,j as a,l as A,k as m,i as p,q as He,p as M,m as c,t as u,F as z,v as E,n as b,s as Je,X as Qe,y as S,A as We}from"./index-B5BRRdMX.js";import{s as w}from"./index-B6-ITlIL.js";import{e as me}from"./index-Y3golZZs.js";import Ye from"./modInfo-DwUPprwv.js";const Ze={class:"page-div"},et={class:"item-container"},tt={class:"card-footer",style:{"margin-top":"20px"}},at={class:"card-header"},lt={style:{display:"flex"}},ot={style:{display:"flex","margin-left":"5px","flex-direction":"column","justify-content":"center"}},nt={class:"card-header"},dt=Qe({name:"settingsMod"}),st=Object.assign(dt,{setup(it){Ee(async()=>{await V(),Me()});const{t:n}=Pe(),{isMobile:v}=qe(),ae=Ge(),ge=ce(()=>ae.isDark),pe=ce(()=>ae.language),le=r("Download"),fe=(o,d)=>{o.paneName==="Add"&&O(),o.paneName==="Setting"&&oe()},h=r([]),P=r(!1),oe=()=>{P.value=!0,f.value=0,U.value="",w.mod.settingFormat.get().then(o=>{h.value=o.data}).finally(()=>{P.value=!1})},f=r(0),U=r(""),ne=(o,d)=>{f.value=o,U.value=d,_e()},D=r(!1),I=r({id:"",configOptions:[]}),_e=()=>{D.value=!0,w.mod.configOptions.get({id:f.value}).then(o=>{I.value=o.data}).finally(()=>{D.value=!1})},ve=()=>{D.value=!0,w.mod.configChange.post({modFormattedData:h.value}).then(o=>{S(o.message)}).finally(()=>{D.value=!1})},q=r(!1),L=r({total:0,rows:[]}),he=r(),g=r({page:1,pageSize:30,searchText:"",searchType:"text"}),V=(o=!0)=>{o&&(g.value.page=1),q.value=!0,me.modSearch.get(g.value).then(d=>{L.value.rows=d.data.rows,L.value.total=d.data.total,g.value.searchType==="id"&&je(pe.value==="zh"?"ID搜索不显示评分":"Search by ID will not display the vote data")}).finally(()=>{q.value=!1})},ye=o=>{V(!1)},be=o=>{V(!1)},de=r([]),G=r(!1),O=()=>{G.value=!0,me.modInfoDownloaded.get().then(o=>{de.value=o.data}).finally(()=>{G.value=!1})},j=r(!1),we=()=>{j.value=!0,w.mod.sync.post().then(o=>{S(o.message),O()}).finally(()=>{j.value=!1})},F=r(!1),ke=o=>{let d=o.cmd,_=o.row;switch(F.value=!0,d){case"enable":xe(_);break;case"delete":Se(_);break;default:F.value=!1,We("error")}},xe=o=>{const _={isUgc:o.file_url==="",id:o.id};w.mod.enable.post(_).then(C=>{S(C.message)}).finally(()=>{F.value=!1})},Se=o=>{const _={isUgc:o.file_url==="",id:o.id};w.mod.delete.post(_).then(C=>{S(C.message),O()}).finally(()=>{F.value=!1})},K=r(!1),Ce=()=>{K.value=!0;const d={isUgc:U.value==="",id:f.value};w.mod.disable.post(d).then(_=>{S(_.message),oe()}).finally(()=>{K.value=!1})},X=r(""),Me=()=>{Ke.osInfo.get().then(o=>{X.value=o.data.Platform})},H=r(!1),ze=()=>{H.value=!0,w.mod.macosExport.post().then(o=>{S(o.message)}).finally(()=>{H.value=!1})},J=r(!1),Ue=()=>{J.value=!0;const o={isUgc:U.value==="",id:f.value,fileURL:U.value};w.mod.update.post(o).then(d=>{S(d.message)}).finally(()=>{J.value=!1})};return(o,d)=>{const _=s("el-option"),C=s("el-select"),k=s("el-button"),De=s("el-input"),R=s("el-form-item"),se=s("el-form"),Q=s("el-scrollbar"),Ve=s("el-pagination"),$=s("el-card"),W=s("el-tab-pane"),ie=s("el-tooltip"),Fe=s("el-alert"),T=s("el-table-column"),Y=s("el-text"),Te=s("arrow-down"),Ie=s("el-icon"),ue=s("el-dropdown-item"),Le=s("el-dropdown-menu"),Oe=s("el-dropdown"),Re=s("el-table"),Z=s("el-col"),re=s("el-row"),$e=s("el-image"),B=s("el-tag"),Be=s("el-divider"),ee=s("el-result"),Ne=s("el-tabs"),N=Xe("loading");return i(),y("div",Ze,[t(Ne,{modelValue:le.value,"onUpdate:modelValue":d[6]||(d[6]=l=>le.value=l),onTabClick:fe},{default:e(()=>[t(W,{label:a(n)("setting.mod.tab.download"),name:"Download"},{default:e(()=>[A((i(),m($,{style:{height:"78vh"},shadow:"never"},{default:e(()=>[p("div",null,[t(se,{ref_key:"modSearchFormRef",ref:he,model:g.value,inline:!0,onKeyup:He(V,["enter"])},{default:e(()=>[t(R,null,{default:e(()=>[t(De,{modelValue:g.value.searchText,"onUpdate:modelValue":d[1]||(d[1]=l=>g.value.searchText=l),style:M(a(v)?"width: 75vw;":"width: 50vw;")},{prepend:e(()=>[t(C,{modelValue:g.value.searchType,"onUpdate:modelValue":d[0]||(d[0]=l=>g.value.searchType=l),style:{width:"85px"}},{default:e(()=>[t(_,{label:o.$t("setting.mod.download.searchTypeText"),value:"text"},null,8,["label"]),t(_,{label:o.$t("setting.mod.download.searchTypeId"),value:"id"},null,8,["label"])]),_:1},8,["modelValue"])]),append:e(()=>[t(k,{type:"primary",onClick:V},{default:e(()=>[c(u(a(n)("setting.mod.download.search")),1)]),_:1})]),_:1},8,["modelValue","style"])]),_:1})]),_:1},8,["model"])]),p("div",null,[t(Q,{"max-height":"60vh"},{default:e(()=>[p("div",et,[(i(!0),y(z,null,E(L.value.rows,l=>(i(),m(Ye,{mod:l},null,8,["mod"]))),256))])]),_:1})]),p("div",tt,[t(Ve,{"current-page":g.value.page,"onUpdate:currentPage":d[2]||(d[2]=l=>g.value.page=l),"page-size":g.value.pageSize,"onUpdate:pageSize":d[3]||(d[3]=l=>g.value.pageSize=l),"page-sizes":[10,20,30,40,50,100],layout:"total, sizes, prev, pager, next",total:L.value.total,onSizeChange:d[4]||(d[4]=l=>ye(g.value.pageSize)),onCurrentChange:d[5]||(d[5]=l=>be(g.value.page))},null,8,["current-page","page-size","total"])])]),_:1})),[[N,q.value]])]),_:1},8,["label"]),t(W,{label:a(n)("setting.mod.tab.add"),name:"Add"},{default:e(()=>[t(re,{gutter:10},{default:e(()=>[t(Z,{span:24},{default:e(()=>[A((i(),m($,{style:{height:"75vh"},shadow:"never"},{header:e(()=>[p("div",at,[p("span",null,u(a(n)("setting.mod.add.header.title")),1),p("div",null,[t(k,{onClick:O},{default:e(()=>[c(u(a(n)("setting.mod.add.header.refresh")),1)]),_:1}),t(ie,{effect:"light","show-after":500,content:a(n)("setting.mod.add.header.syncTooltip"),placement:"top"},{default:e(()=>[t(k,{type:"primary",loading:j.value,onClick:we},{default:e(()=>[c(u(a(n)("setting.mod.add.header.sync")),1)]),_:1},8,["loading"])]),_:1},8,["content"]),X.value==="darwin"?(i(),m(k,{key:0,onClick:ze,loading:H.value,type:"success"},{default:e(()=>[c(u(a(n)("setting.mod.add.header.export")),1)]),_:1},8,["loading"])):b("",!0)])])]),default:e(()=>[t(Fe,{closable:!1,effect:ge.value?"light":"dark",type:"warning"},{default:e(()=>[c(u(a(n)("setting.mod.add.alert")),1)]),_:1},8,["effect"]),t(Re,{data:de.value,border:"",style:{height:"51vh","margin-top":"10px"}},{default:e(()=>[t(T,{label:a(n)("setting.mod.add.table.name"),prop:"name"},null,8,["label"]),t(T,{label:"ID",prop:"id"}),t(T,{label:a(n)("setting.mod.add.table.size")},{default:e(l=>[c(u(a(Je)(l.row.size)),1)]),_:1},8,["label"]),t(T,{label:a(n)("setting.mod.add.table.downloadedReady.title")},{default:e(l=>[l.row.downloadedReady?(i(),m(Y,{key:0,type:"success",size:"small"},{default:e(()=>[c(u(a(n)("setting.mod.add.table.downloadedReady.ready")),1)]),_:1})):b("",!0),l.row.downloadedReady?b("",!0):(i(),y(z,{key:1},[l.row.file_url!==""?(i(),m(Y,{key:0,type:"info",size:"small"},{default:e(()=>[c(u(a(n)("setting.mod.add.table.downloadedReady.notUGC")),1)]),_:1})):(i(),m(Y,{key:1,type:"warning",size:"small"},{default:e(()=>[c(u(a(n)("setting.mod.add.table.downloadedReady.notReady")),1)]),_:1}))],64))]),_:1},8,["label"]),t(T,{label:a(n)("setting.mod.add.table.action")},{default:e(l=>[t(Oe,{onCommand:ke,trigger:"click"},{dropdown:e(()=>[t(Le,null,{default:e(()=>[t(ue,{command:{cmd:"enable",row:l.row}},{default:e(()=>[c(u(a(n)("setting.mod.add.table.enable")),1)]),_:2},1032,["command"]),t(ue,{command:{cmd:"delete",row:l.row}},{default:e(()=>[c(u(a(n)("setting.mod.add.table.delete")),1)]),_:2},1032,["command"])]),_:2},1024)]),default:e(()=>[t(k,{type:"primary",link:"",loading:F.value},{default:e(()=>[c(u(a(n)("setting.mod.add.table.action")),1),t(Ie,{class:"el-icon--right"},{default:e(()=>[t(Te)]),_:1})]),_:1},8,["loading"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})),[[N,G.value]])]),_:1})]),_:1})]),_:1},8,["label"]),X.value!=="darwin"?(i(),m(W,{key:0,label:a(n)("setting.mod.tab.setting"),name:"Setting"},{default:e(()=>[t(re,{gutter:10},{default:e(()=>[t(Z,{lg:8,md:8,sm:24,span:8,xs:24},{default:e(()=>[A((i(),m($,{style:M(a(v)?"height: 50vh":"height: 70vh"),shadow:"never"},{default:e(()=>[t(Q,{"max-height":a(v)?"45vh":"65vh"},{default:e(()=>[h.value?(i(!0),y(z,{key:0},E(h.value,(l,x)=>(i(),y(z,null,[p("div",lt,[p("div",null,[t($e,{src:l.preview_url,fit:"fill",onClick:te=>ne(l.id,l.file_url),style:{width:"75px",height:"75px"}},null,8,["src","onClick"])]),p("div",ot,[t(k,{link:"",type:"primary",onClick:te=>ne(l.id,l.file_url)},{default:e(()=>[c(u(l.name),1)]),_:2},1032,["onClick"]),p("div",null,[l.enable?(i(),m(B,{key:0,type:"success"},{default:e(()=>[c(u(a(n)("setting.mod.setting.left.enable")),1)]),_:1})):b("",!0),l.enable?b("",!0):(i(),m(B,{key:1,type:"info"},{default:e(()=>[c(u(a(n)("setting.mod.setting.left.disable")),1)]),_:1}))])])]),x!==h.value.length-1?(i(),m(Be,{key:0})):b("",!0)],64))),256)):(i(),y("div",{key:1,class:"fcc",style:M(a(v)?"height: 50vh":"height: 70vh")},[t(ee,{icon:"warning",title:a(n)("setting.mod.setting.left.result")},null,8,["title"])],4))]),_:1},8,["max-height"])]),_:1},8,["style"])),[[N,P.value]])]),_:1}),t(Z,{lg:16,md:16,sm:24,span:16,xs:24},{default:e(()=>[A((i(),m($,{style:M(a(v)?"height: 50vh; margin-top: 10px":"height: 70vh"),shadow:"never"},{header:e(()=>[p("div",nt,[p("span",null,u(a(n)("setting.mod.setting.right.header.title")),1),p("div",null,[t(k,{type:"primary",disabled:f.value===0,loading:J.value,onClick:Ue},{default:e(()=>[c(u(a(n)("setting.mod.setting.right.header.update")),1)]),_:1},8,["disabled","loading"]),t(k,{type:"danger",disabled:f.value===0,loading:K.value,onClick:Ce},{default:e(()=>[c(u(a(n)("setting.mod.setting.right.header.disable")),1)]),_:1},8,["disabled","loading"])])])]),default:e(()=>[f.value!==0?(i(),m(Q,{key:0,"max-height":a(v)?"37vh":"57vh"},{default:e(()=>[I.value.configOptions?(i(),m(se,{key:0,ref:"modSettingFormRef",size:a(v)?"small":"large","label-position":a(v)?"top":"left","label-width":a(v)?"70":"auto"},{default:e(()=>[t(R,{label:"ID"},{default:e(()=>[t(B,null,{default:e(()=>[c(u(I.value.id),1)]),_:1})]),_:1}),t(R,{label:a(n)("setting.mod.setting.right.name")},{default:e(()=>[t(B,{type:"info"},{default:e(()=>[c(u(h.value[h.value.findIndex(l=>l.id===f.value)].name),1)]),_:1})]),_:1},8,["label"]),(i(!0),y(z,null,E(I.value.configOptions,l=>(i(),m(ie,{"show-after":500,effect:"light",content:l.hover,placement:"top"},{default:e(()=>[t(R,{label:l.label},{default:e(()=>[t(C,{modelValue:h.value[h.value.findIndex(x=>x.id===f.value)].configurationOptions[l.name],"onUpdate:modelValue":x=>h.value[h.value.findIndex(te=>te.id===f.value)].configurationOptions[l.name]=x,onChange:ve},{default:e(()=>[(i(!0),y(z,null,E(l.options,x=>(i(),m(_,{label:x.description,value:x.data},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1032,["content"]))),256))]),_:1},8,["size","label-position","label-width"])):(i(),y("div",{key:1,class:"fcc",style:M(a(v)?"height: 40vh; margin-top: 10px":"height: 60vh")},[t(ee,{icon:"info",title:a(n)("setting.mod.setting.right.result")},null,8,["title"])],4))]),_:1},8,["max-height"])):b("",!0),f.value===0?(i(),y("div",{key:1,class:"fcc",style:M(a(v)?"height: 40vh; margin-top: 10px":"height: 60vh")},[t(ee,{icon:"info",title:a(n)("setting.mod.setting.right.result2")},null,8,["title"])],4)):b("",!0)]),_:1},8,["style"])),[[N,D.value]])]),_:1})]),_:1})]),_:1},8,["label"])):b("",!0)]),_:1},8,["modelValue"])])}}}),gt=Ae(st,[["__scopeId","data-v-3a42bb6b"]]);export{gt as default};
