import{h as B,_ as Be,o as Ee,u as Le,a as De,g as Ue,c as ce,E as Ae,r as f,b as Me,d as c,e as J,f as l,w as e,i as g,t as n,j as a,k as v,l as N,m as r,n as w,p as pe,q as fe,F as Pe,s as Fe,v as Re,x as Q,y as Ne,z as ve,A as d,B as ge}from"./index-Lmh5sJJi.js";import{e as X}from"./index-BFhNO3D9.js";import{f as qe}from"./tools-BEjKDLTT.js";const $={roomInfo:{url:"/home/room_info",get:async function(h){return await B.get(this.url,h)}},sysInfo:{url:"/home/sys_info",get:async function(h){return await B.get(this.url,h)}},exec:{url:"/home/exec",post:async function(h){return await B.post(this.url,h)}},interface:{announce:{url:"/home/announce",post:async function(h){return await B.post(this.url,h)}},console:{url:"/home/console",post:async function(h){return await B.post(this.url,h)}}}},Ke={class:"page-div"},Ge={class:"card-header"},Oe={key:1,class:"fcc",style:{height:"150px"}},je={class:"card-header"},He={class:"fcc"},We={class:"percentage-value"},Je={class:"percentage-value"},Qe={class:"percentage-label"},Xe={class:"card-header"},Ye={class:"card-header"},Ze={__name:"index",setup(h){Ee(()=>{he(),be(),_e(),ye(),we()});const{t:o}=Le(),{isMobile:x}=De(),E=Ue();ce(()=>E.isDark);const _=ce(()=>E.language),he=()=>{E.needUpdatePassword&&(Ae({title:o("home.updatePasswordTitle"),message:o("home.updatePassword"),type:"warning"}),E.needUpdatePassword=!1)};f(!1);const q=f(!1),K=f(!1),V=f({server:0,local:0}),L=f(""),_e=()=>{q.value=!0,X.dstVersion.get().then(u=>{V.value=u.data}).finally(()=>{q.value=!1})},ye=()=>{K.value=!0,X.connectionCode.get().then(u=>{L.value=u.data}).finally(()=>{K.value=!1})},m=f({roomSettingBase:{},seasonInfo:{season:{},cycles:0,elapsedDays:0,seasonLength:{summer:15,autumn:20,spring:20,winter:15},phase:{}},modsCount:0}),be=()=>{$.roomInfo.get().then(u=>{m.value=u.data})},Y=u=>m.value.seasonInfo.cycles>-1?`(${m.value.seasonInfo.elapsedDays}/${m.value.seasonInfo.seasonLength[u]})`:"",y=f({cpu:0,memory:0,master:0,caves:0}),ke=()=>{$.sysInfo.get().then(u=>{y.value=u.data})},Z=[{color:"#5cb87a",percentage:20},{color:"#1989fa",percentage:40},{color:"#e6a23c",percentage:60},{color:"#f56c6c",percentage:80},{color:"#6f7ad3",percentage:100}];let D=null;const we=()=>{D=setInterval(()=>{!U.value&&!A.value&&ke()},2e3)},ee=()=>{D&&(clearInterval(D),D=null)},U=f(!1),A=f(!1),le=u=>{if(y.value.master,u==="master"){const t={type:"masterSwitch",info:y.value.master};U.value=!0,$.exec.post(t).finally(()=>{U.value=!1})}else{const t={type:"cavesSwitch",info:y.value.caves};A.value=!0,$.exec.post(t).finally(()=>{A.value=!1})}},p=(u,t)=>{const M={startup:{en:"STARTUP",zh:"启动"},rollback:{en:"ROLLBACK",zh:"回档"},shutdown:{en:"SHUTDOWN",zh:"关闭"},restart:{en:"RESTART",zh:"重启"},update:{en:"UPDATE GAME",zh:"更新游戏"},reset:{en:"RESET GAME",zh:"重置游戏"},delete:{en:"DELETE GAME",zh:"删除世界"}};Re.confirm(_.value==="zh"?`将执行 ${M[u].zh} 操作，是否继续？`:`The ${M[u].en} operation will be performed. Do you want to continue?`,_.value==="zh"?"请确认您的操作":"Please confirm your operation",{confirmButtonText:_.value==="zh"?"确定":"confirm",cancelButtonText:_.value==="zh"?"取消":"cancel",type:"warning",beforeClose:(W,i,b)=>{if(W==="confirm"){i.confirmButtonLoading=!0;const P={type:u,info:t};$.exec.post(P).then(k=>{Q(k.message),b()}).catch(()=>{}).finally(()=>{i.confirmButtonLoading=!1})}else b()}}).then(()=>{}).catch(()=>{Ne(o("home.canceled"))})},G=f(!1),S=f({message:""}),te=()=>{if(S.value.message===""){ve(_.value==="zh"?"请输入要宣告的内容":"Please enter the content to be announced");return}G.value=!0,$.interface.announce.post(S.value).then(u=>{Q(u.message),S.value.message=""}).finally(()=>{G.value=!1})},O=f(!1),C=f({cmd:"",world:"master"}),ae=()=>{if(C.value.cmd===""){ve(_.value==="zh"?"请输入要执行的命令":"Please enter the command to execute");return}O.value=!0,$.interface.console.post(C.value).then(u=>{Q(u.message),C.value.cmd=""}).finally(()=>{O.value=!1})},j=f(!1),H=f(!1),oe=f([]),ze=()=>{j.value=!0,H.value=!0,X.modInfo.get().then(u=>{oe.value=u.data}).finally(()=>{H.value=!1})};return Me(()=>{ee(),window.removeEventListener("beforeunload",ee)}),(u,t)=>{const M=d("DocumentCopy"),W=d("el-icon"),i=d("el-button"),b=d("el-descriptions-item"),P=d("el-tooltip"),k=d("el-tag"),xe=d("el-descriptions"),Ce=d("el-result"),F=d("el-card"),z=d("el-col"),ne=d("el-progress"),se=d("el-row"),ue=d("el-switch"),I=d("el-form-item"),R=d("el-form"),re=d("el-input"),ie=d("el-option"),Ie=d("el-select"),T=d("el-table-column"),$e=d("el-image"),Ve=d("el-table"),Se=d("el-dialog"),de=ge("copy"),me=ge("loading");return c(),J("div",Ke,[l(se,{gutter:10},{default:e(()=>[l(z,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[g("div",Ge,n(a(o)("home.roomInfo")),1)]),default:e(()=>[m.value.roomSettingBase.name!==""?(c(),v(xe,{key:0,column:a(x)?1:2},{default:e(()=>[l(b,{label:a(o)("home.roomName")},{default:e(()=>[N((c(),v(i,{link:"",type:"primary"},{default:e(()=>[r(n(m.value.roomSettingBase.name)+" ",1),l(W,{style:{"margin-left":"3px"}},{default:e(()=>[l(M)]),_:1})]),_:1})),[[de,m.value.roomSettingBase.name]])]),_:1},8,["label"]),l(b,{label:a(o)("home.connectionCode")},{default:e(()=>[l(P,{effect:"light",content:L.value,placement:"top"},{default:e(()=>[N((c(),v(i,{disabled:L.value==="",link:"",loading:K.value,type:"primary"},{default:e(()=>[r(n(a(o)("home.copy")),1)]),_:1},8,["disabled","loading"])),[[de,L.value]])]),_:1},8,["content"])]),_:1},8,["label"]),l(b,{label:a(o)("home.cycles")},{default:e(()=>[l(k,{type:m.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[r(n(m.value.seasonInfo.cycles),1)]),_:1},8,["type"])]),_:1},8,["label"]),l(b,{label:a(o)("home.phase")},{default:e(()=>[_.value==="en"?(c(),v(k,{key:0,type:m.value.seasonInfo.phase.en==="Failed to retrieve"?"danger":"success"},{default:e(()=>[r(n(m.value.seasonInfo.phase.en),1)]),_:1},8,["type"])):w("",!0),_.value==="zh"?(c(),v(k,{key:1,type:m.value.seasonInfo.phase.zh==="获取失败"?"danger":"success"},{default:e(()=>[r(n(m.value.seasonInfo.phase.zh),1)]),_:1},8,["type"])):w("",!0)]),_:1},8,["label"]),l(b,{label:a(o)("home.season")},{default:e(()=>[_.value==="en"?(c(),v(k,{key:0,type:m.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[r(n(m.value.seasonInfo.season.en)+" "+n(Y(m.value.seasonInfo.season.en)),1)]),_:1},8,["type"])):w("",!0),_.value==="zh"?(c(),v(k,{key:1,type:m.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[r(n(m.value.seasonInfo.season.zh)+" "+n(Y(m.value.seasonInfo.season.en)),1)]),_:1},8,["type"])):w("",!0)]),_:1},8,["label"]),l(b,{label:a(o)("home.mods")},{default:e(()=>[l(k,null,{default:e(()=>[r(n(m.value.modsCount),1)]),_:1}),l(i,{link:"",type:"primary",onClick:ze,style:{"margin-left":"10px"}},{default:e(()=>[r(n(a(o)("home.modsButton")),1)]),_:1})]),_:1},8,["label"]),l(b,{label:a(o)("home.version")},{default:e(()=>[N((c(),v(k,{type:V.value.local===V.value.server?"success":"danger"},{default:e(()=>[r("("+n(V.value.local)+"/"+n(V.value.server)+")",1)]),_:1},8,["type"])),[[me,q.value]])]),_:1},8,["label"])]),_:1},8,["column"])):w("",!0),m.value.roomSettingBase.name===""?(c(),J("div",Oe,[l(Ce,{icon:"warning",title:a(o)("home.noServer")},null,8,["title"])])):w("",!0)]),_:1})]),_:1}),l(z,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[g("div",je,n(a(o)("home.sysInfo")),1)]),default:e(()=>[g("div",He,[l(ne,{type:"dashboard",percentage:y.value.cpu,color:Z},{default:e(({percentage:s})=>[g("span",We,n(s.toFixed(1)),1),t[24]||(t[24]=g("span",{class:"percentage-label"},"CPU",-1))]),_:1},8,["percentage"]),l(ne,{type:"dashboard",percentage:y.value.memory,color:Z,style:{"margin-left":"10%"}},{default:e(({percentage:s})=>[g("span",Je,n(s.toFixed(1)),1),g("span",Qe,n(a(o)("home.mem")),1)]),_:1},8,["percentage"])])]),_:1})]),_:1})]),_:1}),l(se,{gutter:10},{default:e(()=>[l(z,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{shadow:"never",style:pe(a(x)?"min-height: 300px":"min-height: 400px")},{header:e(()=>[g("div",Xe,n(a(o)("home.control")),1)]),default:e(()=>[g("div",null,[l(R,{size:"large",inline:""},{default:e(()=>[l(I,{label:u.$t("home.master")},{default:e(()=>[l(ue,{modelValue:y.value.master,"onUpdate:modelValue":t[0]||(t[0]=s=>y.value.master=s),"active-value":1,"inactive-value":0,onChange:t[1]||(t[1]=s=>le("master")),loading:U.value,"inline-prompt":"","active-text":u.$t("home.running"),"inactive-text":u.$t("home.terminated")},null,8,["modelValue","loading","active-text","inactive-text"])]),_:1},8,["label"]),l(I,{label:u.$t("home.caves")},{default:e(()=>[l(ue,{modelValue:y.value.caves,"onUpdate:modelValue":t[2]||(t[2]=s=>y.value.caves=s),"active-value":1,"inactive-value":0,onChange:t[3]||(t[3]=s=>le("caves")),loading:A.value,"inline-prompt":"","active-text":u.$t("home.running"),"inactive-text":u.$t("home.terminated")},null,8,["modelValue","loading","active-text","inactive-text"])]),_:1},8,["label"])]),_:1}),l(R,{size:"large"},{default:e(()=>[l(I,{label:u.$t("home.rollback")},{default:e(()=>[a(x)?(c(),v(z,{key:0},{default:e(()=>[l(i,{size:"small",onClick:t[4]||(t[4]=s=>p("rollback",1))},{default:e(()=>[r("1"+n(a(o)("home.day")),1)]),_:1}),l(i,{size:"small",onClick:t[5]||(t[5]=s=>p("rollback",2))},{default:e(()=>[r("2"+n(a(o)("home.days")),1)]),_:1}),l(i,{size:"small",onClick:t[6]||(t[6]=s=>p("rollback",3))},{default:e(()=>[r("3"+n(a(o)("home.days")),1)]),_:1})]),_:1})):w("",!0),a(x)?(c(),v(z,{key:1},{default:e(()=>[l(i,{size:"small",onClick:t[7]||(t[7]=s=>p("rollback",4))},{default:e(()=>[r("4"+n(a(o)("home.days")),1)]),_:1}),l(i,{size:"small",onClick:t[8]||(t[8]=s=>p("rollback",5))},{default:e(()=>[r("5"+n(a(o)("home.days")),1)]),_:1})]),_:1})):w("",!0),a(x)?(c(),v(z,{key:2})):w("",!0),a(x)?w("",!0):(c(),v(z,{key:3},{default:e(()=>[l(i,{size:"small",onClick:t[9]||(t[9]=s=>p("rollback",1))},{default:e(()=>[r("1"+n(a(o)("home.day")),1)]),_:1}),l(i,{size:"small",onClick:t[10]||(t[10]=s=>p("rollback",2))},{default:e(()=>[r("2"+n(a(o)("home.days")),1)]),_:1}),l(i,{size:"small",onClick:t[11]||(t[11]=s=>p("rollback",3))},{default:e(()=>[r("3"+n(a(o)("home.days")),1)]),_:1}),l(i,{size:"small",onClick:t[12]||(t[12]=s=>p("rollback",4))},{default:e(()=>[r("4"+n(a(o)("home.days")),1)]),_:1}),l(i,{size:"small",onClick:t[13]||(t[13]=s=>p("rollback",5))},{default:e(()=>[r("5"+n(a(o)("home.days")),1)]),_:1})]),_:1}))]),_:1},8,["label"])]),_:1}),l(R,{size:"large"},{default:e(()=>[l(I,null,{default:e(()=>[l(i,{type:"success",size:"default",onClick:t[14]||(t[14]=s=>p("startup",0))},{default:e(()=>[r(n(a(o)("home.startup")),1)]),_:1}),l(i,{type:"primary",size:"default",onClick:t[15]||(t[15]=s=>p("restart",0))},{default:e(()=>[r(n(a(o)("home.restart")),1)]),_:1}),l(i,{type:"warning",size:"default",onClick:t[16]||(t[16]=s=>p("update",0))},{default:e(()=>[r(n(a(o)("home.update")),1)]),_:1})]),_:1}),l(I,null,{default:e(()=>[l(i,{type:"warning",size:"default",onClick:t[17]||(t[17]=s=>p("shutdown",0))},{default:e(()=>[r(n(a(o)("home.shutdown")),1)]),_:1}),l(i,{type:"danger",size:"default",onClick:t[18]||(t[18]=s=>p("reset",0))},{default:e(()=>[r(n(a(o)("home.reset")),1)]),_:1}),l(P,{effect:"light",content:u.$t("home.deleteTips"),placement:"top"},{default:e(()=>[l(i,{color:"#626aef",size:"default",onClick:t[19]||(t[19]=s=>p("delete",0))},{default:e(()=>[r(n(a(o)("home.delete")),1)]),_:1})]),_:1},8,["content"])]),_:1})]),_:1})])]),_:1},8,["style"])]),_:1}),l(z,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{shadow:"never",style:pe(a(x)?"min-height: 300px":"min-height: 400px")},{header:e(()=>[g("div",Ye,n(a(o)("home.interface")),1)]),default:e(()=>[g("div",null,[l(R,{"label-position":"top"},{default:e(()=>[l(I,{label:u.$t("home.announcement")},{default:e(()=>[l(re,{modelValue:S.value.message,"onUpdate:modelValue":t[20]||(t[20]=s=>S.value.message=s),onKeyup:fe(te,["enter"])},{append:e(()=>[l(i,{loading:G.value,onClick:te},{default:e(()=>[r(n(a(o)("home.send")),1)]),_:1},8,["loading"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(I,{label:"Console"},{default:e(()=>[l(re,{modelValue:C.value.cmd,"onUpdate:modelValue":t[22]||(t[22]=s=>C.value.cmd=s),onKeyup:fe(ae,["enter"])},{prepend:e(()=>[l(Ie,{modelValue:C.value.world,"onUpdate:modelValue":t[21]||(t[21]=s=>C.value.world=s),style:{width:"115px"}},{default:e(()=>[l(ie,{label:u.$t("home.master"),value:"master"},null,8,["label"]),l(ie,{label:u.$t("home.caves"),value:"caves"},null,8,["label"])]),_:1},8,["modelValue"])]),append:e(()=>[l(i,{loading:O.value,onClick:ae},{default:e(()=>[r(n(a(o)("home.execute")),1)]),_:1},8,["loading"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["style"])]),_:1})]),_:1}),l(Se,{modelValue:j.value,"onUpdate:modelValue":t[23]||(t[23]=s=>j.value=s),"close-on-click-modal":!1,title:a(o)("home.modsTable.title"),width:"80%"},{default:e(()=>[N((c(),v(Ve,{data:oe.value,"tooltip-effect":"light",height:"70vh",border:"",style:{width:"100%"},size:"small"},{default:e(()=>[l(T,{prop:"name",label:a(o)("home.modsTable.name")},null,8,["label"]),l(T,{prop:"preview_url",label:a(o)("home.modsTable.pics"),width:"120px"},{default:e(s=>[l($e,{style:{width:"100px",height:"100px"},src:s.row.preview_url,fit:"fill"},null,8,["src"])]),_:1},8,["label"]),l(T,{prop:"size",label:a(o)("home.modsTable.size")},{default:e(s=>[r(n(a(qe)(s.row.size)),1)]),_:1},8,["label"]),l(T,{prop:"id",label:a(o)("home.modsTable.id")},null,8,["label"]),l(T,{prop:"tags",label:a(o)("home.modsTable.tags")},{default:e(s=>[(c(!0),J(Pe,null,Fe(s.row.tags,Te=>(c(),v(k,{style:{margin:"0 5px 5px 0"}},{default:e(()=>[r(n(Te.display_name),1)]),_:2},1024))),256))]),_:1},8,["label"])]),_:1},8,["data"])),[[me,H.value]])]),_:1},8,["modelValue","title"])])}}},al=Be(Ze,[["__scopeId","data-v-5057f0c1"]]);export{al as default};
