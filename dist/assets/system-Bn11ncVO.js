import{u as $,a as J,g as Q,a3 as W,D as X,G as Y,b as Z,H as ee,c as z,o as te,r as M,a8 as C,ah as se,w as ae,I as N,J as f,e as S,f as h,j as e,k as t,l as m,p as o,t as i,i as a,a0 as le,B as ie,A as ne,ai as ue}from"./index-C-KsYsfv.js";import{_ as oe}from"./lodash-YJSlP23j.js";import{t as de}from"./index-BAjU4gOB.js";const re={class:"page-div"},me={class:"card-header"},ge={class:"tip_error"},pe={key:0},fe={key:1},ce={class:"el-form-item-msg",style:{color:"#A8ABB2"}},_e={class:"el-form-item-msg",style:{color:"#A8ABB2"}},ye={key:0},ve={key:1},be={class:"el-form-item-msg",style:{color:"#A8ABB2"}},Se={class:"el-form-item-msg",style:{color:"#A8ABB2"}},he={class:"el-form-item-msg",style:{color:"#A8ABB2"}},Be={class:"el-form-item-msg",style:{color:"#A8ABB2"}},ke={class:"tip_success"},Ve={class:"el-form-item-msg",style:{color:"#A8ABB2"}},Me={class:"el-form-item-msg",style:{color:"#A8ABB2"}},Ue={class:"el-form-item-msg",style:{color:"#A8ABB2"}},Re={class:"el-form-item-msg",style:{color:"#A8ABB2"}},qe={class:"el-form-item-msg",style:{color:"#A8ABB2"}},Ae={key:0},Fe={key:1},Ie={class:"el-form-item-msg",style:{color:"#A8ABB2"}},xe={class:"el-form-item-msg",style:{color:"#A8ABB2"}},De={class:"el-form-item-msg",style:{color:"#A8ABB2"}},Ge=le({name:"settingsSystem"}),Pe=Object.assign(Ge,{setup(we){const{t:s}=$(),{isMobile:P}=J(),k=Q(),H=W(),U=X();Y();const I=Z(),x=ee("refresh");z(()=>k.isDark);const _=z(()=>k.language),B=H.userInfo;te(()=>{G(),O()});const D=M(),R=M({sysSetting:{autoRestart:{enable:!1,time:""},autoBackup:{enable:!1,time:""},keepalive:{enable:!1,frequency:0},bit64:!1,tickRate:15},schedulerSetting:{playerGetFrequency:30,UIDMaintain:{disable:!1,frequency:0},sysMetricsGet:{disable:void 0,frequency:void 0},autoUpdate:{enable:!1,time:""}}}),n=M({sysSetting:{autoRestart:{enable:!1,time:""},autoBackup:{enable:!1,time:""},keepalive:{enable:!1,frequency:0},bit64:!1,tickRate:15},schedulerSetting:{playerGetFrequency:30,UIDMaintain:{disable:!1,frequency:0},sysMetricsGet:{disable:void 0,frequency:void 0},autoUpdate:{enable:!1,time:""}}}),q=(y,l,v)=>{if(!l)return v(new Error(_.value==="zh"?"此条目为必填项":"Please input this item"));if(!Number.isInteger(l))return v(new Error(_.value==="zh"?"只允许输入整数":"Please input integer"));if(l<=0)return v(new Error(_.value==="zh"?"必须大于0":"Must be greater than 0"));v()},T={sysSetting:{autoRestart:{enable:[{required:!0,message:s("setting.roomBaseFormRules.name"),trigger:"change"}],time:[{required:!0,message:s("setting.roomBaseFormRules.name"),trigger:"change"}]},autoBackup:{enable:[{required:!0,message:s("setting.roomBaseFormRules.name"),trigger:"change"}],time:[{required:!0,message:s("setting.roomBaseFormRules.name"),trigger:"change"}]},keepalive:{enable:[{required:!0,message:s("setting.roomBaseFormRules.name"),trigger:"change"}],frequency:[{validator:q,trigger:"blur"}]},bit64:[{required:!0,message:s("setting.roomBaseFormRules.name"),trigger:"change"}],tickRate:[{required:!0,message:s("setting.roomBaseFormRules.name"),trigger:"change"}]},schedulerSetting:{playerGetFrequency:[{validator:q,trigger:"blur"}],UIDMaintain:{disable:[{required:!0,message:s("setting.roomBaseFormRules.name"),trigger:"change"}],frequency:[{validator:q,trigger:"blur"}]},sysMetricsGet:{disable:[{required:!0,message:s("setting.roomBaseFormRules.name"),trigger:"change"}]},autoUpdate:{enable:[{required:!0,message:s("setting.roomBaseFormRules.name"),trigger:"change"}],time:[{required:!0,message:s("setting.roomBaseFormRules.name"),trigger:"change"}]}}},G=()=>{const y={clusterName:k.selectedDstCluster};C.system.setting.get(y).then(l=>{n.value=l.data,R.value=se(n.value)})},A=M(!1),E=()=>{D.value.validate(y=>{if(y)if(oe.isEqual(R.value,n.value))ie(_.value==="zh"?"配置未修改":"System settings not changes");else{A.value=!0;const l={clusterName:k.selectedDstCluster,settings:n.value};C.system.setting.put(l).then(v=>{if(G(),ne(v.message),R.value.bit64!==n.value.bit64){const c=_.value==="zh"?"正在后台切换32/64，可依据CPU使用率判断是否执行完毕，执行完毕后重启游戏即可。":"The background switching 32-bit/64-bit task is in progress, and you can determine if it has completed based on the CPU usage. Once it's completed, you can restart the game.",V=_.value==="zh"?"系统提示":"Tip";ue(c,V,1e4)}}).finally(()=>{A.value=!1})}})},w=M(""),O=()=>{de.osInfo.get().then(y=>{w.value=y.data.Platform})},K=()=>{setTimeout(()=>{U.meta.isKeepAlive&&I.removeKeepAliveName(U.name),x(!1),N(()=>{U.meta.isKeepAlive&&I.addKeepAliveName(U.name),x(!0)})},0)};return ae(()=>k.selectedDstCluster,y=>{y&&N(()=>{K()})},{immediate:!1}),(y,l)=>{const v=f("el-button"),c=f("el-divider"),V=f("el-input-number"),u=f("el-col"),g=f("el-row"),p=f("el-form-item"),r=f("el-radio"),b=f("el-radio-group"),F=f("el-time-picker"),L=f("el-form"),j=f("el-card");return S(),h("div",re,[e(g,{gutter:10},{default:t(()=>[e(u,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:t(()=>[e(j,{shadow:"never",style:{"min-height":"80vh"}},{header:t(()=>[m("div",me,[o(i(a(s)("setting.system.title"))+" ",1),e(v,{loading:A.value,type:"primary",onClick:E},{default:t(()=>[o(i(a(s)("setting.system.titleButton")),1)]),_:1},8,["loading"])])]),default:t(()=>[m("div",null,[e(L,{ref_key:"systemSettingFormRef",ref:D,"hide-required-asterisk":!0,model:n.value,rules:T,size:a(P)?"small":"large","label-position":"top"},{default:t(()=>[m("div",ge,i(a(s)("setting.system.tip1")),1),e(c,{"content-position":"left"},{default:t(()=>[o(i(a(s)("setting.system.playerList.divider")),1)]),_:1}),e(p,{label:a(s)("setting.system.playerList.title"),prop:"schedulerSetting.playerGetFrequency"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(V,{modelValue:n.value.schedulerSetting.playerGetFrequency,"onUpdate:modelValue":l[0]||(l[0]=d=>n.value.schedulerSetting.playerGetFrequency=d),"controls-position":"right",disabled:a(B).role!=="admin"},{suffix:t(()=>[_.value==="zh"?(S(),h("span",pe,"秒")):(S(),h("span",fe,"Second"))]),_:1},8,["modelValue","disabled"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",ce,i(a(s)("setting.system.playerList.msg")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(c,{"content-position":"left"},{default:t(()=>[o(i(a(s)("setting.system.uidMap.divider")),1)]),_:1}),e(p,{label:a(s)("setting.system.uidMap.title"),prop:"schedulerSetting.UIDMaintain.disable"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(b,{modelValue:n.value.schedulerSetting.UIDMaintain.disable,"onUpdate:modelValue":l[1]||(l[1]=d=>n.value.schedulerSetting.UIDMaintain.disable=d),disabled:a(B).role!=="admin"},{default:t(()=>[e(r,{value:!1},{default:t(()=>[o(i(a(s)("setting.system.uidMap.enable")),1)]),_:1}),e(r,{value:!0},{default:t(()=>[o(i(a(s)("setting.system.uidMap.disable")),1)]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",_e,i(a(s)("setting.system.uidMap.msg")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(p,{label:a(s)("setting.system.uidMap.title2"),prop:"schedulerSetting.UIDMaintain.frequency"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(V,{modelValue:n.value.schedulerSetting.UIDMaintain.frequency,"onUpdate:modelValue":l[2]||(l[2]=d=>n.value.schedulerSetting.UIDMaintain.frequency=d),"controls-position":"right",disabled:a(B).role!=="admin"},{suffix:t(()=>[_.value==="zh"?(S(),h("span",ye,"分钟")):(S(),h("span",ve,"Minute"))]),_:1},8,["modelValue","disabled"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",be,i(a(s)("setting.system.uidMap.msg2")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(c,{"content-position":"left"},{default:t(()=>[o(i(a(s)("setting.system.metrics.divider")),1)]),_:1}),e(p,{label:a(s)("setting.system.metrics.title"),prop:"schedulerSetting.sysMetricsGet.disable"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(b,{modelValue:n.value.schedulerSetting.sysMetricsGet.disable,"onUpdate:modelValue":l[3]||(l[3]=d=>n.value.schedulerSetting.sysMetricsGet.disable=d),disabled:a(B).role!=="admin"},{default:t(()=>[e(r,{value:!1},{default:t(()=>[o(i(a(s)("setting.system.uidMap.enable")),1)]),_:1}),e(r,{value:!0},{default:t(()=>[o(i(a(s)("setting.system.uidMap.disable")),1)]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",Se,i(a(s)("setting.system.metrics.msg")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(c,{"content-position":"left"},{default:t(()=>[o(i(a(s)("setting.system.autoUpdate.divider")),1)]),_:1}),e(p,{label:a(s)("setting.system.autoUpdate.title"),prop:"schedulerSetting.autoUpdate.enable"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(b,{modelValue:n.value.schedulerSetting.autoUpdate.enable,"onUpdate:modelValue":l[4]||(l[4]=d=>n.value.schedulerSetting.autoUpdate.enable=d),disabled:a(B).role!=="admin"},{default:t(()=>[e(r,{value:!0},{default:t(()=>[o(i(a(s)("setting.system.uidMap.enable")),1)]),_:1}),e(r,{value:!1},{default:t(()=>[o(i(a(s)("setting.system.uidMap.disable")),1)]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",he,i(a(s)("setting.system.autoUpdate.msg")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(p,{label:a(s)("setting.system.autoUpdate.title2"),prop:"schedulerSetting.autoUpdate.time"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(F,{modelValue:n.value.schedulerSetting.autoUpdate.time,"onUpdate:modelValue":l[5]||(l[5]=d=>n.value.schedulerSetting.autoUpdate.time=d),clearable:!1,editable:!1,style:{width:"120px",margin:"0 8px"},disabled:a(B).role!=="admin","value-format":"HH:mm:ss"},null,8,["modelValue","disabled"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",Be,i(a(s)("setting.system.autoUpdate.msg2")),1)]),_:1})]),_:1})]),_:1},8,["label"]),m("div",ke,i(a(s)("setting.system.tip2")),1),e(c,{"content-position":"left"},{default:t(()=>[o(i(a(s)("setting.system.autoRestart.divider")),1)]),_:1}),e(p,{label:a(s)("setting.system.autoRestart.title"),prop:"sysSetting.autoRestart.enable"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(b,{modelValue:n.value.sysSetting.autoRestart.enable,"onUpdate:modelValue":l[6]||(l[6]=d=>n.value.sysSetting.autoRestart.enable=d)},{default:t(()=>[e(r,{value:!0},{default:t(()=>[o(i(a(s)("setting.system.uidMap.enable")),1)]),_:1}),e(r,{value:!1},{default:t(()=>[o(i(a(s)("setting.system.uidMap.disable")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",Ve,i(a(s)("setting.system.autoRestart.msg")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(p,{label:a(s)("setting.system.autoRestart.title2"),prop:"sysSetting.autoRestart.time"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(F,{modelValue:n.value.sysSetting.autoRestart.time,"onUpdate:modelValue":l[7]||(l[7]=d=>n.value.sysSetting.autoRestart.time=d),clearable:!1,editable:!1,style:{width:"120px",margin:"0 8px"},"value-format":"HH:mm:ss"},null,8,["modelValue"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",Me,i(a(s)("setting.system.autoUpdate.msg2")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(c,{"content-position":"left"},{default:t(()=>[o(i(a(s)("setting.system.autoBackup.divider")),1)]),_:1}),e(p,{label:a(s)("setting.system.autoBackup.title"),prop:"sysSetting.autoBackup.enable"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(b,{modelValue:n.value.sysSetting.autoBackup.enable,"onUpdate:modelValue":l[8]||(l[8]=d=>n.value.sysSetting.autoBackup.enable=d)},{default:t(()=>[e(r,{value:!0},{default:t(()=>[o(i(a(s)("setting.system.uidMap.enable")),1)]),_:1}),e(r,{value:!1},{default:t(()=>[o(i(a(s)("setting.system.uidMap.disable")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",Ue,i(a(s)("setting.system.autoBackup.msg")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(p,{label:a(s)("setting.system.autoBackup.title2"),prop:"sysSetting.autoBackup.time"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(F,{modelValue:n.value.sysSetting.autoBackup.time,"onUpdate:modelValue":l[9]||(l[9]=d=>n.value.sysSetting.autoBackup.time=d),clearable:!1,editable:!1,style:{width:"120px",margin:"0 8px"},"value-format":"HH:mm:ss"},null,8,["modelValue"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",Re,i(a(s)("setting.system.autoBackup.msg2")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(c,{"content-position":"left"},{default:t(()=>[o(i(a(s)("setting.system.keepalive.divider")),1)]),_:1}),e(p,{label:a(s)("setting.system.keepalive.title0"),prop:"sysSetting.keepalive.enable"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(b,{modelValue:n.value.sysSetting.keepalive.enable,"onUpdate:modelValue":l[10]||(l[10]=d=>n.value.sysSetting.keepalive.enable=d)},{default:t(()=>[e(r,{value:!0},{default:t(()=>[o(i(a(s)("setting.system.uidMap.enable")),1)]),_:1}),e(r,{value:!1},{default:t(()=>[o(i(a(s)("setting.system.uidMap.disable")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",qe,i(a(s)("setting.system.keepalive.msg0")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(p,{label:a(s)("setting.system.keepalive.title"),prop:"sysSetting.keepalive.frequency"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(V,{modelValue:n.value.sysSetting.keepalive.frequency,"onUpdate:modelValue":l[11]||(l[11]=d=>n.value.sysSetting.keepalive.frequency=d),"controls-position":"right"},{suffix:t(()=>[_.value==="zh"?(S(),h("span",Ae,"分钟")):(S(),h("span",Fe,"Minute"))]),_:1},8,["modelValue"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",Ie,i(a(s)("setting.system.keepalive.msg")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(c,{"content-position":"left"},{default:t(()=>[o(i(a(s)("setting.system.bit64.divider")),1)]),_:1}),e(p,{label:a(s)("setting.system.bit64.title"),prop:"sysSetting.bit64"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(b,{modelValue:n.value.sysSetting.bit64,"onUpdate:modelValue":l[12]||(l[12]=d=>n.value.sysSetting.bit64=d),disabled:w.value==="darwin"},{default:t(()=>[e(r,{value:!0},{default:t(()=>[o(i(a(s)("setting.system.uidMap.enable")),1)]),_:1}),e(r,{value:!1},{default:t(()=>[o(i(a(s)("setting.system.uidMap.disable")),1)]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",xe,i(a(s)("setting.system.bit64.msg")),1)]),_:1})]),_:1})]),_:1},8,["label"]),e(p,{label:"Tick Rate",prop:"sysSetting.tickRate"},{default:t(()=>[e(g,null,{default:t(()=>[e(u,{span:24},{default:t(()=>[e(b,{modelValue:n.value.sysSetting.tickRate,"onUpdate:modelValue":l[13]||(l[13]=d=>n.value.sysSetting.tickRate=d)},{default:t(()=>[e(r,{value:15},{default:t(()=>l[14]||(l[14]=[o("15")])),_:1}),e(r,{value:30},{default:t(()=>l[15]||(l[15]=[o("30")])),_:1}),e(r,{value:45},{default:t(()=>l[16]||(l[16]=[o("45")])),_:1}),e(r,{value:60},{default:t(()=>l[17]||(l[17]=[o("60")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{span:24},{default:t(()=>[m("div",De,i(a(s)("setting.system.tickRate.msg")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"])])]),_:1})]),_:1})]),_:1})])}}});export{Pe as default};
