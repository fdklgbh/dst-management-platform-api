import{u as Ne,a as Fe,g as Ie,D as Be,G as Pe,b as Re,H as Se,c as ge,o as Ue,a8 as z,A as V,r as g,w as Ae,I as Z,J as c,K as Ke,e as r,f as y,j as a,k as e,x as S,i as n,l as m,p as i,t as o,m as p,F as ee,v as te,s as le,a9 as Te,n as _e,a7 as Me,a0 as qe,C as Ee}from"./index-C-KsYsfv.js";const je={class:"page-div"},He={class:"card-header"},We={key:0},Ge={key:1},Je={class:"card-header"},Oe={key:0},Qe={style:{"margin-top":"20px"}},Xe={class:"card-header"},Ye={key:0},Ze={style:{"margin-top":"20px"}},et={class:"card-header"},tt={key:0},lt={style:{"margin-top":"20px"}},at={class:"card-header"},st={class:"fcc"},nt={class:"el-upload__text"},ot={class:"el-upload__tip"},it=qe({name:"settingsPlayer"}),rt=Object.assign(it,{setup(dt){const{t:d}=Ne(),{isMobile:$}=Fe(),h=Ie(),U=Be();Pe();const ae=Re(),se=Se("refresh"),L=ge(()=>h.isDark),k=ge(()=>h.language);Ue(()=>{w()});const w=(s=!1)=>{z.player.list.get({clusterName:h.selectedDstCluster}).then(l=>{E.value=l.data.players,j.value=l.data.uidMap,N.value=[];for(let u of l.data.adminList)u!==""&&N.value.push(u);F.value=[];for(let u of l.data.blockList)u!==""&&F.value.push(u);I.value=[];for(let u of l.data.whiteList)u!==""&&I.value.push(u);if(s){let u;k.value==="zh"?u="刷新成功":u="Refresh Success",V(u)}})},ne=g("players"),E=g([]),j=g({}),N=g([]),F=g([]),I=g([]),A=s=>{for(let l of N.value)if(l===s)return!0},oe=s=>{for(let l of F.value)if(l===s)return!0},ie=s=>{for(let l of I.value)if(l===s)return!0},de=s=>{switch(s.type){case"admin":C(s.type,"add",s.uid);break;case"block":C(s.type,"add",s.uid);break;case"white":C(s.type,"add",s.uid);break;case"kick":ve(s.uid);break}},C=(s,l,u)=>{const f={clusterName:h.selectedDstCluster,listName:s,type:l,uid:u};z.player.change.post(f).then(_=>{V(_.message),w()})},ve=s=>{const l={clusterName:h.selectedDstCluster,uid:s};z.player.kick.post(l).then(u=>{V(u.message)})},H=s=>s in j.value?" ["+j.value[s]+"]":k.value==="zh"?" [暂未获取到]":" [Not yet obtained]",ye=(s,l)=>{s.paneName==="history"&&J()},W=g([]),G=g(!1),J=(s=!1)=>{G.value=!0,W.value=[];const l={clusterName:h.selectedDstCluster};z.player.history.get(l).then(u=>{for(let f of u.data)f.uid.length===11&&W.value.push(f);if(s){let f;k.value==="zh"?f="刷新成功":f="Refresh Success",V(f)}}).finally(()=>{G.value=!1})},O=g(),K=g(!1),x=g(!1),he=()=>{O.value&&O.value.clearFiles(),K.value=!0,x.value=!1},be=s=>/\.xls|xlsx$/i.test(s.name)?!0:(Ee(k.value==="zh"?"请上传Excel文件":"Please upload a Excel file"),!1),ke=s=>{x.value=!0;const l=new FormData;l.append("file",s.file),z.player.addBlockUpload.post(l).then(u=>{w(),V(u.message)}).finally(()=>{K.value=!1,x.value=!1})},we=()=>{setTimeout(()=>{U.meta.isKeepAlive&&ae.removeKeepAliveName(U.name),se(!1),Z(()=>{U.meta.isKeepAlive&&ae.addKeepAliveName(U.name),se(!0)})},0)},B=g(!1),T=g(),v=g(""),Q=()=>{B.value=!0,Z(()=>{T.value.input.focus()})},D=s=>{v.value&&C(s,"add",v.value),B.value=!1,v.value=""},Ce=()=>{const s={clusterName:h.selectedDstCluster};z.player.historyClean.post(s).then(l=>{V(l.message)}).finally(()=>{J(!1)})};return Ae(()=>h.selectedDstCluster,s=>{s&&Z(()=>{we()})},{immediate:!1}),(s,l)=>{const u=c("el-button"),f=c("el-table-column"),_=c("el-tag"),ue=c("arrow-down"),M=c("el-icon"),b=c("el-dropdown-item"),re=c("el-dropdown-menu"),pe=c("el-dropdown"),ce=c("el-table"),q=c("el-result"),P=c("el-card"),R=c("el-tab-pane"),X=c("el-alert"),Y=c("el-input"),xe=c("el-tooltip"),$e=c("el-tabs"),Le=c("el-col"),De=c("el-row"),ze=c("el-upload"),Ve=c("el-dialog"),fe=Ke("loading");return r(),y("div",je,[a(De,{gutter:10},{default:e(()=>[a(Le,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[a($e,{modelValue:ne.value,"onUpdate:modelValue":l[14]||(l[14]=t=>ne.value=t),onTabClick:ye},{default:e(()=>[a(R,{label:s.$t("setting.players"),name:"players"},{default:e(()=>[a(P,{style:S(n($)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:e(()=>[m("div",He,[i(o(n(d)("setting.players"))+" ",1),m("div",null,[a(u,{size:"default",onClick:l[0]||(l[0]=t=>w(!0))},{default:e(()=>[i(o(n(d)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[E.value?(r(),p(ce,{key:0,data:E.value,border:"",size:"small",style:{width:"100%"}},{default:e(()=>[a(f,{label:s.$t("setting.nickName"),prop:"nickName"},null,8,["label"]),a(f,{label:s.$t("setting.role"),prop:"prefab"},{default:e(t=>[t.row.prefab===""?(r(),y("span",We,o(n(d)("setting.roleFail")),1)):(r(),y("span",Ge,o(t.row.prefab),1))]),_:1},8,["label"]),a(f,{label:s.$t("setting.age"),prop:"age"},{default:e(t=>[t.row.age?(r(),p(_,{key:0,type:"success"},{default:e(()=>[i(o(t.row.age),1)]),_:2},1024)):(r(),p(_,{key:1,type:"warning"},{default:e(()=>[i(o(n(d)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(f,{label:"UID",prop:"uid"}),a(f,{label:s.$t("setting.button.actions"),prop:"actions"},{default:e(t=>[a(pe,{trigger:"hover",onCommand:de},{dropdown:e(()=>[a(re,null,{default:e(()=>[a(b,{command:{type:"admin",uid:t.row.uid},disabled:A(t.row.uid)},{default:e(()=>[i(o(n(d)("setting.addAdmin")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"block",uid:t.row.uid},disabled:oe(t.row.uid)},{default:e(()=>[i(o(n(d)("setting.addBlock")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"white",uid:t.row.uid},disabled:ie(t.row.uid)},{default:e(()=>[i(o(n(d)("setting.addWhite")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"kick",uid:t.row.uid},disabled:A(t.row.uid),divided:""},{default:e(()=>[i(o(n(d)("setting.kick")),1)]),_:2},1032,["command","disabled"])]),_:2},1024)]),default:e(()=>[a(u,{link:"",type:"primary"},{default:e(()=>[i(o(n(d)("setting.button.actions"))+" ",1),a(M,{class:"el-icon--right"},{default:e(()=>[a(ue)]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])):(r(),p(q,{key:1,title:s.$t("setting.noPlayersFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1},8,["style"])]),_:1},8,["label"]),a(R,{label:s.$t("setting.adminList"),name:"adminList"},{default:e(()=>[a(P,{style:S(n($)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:e(()=>[m("div",Je,[i(o(n(d)("setting.adminList"))+" ",1),m("div",null,[a(u,{size:"default",onClick:l[1]||(l[1]=t=>w(!0))},{default:e(()=>[i(o(n(d)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[N.value.length>0?(r(),y("div",Oe,[a(X,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[i(o(n(d)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),m("div",Qe,[(r(!0),y(ee,null,te(N.value,t=>(r(),p(_,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:me=>C("admin","delete",t)},{default:e(()=>[i(o(t+H(t)),1)]),_:2},1032,["effect","onClose"]))),256)),B.value?(r(),p(Y,{key:0,ref_key:"InputRef",ref:T,modelValue:v.value,"onUpdate:modelValue":l[2]||(l[2]=t=>v.value=t),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[3]||(l[3]=le(t=>D("admin"),["enter"])),onBlur:l[4]||(l[4]=t=>D("admin"))},null,8,["modelValue"])):(r(),p(u,{key:1,onClick:Q,style:{margin:"5px 5px 0 0"}},{default:e(()=>[i(o(k.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])])):(r(),p(q,{key:1,title:s.$t("setting.noAdminFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1},8,["style"])]),_:1},8,["label"]),a(R,{label:s.$t("setting.blockList"),name:"blockList"},{default:e(()=>[a(P,{style:S(n($)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:e(()=>[m("div",Xe,[i(o(n(d)("setting.blockList"))+" ",1),m("div",null,[a(u,{type:"success",onClick:he},{default:e(()=>[i(o(n(d)("setting.blockListItems.uploadButton")),1)]),_:1}),a(u,{size:"default",onClick:l[5]||(l[5]=t=>w(!0))},{default:e(()=>[i(o(n(d)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[F.value.length>0?(r(),y("div",Ye,[a(X,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[i(o(n(d)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),m("div",Ze,[(r(!0),y(ee,null,te(F.value,t=>(r(),p(_,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:me=>C("block","delete",t)},{default:e(()=>[i(o(t+H(t)),1)]),_:2},1032,["effect","onClose"]))),256)),B.value?(r(),p(Y,{key:0,ref_key:"InputRef",ref:T,modelValue:v.value,"onUpdate:modelValue":l[6]||(l[6]=t=>v.value=t),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[7]||(l[7]=le(t=>D("block"),["enter"])),onBlur:l[8]||(l[8]=t=>D("block"))},null,8,["modelValue"])):(r(),p(u,{key:1,onClick:Q,style:{margin:"5px 5px 0 0"}},{default:e(()=>[i(o(k.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])])):(r(),p(q,{key:1,title:s.$t("setting.noBlockFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1},8,["style"])]),_:1},8,["label"]),a(R,{label:s.$t("setting.whiteList"),name:"whiteList"},{default:e(()=>[a(P,{style:S(n($)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:e(()=>[m("div",et,[i(o(n(d)("setting.whiteList"))+" ",1),m("div",null,[a(u,{size:"default",onClick:l[9]||(l[9]=t=>w(!0))},{default:e(()=>[i(o(n(d)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[I.value.length>0?(r(),y("div",tt,[a(X,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[i(o(n(d)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),m("div",lt,[(r(!0),y(ee,null,te(I.value,t=>(r(),p(_,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:me=>C("white","delete",t)},{default:e(()=>[i(o(t+H(t)),1)]),_:2},1032,["effect","onClose"]))),256)),B.value?(r(),p(Y,{key:0,ref_key:"InputRef",ref:T,modelValue:v.value,"onUpdate:modelValue":l[10]||(l[10]=t=>v.value=t),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[11]||(l[11]=le(t=>D("white"),["enter"])),onBlur:l[12]||(l[12]=t=>D("white"))},null,8,["modelValue"])):(r(),p(u,{key:1,onClick:Q,style:{margin:"5px 5px 0 0"}},{default:e(()=>[i(o(k.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])])):(r(),p(q,{key:1,title:s.$t("setting.noWhiteFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1},8,["style"])]),_:1},8,["label"]),a(R,{label:n(d)("setting.historyPlayer"),name:"history"},{default:e(()=>[a(P,{style:S(n($)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:e(()=>[m("div",at,[a(xe,{content:n(d)("setting.historyPlayerTip"),effect:"light",placement:"top"},{default:e(()=>[m("div",st,[i(o(n(d)("setting.historyPlayer"))+" ",1),a(M,null,{default:e(()=>[a(n(Te))]),_:1})])]),_:1},8,["content"]),m("div",null,[a(u,{size:"default",type:"danger",onClick:Ce},{default:e(()=>[i(o(n(d)("setting.historyClean")),1)]),_:1}),a(u,{size:"default",onClick:l[13]||(l[13]=t=>J(!0))},{default:e(()=>[i(o(n(d)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[_e((r(),p(ce,{ref:"tableRef",data:W.value,"max-height":n($)?450:550,border:""},{default:e(()=>[a(f,{label:s.$t("setting.nickName"),prop:"nickname"},null,8,["label"]),a(f,{label:s.$t("setting.role"),prop:"prefab"},{default:e(t=>[t.row.prefab?(r(),p(_,{key:0,type:"success"},{default:e(()=>[i(o(t.row.prefab),1)]),_:2},1024)):(r(),p(_,{key:1,type:"warning"},{default:e(()=>[i(o(n(d)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(f,{label:s.$t("setting.age"),prop:"age"},{default:e(t=>[t.row.age?(r(),p(_,{key:0,type:"success"},{default:e(()=>[i(o(t.row.age),1)]),_:2},1024)):(r(),p(_,{key:1,type:"warning"},{default:e(()=>[i(o(n(d)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(f,{label:"UID",prop:"uid"}),a(f,{label:s.$t("setting.button.actions"),prop:"actions"},{default:e(t=>[a(pe,{trigger:"hover",onCommand:de},{dropdown:e(()=>[a(re,null,{default:e(()=>[a(b,{command:{type:"admin",uid:t.row.uid},disabled:A(t.row.uid)},{default:e(()=>[i(o(n(d)("setting.addAdmin")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"block",uid:t.row.uid},disabled:oe(t.row.uid)},{default:e(()=>[i(o(n(d)("setting.addBlock")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"white",uid:t.row.uid},disabled:ie(t.row.uid)},{default:e(()=>[i(o(n(d)("setting.addWhite")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"kick",uid:t.row.uid},disabled:A(t.row.uid),divided:""},{default:e(()=>[i(o(n(d)("setting.kick")),1)]),_:2},1032,["command","disabled"])]),_:2},1024)]),default:e(()=>[a(u,{link:"",type:"primary"},{default:e(()=>[i(o(n(d)("setting.button.actions"))+" ",1),a(M,{class:"el-icon--right"},{default:e(()=>[a(ue)]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data","max-height"])),[[fe,G.value]])]),_:1},8,["style"])]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(Ve,{modelValue:K.value,"onUpdate:modelValue":l[15]||(l[15]=t=>K.value=t),"close-on-click-modal":!x.value,"close-on-press-escape":!x.value,"show-close":!x.value,title:n(d)("setting.blockListItems.uploadButton"),width:"45%"},{default:e(()=>[_e((r(),p(ze,{ref_key:"uploadRef",ref:O,"before-upload":be,"http-request":ke,limit:1,drag:""},{tip:e(()=>[m("div",ot,o(n(d)("setting.blockListItems.tips")),1)]),default:e(()=>[a(M,{class:"el-icon--upload"},{default:e(()=>[a(n(Me))]),_:1}),m("div",nt,[i(o(n(d)("setting.import.dialog.text1"))+" ",1),m("em",null,o(n(d)("setting.import.dialog.text2")),1)])]),_:1})),[[fe,x.value]])]),_:1},8,["modelValue","close-on-click-modal","close-on-press-escape","show-close","title"])])}}});export{rt as default};
