import{_ as Ue,o as Ve,u as Fe,a as Ie,g as Le,c as Ne,r as d,A as n,B as Oe,d as s,e as h,f as l,w as e,k as A,l as u,i as r,q as Te,m as i,F as D,s as B,t as U,j as c,p as V,n as b,V as Ae,x as F,z as Be}from"./index-CjVQdqiy.js";import{s as w}from"./index-DdAR7hD9.js";import{e as oe}from"./index-CRlSfwWO.js";import $e from"./modInfo-A-L0WPm3.js";import{f as qe}from"./tools-CuQXwsJG.js";const je={class:"page-div"},Ee={class:"item-container"},Ge={class:"card-footer",style:{"margin-top":"20px"}},Pe={class:"card-header"},Re={style:{display:"flex"}},Ke={style:{display:"flex","margin-left":"5px","flex-direction":"column","justify-content":"center"}},He={class:"card-header"},Je=Ae({name:"settingsMod"}),Qe=Object.assign(Je,{setup(We){Ve(async()=>{await C()});const{t:ne}=Fe(),{isMobile:p}=Ie(),se=Le();Ne(()=>se.isDark);const W=d("Download"),de=(o,t)=>{o.paneName==="Add"&&L(),o.paneName==="Setting"&&X()},m=d([]),$=d(!1),X=()=>{$.value=!0,f.value=0,q.value="",w.mod.settingFormat.get().then(o=>{m.value=o.data}).finally(()=>{$.value=!1})},f=d(0),q=d(""),Y=(o,t)=>{f.value=o,q.value=t,ie()},x=d(!1),S=d({id:"",configOptions:[]}),ie=()=>{x.value=!0,w.mod.configOptions.get({id:f.value}).then(o=>{S.value=o.data}).finally(()=>{x.value=!1})},ue=()=>{x.value=!0,w.mod.configChange.post({modFormattedData:m.value}).then(o=>{F(o.message)}).finally(()=>{x.value=!1})},j=d(!1),I=d({total:0,rows:[]}),re=d(),g=d({page:1,pageSize:30,searchText:""}),C=()=>{j.value=!0,oe.modSearch.get(g.value).then(o=>{I.value.rows=o.data.rows,I.value.total=o.data.total}).finally(()=>{j.value=!1})},ce=o=>{C()},me=o=>{C()},Z=d([]),E=d(!1),L=()=>{E.value=!0,oe.modInfoDownloaded.get().then(o=>{Z.value=o.data}).finally(()=>{E.value=!1})},G=d(!1),pe=()=>{G.value=!0,w.mod.sync.post().then(o=>{F(o.message),L()}).finally(()=>{G.value=!1})},M=d(!1),fe=o=>{let t=o.cmd,v=o.row;switch(M.value=!0,t){case"enable":ge(v);break;case"delete":ve(v);break;default:M.value=!1,Be("error")}},ge=o=>{const v={isUgc:o.file_url==="",id:o.id};w.mod.enable.post(v).then(_=>{F(_.message)}).finally(()=>{M.value=!1})},ve=o=>{const v={isUgc:o.file_url==="",id:o.id};w.mod.delete.post(v).then(_=>{F(_.message),L()}).finally(()=>{M.value=!1})},P=d(!1),_e=()=>{P.value=!0;const t={isUgc:q.value==="",id:f.value};w.mod.disable.post(t).then(v=>{F(v.message),X()}).finally(()=>{P.value=!1})};return(o,t)=>{const v=n("el-input"),_=n("el-button"),N=n("el-form-item"),ee=n("el-form"),R=n("el-scrollbar"),he=n("el-pagination"),O=n("el-card"),K=n("el-tab-pane"),te=n("el-tooltip"),z=n("el-table-column"),k=n("el-tag"),ye=n("arrow-down"),be=n("el-icon"),le=n("el-dropdown-item"),we=n("el-dropdown-menu"),ke=n("el-dropdown"),xe=n("el-table"),H=n("el-col"),ae=n("el-row"),Se=n("el-image"),Ce=n("el-divider"),J=n("el-result"),Me=n("el-option"),ze=n("el-select"),De=n("el-tabs"),T=Oe("loading");return s(),h("div",je,[l(De,{modelValue:W.value,"onUpdate:modelValue":t[5]||(t[5]=a=>W.value=a),onTabClick:de},{default:e(()=>[l(K,{label:"Download",name:"Download"},{default:e(()=>[A((s(),u(O,{style:{height:"78vh"},shadow:"never"},{default:e(()=>[r("div",null,[l(ee,{ref_key:"modSearchFormRef",ref:re,model:g.value,inline:!0,onKeyup:Te(C,["enter"])},{default:e(()=>[l(N,null,{default:e(()=>[l(v,{modelValue:g.value.searchText,"onUpdate:modelValue":t[0]||(t[0]=a=>g.value.searchText=a),style:{width:"40vw"}},null,8,["modelValue"]),l(_,{type:"primary",onClick:C,style:{"margin-left":"10px"}},{default:e(()=>t[6]||(t[6]=[i("搜索")])),_:1})]),_:1})]),_:1},8,["model"])]),r("div",null,[l(R,{"max-height":"60vh"},{default:e(()=>[r("div",Ee,[(s(!0),h(D,null,B(I.value.rows,a=>(s(),u($e,{mod:a},null,8,["mod"]))),256))])]),_:1})]),r("div",Ge,[l(he,{"current-page":g.value.page,"onUpdate:currentPage":t[1]||(t[1]=a=>g.value.page=a),"page-size":g.value.pageSize,"onUpdate:pageSize":t[2]||(t[2]=a=>g.value.pageSize=a),"page-sizes":[10,20,30,40,50,100],layout:"total, sizes, prev, pager, next",total:I.value.total,onSizeChange:t[3]||(t[3]=a=>ce(g.value.pageSize)),onCurrentChange:t[4]||(t[4]=a=>me(g.value.page))},null,8,["current-page","page-size","total"])])]),_:1})),[[T,j.value]])]),_:1}),l(K,{label:"Add",name:"Add"},{default:e(()=>[l(ae,{gutter:10},{default:e(()=>[l(H,{span:24},{default:e(()=>[A((s(),u(O,{style:{height:"70vh"},shadow:"never"},{header:e(()=>[r("div",Pe,[t[9]||(t[9]=r("span",null,"已下载的模组",-1)),r("div",null,[l(_,{onClick:L},{default:e(()=>t[7]||(t[7]=[i("刷新")])),_:1}),l(te,{effect:"light","show-after":500,content:"该页面只展示手动下载的模组，点击此按钮将同步自动下载的模组到此页面",placement:"top"},{default:e(()=>[l(_,{type:"primary",loading:G.value,onClick:pe},{default:e(()=>t[8]||(t[8]=[i(" 同步 ")])),_:1},8,["loading"])]),_:1})])])]),default:e(()=>[l(xe,{data:Z.value,border:"",style:{height:"55vh"}},{default:e(()=>[l(z,{label:"name",prop:"name"}),l(z,{label:"id",prop:"id"}),l(z,{label:"ugc"},{default:e(a=>[a.row.file_url===""?(s(),u(k,{key:0,type:"primary"},{default:e(()=>t[10]||(t[10]=[i(" 是 ")])),_:1})):(s(),u(k,{key:1,type:"primary"},{default:e(()=>t[11]||(t[11]=[i(" 否 ")])),_:1}))]),_:1}),l(z,{label:"size"},{default:e(a=>[i(U(c(qe)(a.row.size)),1)]),_:1}),l(z,{label:"action"},{default:e(a=>[l(ke,{onCommand:fe,trigger:"click"},{dropdown:e(()=>[l(we,null,{default:e(()=>[l(le,{command:{cmd:"enable",row:a.row}},{default:e(()=>t[12]||(t[12]=[i("添加")])),_:2},1032,["command"]),l(le,{command:{cmd:"delete",row:a.row}},{default:e(()=>t[13]||(t[13]=[i("删除")])),_:2},1032,["command"])]),_:2},1024)]),default:e(()=>[l(_,{type:"primary",link:"",loading:M.value},{default:e(()=>[i(U(c(ne)("setting.button.actions")),1),l(be,{class:"el-icon--right"},{default:e(()=>[l(ye)]),_:1})]),_:1},8,["loading"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})),[[T,E.value]])]),_:1})]),_:1})]),_:1}),l(K,{label:"Setting",name:"Setting"},{default:e(()=>[l(ae,{gutter:10},{default:e(()=>[l(H,{lg:8,md:8,sm:24,span:8,xs:24},{default:e(()=>[A((s(),u(O,{style:V(c(p)?"height: 50vh":"height: 70vh"),shadow:"never"},{default:e(()=>[l(R,{"max-height":c(p)?"45vh":"65vh"},{default:e(()=>[m.value?(s(!0),h(D,{key:0},B(m.value,(a,y)=>(s(),h(D,null,[r("div",Re,[r("div",null,[l(Se,{src:a.preview_url,fit:"fill",onClick:Q=>Y(a.id),style:{width:"75px",height:"75px"}},null,8,["src","onClick"])]),r("div",Ke,[l(_,{link:"",type:"primary",onClick:Q=>Y(a.id,a.file_url)},{default:e(()=>[i(U(a.name),1)]),_:2},1032,["onClick"]),r("div",null,[a.enable?(s(),u(k,{key:0,type:"success"},{default:e(()=>t[14]||(t[14]=[i("启用")])),_:1})):b("",!0),a.enable?b("",!0):(s(),u(k,{key:1,type:"info"},{default:e(()=>t[15]||(t[15]=[i("禁用")])),_:1}))])])]),y!==m.value.length-1?(s(),u(Ce,{key:0})):b("",!0)],64))),256)):(s(),h("div",{key:1,class:"fcc",style:V(c(p)?"height: 50vh":"height: 70vh")},[l(J,{icon:"warning",title:"服务器未添加模组"})],4))]),_:1},8,["max-height"])]),_:1},8,["style"])),[[T,$.value]])]),_:1}),l(H,{lg:16,md:16,sm:24,span:16,xs:24},{default:e(()=>[A((s(),u(O,{style:V(c(p)?"height: 50vh; margin-top: 10px":"height: 70vh"),shadow:"never"},{header:e(()=>[r("div",He,[t[17]||(t[17]=r("span",null,"配置模组",-1)),l(_,{type:"danger",disabled:f.value===0,loading:P.value,onClick:_e},{default:e(()=>t[16]||(t[16]=[i("禁用模组")])),_:1},8,["disabled","loading"])])]),default:e(()=>[f.value!==0?(s(),u(R,{key:0,"max-height":c(p)?"45vh":"65vh"},{default:e(()=>[S.value.configOptions.length!==0?(s(),u(ee,{key:0,ref:"modSettingFormRef",size:c(p)?"small":"large","label-position":c(p)?"top":"left","label-width":c(p)?"70":"auto"},{default:e(()=>[l(N,{label:"ID"},{default:e(()=>[l(k,null,{default:e(()=>[i(U(S.value.id),1)]),_:1})]),_:1}),l(N,{label:"Name"},{default:e(()=>[l(k,{type:"info"},{default:e(()=>[i(U(m.value[m.value.findIndex(a=>a.id===f.value)].name),1)]),_:1})]),_:1}),(s(!0),h(D,null,B(S.value.configOptions,a=>(s(),u(te,{"show-after":500,effect:"light",content:a.hover,placement:"top"},{default:e(()=>[l(N,{label:a.label},{default:e(()=>[l(ze,{modelValue:m.value[m.value.findIndex(y=>y.id===f.value)].configurationOptions[a.name],"onUpdate:modelValue":y=>m.value[m.value.findIndex(Q=>Q.id===f.value)].configurationOptions[a.name]=y,onChange:ue},{default:e(()=>[(s(!0),h(D,null,B(a.options,y=>(s(),u(Me,{label:y.description,value:y.data},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1032,["content"]))),256))]),_:1},8,["size","label-position","label-width"])):b("",!0),S.value.configOptions.length===0?(s(),h("div",{key:1,class:"fcc",style:V(c(p)?"height: 40vh; margin-top: 10px":"height: 60vh")},[l(J,{icon:"info",title:"该模组无配置项"})],4)):b("",!0)]),_:1},8,["max-height"])):b("",!0),f.value===0?(s(),h("div",{key:1,class:"fcc",style:V(c(p)?"height: 40vh; margin-top: 10px":"height: 60vh")},[l(J,{icon:"info",title:"请选择一个模组进行配置"})],4)):b("",!0)]),_:1},8,["style"])),[[T,x.value]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),lt=Ue(Qe,[["__scopeId","data-v-ba08a0c9"]]);export{lt as default};
