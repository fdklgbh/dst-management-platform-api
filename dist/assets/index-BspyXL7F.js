import{h as B,_ as Be,o as Ee,u as Le,a as De,g as Ue,c as pe,E as Pe,r as v,b as Ae,d as p,e as J,f as l,w as e,i as b,t as n,j as t,k as g,l as R,m as d,n as w,p as fe,q as ve,s as Me,F as Fe,v as Ne,x as Re,y as Q,z as qe,A as X,B as c,C as ge}from"./index-iCREqSRD.js";import{e as Y}from"./index-CFpzy-Yd.js";const $={roomInfo:{url:"/home/room_info",get:async function(k){return await B.get(this.url,k)}},sysInfo:{url:"/home/sys_info",get:async function(k){return await B.get(this.url,k)}},exec:{url:"/home/exec",post:async function(k){return await B.post(this.url,k)}},interface:{announce:{url:"/home/announce",post:async function(k){return await B.post(this.url,k)}},console:{url:"/home/console",post:async function(k){return await B.post(this.url,k)}}}},Ke={class:"page-div"},Ge={class:"card-header"},Oe={key:1,class:"fcc",style:{height:"150px"}},je={class:"card-header"},He={class:"fcc"},We={class:"percentage-value"},Je={class:"percentage-value"},Qe={class:"percentage-label"},Xe={class:"card-header"},Ye={class:"card-header"},Ze={__name:"index",setup(k){Ee(()=>{he(),be(),_e(),ye(),we()});const{t:o}=Le(),{isMobile:x}=De(),E=Ue();pe(()=>E.isDark);const h=pe(()=>E.language),he=()=>{E.needUpdatePassword&&(Pe({title:o("home.updatePasswordTitle"),message:o("home.updatePassword"),type:"warning"}),E.needUpdatePassword=!1)};v(!1);const q=v(!1),K=v(!1),V=v({server:0,local:0}),L=v(""),_e=()=>{q.value=!0,Y.dstVersion.get().then(u=>{V.value=u.data}).finally(()=>{q.value=!1})},ye=()=>{K.value=!0,Y.connectionCode.get().then(u=>{L.value=u.data}).finally(()=>{K.value=!1})},i=v({roomSettingBase:{},seasonInfo:{season:{},cycles:0,elapsedDays:0,seasonLength:{summer:15,autumn:20,spring:20,winter:15},phase:{}},modsCount:0,playerNum:0}),be=()=>{$.roomInfo.get().then(u=>{i.value=u.data})},Z=u=>i.value.seasonInfo.cycles>-1?`(${i.value.seasonInfo.elapsedDays}/${i.value.seasonInfo.seasonLength[u]})`:"",m=v({cpu:0,memory:0,master:0,caves:0}),ke=()=>{$.sysInfo.get().then(u=>{m.value=u.data})},ee=[{color:"#5cb87a",percentage:20},{color:"#1989fa",percentage:40},{color:"#e6a23c",percentage:60},{color:"#f56c6c",percentage:80},{color:"#6f7ad3",percentage:100}];let D=null;const we=()=>{D=setInterval(()=>{!U.value&&!P.value&&ke()},2e3)},le=()=>{D&&(clearInterval(D),D=null)},U=v(!1),P=v(!1),ae=u=>{if(m.value.master,u==="master"){const a={type:"masterSwitch",info:m.value.master};U.value=!0,$.exec.post(a).finally(()=>{U.value=!1})}else{const a={type:"cavesSwitch",info:m.value.caves};P.value=!0,$.exec.post(a).finally(()=>{P.value=!1})}},f=(u,a)=>{const A={startup:{en:"STARTUP",zh:"启动"},rollback:{en:"ROLLBACK",zh:"回档"},shutdown:{en:"SHUTDOWN",zh:"关闭"},restart:{en:"RESTART",zh:"重启"},update:{en:"UPDATE GAME",zh:"更新游戏"},reset:{en:"RESET GAME",zh:"重置游戏"},delete:{en:"DELETE GAME",zh:"删除世界"}};Re.confirm(h.value==="zh"?`将执行 ${A[u].zh} 操作，是否继续？`:`The ${A[u].en} operation will be performed. Do you want to continue?`,h.value==="zh"?"请确认您的操作":"Please confirm your operation",{confirmButtonText:h.value==="zh"?"确定":"confirm",cancelButtonText:h.value==="zh"?"取消":"cancel",type:"warning",beforeClose:(W,r,_)=>{if(W==="confirm"){r.confirmButtonLoading=!0;const M={type:u,info:a};$.exec.post(M).then(y=>{Q(y.message),_()}).catch(()=>{}).finally(()=>{r.confirmButtonLoading=!1})}else _()}}).then(()=>{}).catch(()=>{qe(o("home.canceled"))})},G=v(!1),S=v({message:""}),te=()=>{if(S.value.message===""){X(h.value==="zh"?"请输入要宣告的内容":"Please enter the content to be announced");return}G.value=!0,$.interface.announce.post(S.value).then(u=>{Q(u.message),S.value.message=""}).finally(()=>{G.value=!1})},O=v(!1),z=v({cmd:"",world:""}),oe=()=>{if(z.value.world===""){X(h.value==="zh"?"请选择地面或洞穴":"Please select a world from ground and cave");return}if(z.value.cmd===""){X(h.value==="zh"?"请输入要执行的命令":"Please enter the command to execute");return}O.value=!0,$.interface.console.post(z.value).then(u=>{Q(u.message),z.value.cmd=""}).finally(()=>{O.value=!1})},j=v(!1),H=v(!1),ne=v([]),ze=()=>{j.value=!0,H.value=!0,Y.modInfo.get().then(u=>{ne.value=u.data}).finally(()=>{H.value=!1})};return Ae(()=>{le(),window.removeEventListener("beforeunload",le)}),(u,a)=>{const A=c("DocumentCopy"),W=c("el-icon"),r=c("el-button"),_=c("el-descriptions-item"),M=c("el-tooltip"),y=c("el-tag"),Ce=c("el-descriptions"),xe=c("el-result"),F=c("el-card"),C=c("el-col"),se=c("el-progress"),ue=c("el-row"),de=c("el-switch"),I=c("el-form-item"),N=c("el-form"),re=c("el-input"),ie=c("el-option"),Ie=c("el-select"),T=c("el-table-column"),$e=c("el-image"),Ve=c("el-table"),Se=c("el-dialog"),me=ge("copy"),ce=ge("loading");return p(),J("div",Ke,[l(ue,{gutter:10},{default:e(()=>[l(C,{lg:12,md:12,sm:24,span:12,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[b("div",Ge,n(t(o)("home.roomInfo")),1)]),default:e(()=>[i.value.roomSettingBase.name!==""?(p(),g(Ce,{key:0,column:t(x)?1:2},{default:e(()=>[l(_,{label:t(o)("home.roomName")},{default:e(()=>[R((p(),g(r,{link:"",type:"primary"},{default:e(()=>[d(n(i.value.roomSettingBase.name)+" ",1),l(W,{style:{"margin-left":"3px"}},{default:e(()=>[l(A)]),_:1})]),_:1})),[[me,i.value.roomSettingBase.name]])]),_:1},8,["label"]),l(_,{label:t(o)("home.connectionCode")},{default:e(()=>[l(M,{content:L.value,effect:"light",placement:"top"},{default:e(()=>[R((p(),g(r,{disabled:L.value==="",loading:K.value,link:"",type:"primary"},{default:e(()=>[d(n(t(o)("home.copy")),1)]),_:1},8,["disabled","loading"])),[[me,L.value]])]),_:1},8,["content"])]),_:1},8,["label"]),l(_,{label:t(o)("home.cycles")},{default:e(()=>[l(y,{type:i.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[d(n(i.value.seasonInfo.cycles),1)]),_:1},8,["type"])]),_:1},8,["label"]),l(_,{label:t(o)("home.phase")},{default:e(()=>[h.value==="en"?(p(),g(y,{key:0,type:i.value.seasonInfo.phase.en==="Failed to retrieve"?"danger":"success"},{default:e(()=>[d(n(i.value.seasonInfo.phase.en),1)]),_:1},8,["type"])):w("",!0),h.value==="zh"?(p(),g(y,{key:1,type:i.value.seasonInfo.phase.zh==="获取失败"?"danger":"success"},{default:e(()=>[d(n(i.value.seasonInfo.phase.zh),1)]),_:1},8,["type"])):w("",!0)]),_:1},8,["label"]),l(_,{label:t(o)("home.season")},{default:e(()=>[h.value==="en"?(p(),g(y,{key:0,type:i.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[d(n(i.value.seasonInfo.season.en)+" "+n(Z(i.value.seasonInfo.season.en)),1)]),_:1},8,["type"])):w("",!0),h.value==="zh"?(p(),g(y,{key:1,type:i.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[d(n(i.value.seasonInfo.season.zh)+" "+n(Z(i.value.seasonInfo.season.en)),1)]),_:1},8,["type"])):w("",!0)]),_:1},8,["label"]),l(_,{label:t(o)("home.mods")},{default:e(()=>[l(y,null,{default:e(()=>[d(n(i.value.modsCount),1)]),_:1}),l(r,{link:"",style:{"margin-left":"10px"},type:"primary",onClick:ze},{default:e(()=>[d(n(t(o)("home.modsButton")),1)]),_:1})]),_:1},8,["label"]),l(_,{label:t(o)("home.version")},{default:e(()=>[R((p(),g(y,{type:V.value.local===V.value.server?"success":"danger"},{default:e(()=>[d(" ("+n(V.value.local)+"/"+n(V.value.server)+") ",1)]),_:1},8,["type"])),[[ce,q.value]])]),_:1},8,["label"]),l(_,{label:t(o)("home.playerNum")},{default:e(()=>[l(y,{type:"primary"},{default:e(()=>[d(n(i.value.playerNum),1)]),_:1})]),_:1},8,["label"])]),_:1},8,["column"])):w("",!0),i.value.roomSettingBase.name===""?(p(),J("div",Oe,[l(xe,{title:t(o)("home.noServer"),icon:"warning"},null,8,["title"])])):w("",!0)]),_:1})]),_:1}),l(C,{lg:12,md:12,sm:24,span:12,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[b("div",je,n(t(o)("home.sysInfo")),1)]),default:e(()=>[b("div",He,[l(se,{color:ee,percentage:m.value.cpu,type:"dashboard"},{default:e(({percentage:s})=>[b("span",We,n(s.toFixed(1)),1),a[24]||(a[24]=b("span",{class:"percentage-label"},"CPU",-1))]),_:1},8,["percentage"]),l(se,{color:ee,percentage:m.value.memory,style:{"margin-left":"10%"},type:"dashboard"},{default:e(({percentage:s})=>[b("span",Je,n(s.toFixed(1)),1),b("span",Qe,n(t(o)("home.mem")),1)]),_:1},8,["percentage"])])]),_:1})]),_:1})]),_:1}),l(ue,{gutter:10},{default:e(()=>[l(C,{lg:12,md:12,sm:24,span:12,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{style:fe(t(x)?"min-height: 300px":"min-height: 400px"),shadow:"never"},{header:e(()=>[b("div",Xe,n(t(o)("home.control")),1)]),default:e(()=>[b("div",null,[l(N,{inline:"",size:"large"},{default:e(()=>[l(I,{label:u.$t("home.master")},{default:e(()=>[l(de,{modelValue:m.value.master,"onUpdate:modelValue":a[0]||(a[0]=s=>m.value.master=s),"active-text":u.$t("home.running"),"active-value":1,"inactive-text":u.$t("home.terminated"),"inactive-value":0,loading:U.value,"inline-prompt":"",onChange:a[1]||(a[1]=s=>ae("master"))},null,8,["modelValue","active-text","inactive-text","loading"])]),_:1},8,["label"]),l(I,{label:u.$t("home.caves")},{default:e(()=>[l(de,{modelValue:m.value.caves,"onUpdate:modelValue":a[2]||(a[2]=s=>m.value.caves=s),"active-text":u.$t("home.running"),"active-value":1,"inactive-text":u.$t("home.terminated"),"inactive-value":0,loading:P.value,"inline-prompt":"",onChange:a[3]||(a[3]=s=>ae("caves"))},null,8,["modelValue","active-text","inactive-text","loading"])]),_:1},8,["label"])]),_:1}),l(N,{size:"large"},{default:e(()=>[l(I,{label:u.$t("home.rollback")},{default:e(()=>[t(x)?(p(),g(C,{key:0},{default:e(()=>[l(r,{disabled:m.value.master===0,size:"small",onClick:a[4]||(a[4]=s=>f("rollback",1))},{default:e(()=>[d("1"+n(t(o)("home.day")),1)]),_:1},8,["disabled"]),l(r,{disabled:m.value.master===0,size:"small",onClick:a[5]||(a[5]=s=>f("rollback",2))},{default:e(()=>[d(" 2"+n(t(o)("home.days")),1)]),_:1},8,["disabled"]),l(r,{disabled:m.value.master===0,size:"small",onClick:a[6]||(a[6]=s=>f("rollback",3))},{default:e(()=>[d(" 3"+n(t(o)("home.days")),1)]),_:1},8,["disabled"])]),_:1})):w("",!0),t(x)?(p(),g(C,{key:1},{default:e(()=>[l(r,{disabled:m.value.master===0,size:"small",onClick:a[7]||(a[7]=s=>f("rollback",4))},{default:e(()=>[d(" 4"+n(t(o)("home.days")),1)]),_:1},8,["disabled"]),l(r,{disabled:m.value.master===0,size:"small",onClick:a[8]||(a[8]=s=>f("rollback",5))},{default:e(()=>[d(" 5"+n(t(o)("home.days")),1)]),_:1},8,["disabled"])]),_:1})):w("",!0),t(x)?(p(),g(C,{key:2})):w("",!0),t(x)?w("",!0):(p(),g(C,{key:3},{default:e(()=>[l(r,{disabled:m.value.master===0,size:"small",onClick:a[9]||(a[9]=s=>f("rollback",1))},{default:e(()=>[d("1"+n(t(o)("home.day")),1)]),_:1},8,["disabled"]),l(r,{disabled:m.value.master===0,size:"small",onClick:a[10]||(a[10]=s=>f("rollback",2))},{default:e(()=>[d(" 2"+n(t(o)("home.days")),1)]),_:1},8,["disabled"]),l(r,{disabled:m.value.master===0,size:"small",onClick:a[11]||(a[11]=s=>f("rollback",3))},{default:e(()=>[d(" 3"+n(t(o)("home.days")),1)]),_:1},8,["disabled"]),l(r,{disabled:m.value.master===0,size:"small",onClick:a[12]||(a[12]=s=>f("rollback",4))},{default:e(()=>[d(" 4"+n(t(o)("home.days")),1)]),_:1},8,["disabled"]),l(r,{disabled:m.value.master===0,size:"small",onClick:a[13]||(a[13]=s=>f("rollback",5))},{default:e(()=>[d(" 5"+n(t(o)("home.days")),1)]),_:1},8,["disabled"])]),_:1}))]),_:1},8,["label"])]),_:1}),l(N,{size:"large"},{default:e(()=>[l(I,null,{default:e(()=>[l(r,{size:"default",type:"success",onClick:a[14]||(a[14]=s=>f("startup",0))},{default:e(()=>[d(n(t(o)("home.startup")),1)]),_:1}),l(r,{size:"default",type:"primary",onClick:a[15]||(a[15]=s=>f("restart",0))},{default:e(()=>[d(n(t(o)("home.restart")),1)]),_:1}),l(r,{size:"default",type:"warning",onClick:a[16]||(a[16]=s=>f("update",0))},{default:e(()=>[d(n(t(o)("home.update")),1)]),_:1})]),_:1}),l(I,null,{default:e(()=>[l(r,{size:"default",type:"warning",onClick:a[17]||(a[17]=s=>f("shutdown",0))},{default:e(()=>[d(n(t(o)("home.shutdown")),1)]),_:1}),l(r,{size:"default",type:"danger",onClick:a[18]||(a[18]=s=>f("reset",0))},{default:e(()=>[d(n(t(o)("home.reset")),1)]),_:1}),l(M,{content:u.$t("home.deleteTips"),effect:"light",placement:"top"},{default:e(()=>[l(r,{color:"#626aef",size:"default",onClick:a[19]||(a[19]=s=>f("delete",0))},{default:e(()=>[d(n(t(o)("home.delete")),1)]),_:1})]),_:1},8,["content"])]),_:1})]),_:1})])]),_:1},8,["style"])]),_:1}),l(C,{lg:12,md:12,sm:24,span:12,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{style:fe(t(x)?"min-height: 300px":"min-height: 400px"),shadow:"never"},{header:e(()=>[b("div",Ye,n(t(o)("home.interface")),1)]),default:e(()=>[b("div",null,[l(N,{"label-position":"top"},{default:e(()=>[l(I,{label:u.$t("home.announcement")},{default:e(()=>[l(re,{modelValue:S.value.message,"onUpdate:modelValue":a[20]||(a[20]=s=>S.value.message=s),onKeyup:ve(te,["enter"])},{append:e(()=>[l(r,{loading:G.value,onClick:te},{default:e(()=>[d(n(t(o)("home.send")),1)]),_:1},8,["loading"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(I,{label:"Console"},{default:e(()=>[l(re,{modelValue:z.value.cmd,"onUpdate:modelValue":a[22]||(a[22]=s=>z.value.cmd=s),onKeyup:ve(oe,["enter"])},{prepend:e(()=>[l(Ie,{modelValue:z.value.world,"onUpdate:modelValue":a[21]||(a[21]=s=>z.value.world=s),style:{width:"115px"}},{default:e(()=>[l(ie,{disabled:m.value.master===0,label:u.$t("home.master"),value:"master"},null,8,["disabled","label"]),l(ie,{disabled:m.value.caves===0,label:u.$t("home.caves"),value:"caves"},null,8,["disabled","label"])]),_:1},8,["modelValue"])]),append:e(()=>[l(r,{loading:O.value,onClick:oe},{default:e(()=>[d(n(t(o)("home.execute")),1)]),_:1},8,["loading"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["style"])]),_:1})]),_:1}),l(Se,{modelValue:j.value,"onUpdate:modelValue":a[23]||(a[23]=s=>j.value=s),"close-on-click-modal":!1,title:t(o)("home.modsTable.title"),width:"80%"},{default:e(()=>[R((p(),g(Ve,{data:ne.value,border:"",height:"70vh",size:"small",style:{width:"100%"},"tooltip-effect":"light"},{default:e(()=>[l(T,{label:t(o)("home.modsTable.name"),prop:"name"},null,8,["label"]),l(T,{label:t(o)("home.modsTable.pics"),prop:"preview_url",width:"120px"},{default:e(s=>[l($e,{src:s.row.preview_url,fit:"fill",style:{width:"100px",height:"100px"}},null,8,["src"])]),_:1},8,["label"]),l(T,{label:t(o)("home.modsTable.size"),prop:"size"},{default:e(s=>[d(n(t(Me)(s.row.size)),1)]),_:1},8,["label"]),l(T,{label:t(o)("home.modsTable.id"),prop:"id"},null,8,["label"]),l(T,{label:t(o)("home.modsTable.tags"),prop:"tags"},{default:e(s=>[(p(!0),J(Fe,null,Ne(s.row.tags,Te=>(p(),g(y,{style:{margin:"0 5px 5px 0"}},{default:e(()=>[d(n(Te.display_name),1)]),_:2},1024))),256))]),_:1},8,["label"])]),_:1},8,["data"])),[[ce,H.value]])]),_:1},8,["modelValue","title"])])}}},al=Be(Ze,[["__scopeId","data-v-99fd1b2a"]]);export{al as default};
