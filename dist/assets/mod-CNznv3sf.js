import{_ as Ie,o as Le,u as Oe,a as $e,g as Ne,c as se,r as u,z as Be,B as o,C as Ae,d as i,e as b,f as t,w as e,j as a,l as A,k as g,i as p,q as qe,p as M,m as c,t as r,F,v as q,s as Ge,n as w,X as je,y as I,A as Ee}from"./index-BEyP-tjE.js";import{s as k}from"./index-KMTKwBBB.js";import{e as ie}from"./index-D6ohO2UQ.js";import Pe from"./modInfo-BCmjJb3V.js";const Re={class:"page-div"},Ke={class:"item-container"},Xe={class:"card-footer",style:{"margin-top":"20px"}},He={class:"card-header"},Je={style:{display:"flex"}},Qe={style:{display:"flex","margin-left":"5px","flex-direction":"column","justify-content":"center"}},We={class:"card-header"},Ye=je({name:"settingsMod"}),Ze=Object.assign(Ye,{setup(et){Le(async()=>{await U()});const{t:d}=Oe(),{isMobile:_}=$e(),Y=Ne(),re=se(()=>Y.isDark),ue=se(()=>Y.language),Z=u("Download"),ce=(n,s)=>{n.paneName==="Add"&&O(),n.paneName==="Setting"&&ee()},h=u([]),G=u(!1),ee=()=>{G.value=!0,v.value=0,j.value="",k.mod.settingFormat.get().then(n=>{h.value=n.data}).finally(()=>{G.value=!1})},v=u(0),j=u(""),te=(n,s)=>{v.value=n,j.value=s,ge()},z=u(!1),D=u({id:"",configOptions:[]}),ge=()=>{z.value=!0,k.mod.configOptions.get({id:v.value}).then(n=>{D.value=n.data}).finally(()=>{z.value=!1})},me=()=>{z.value=!0,k.mod.configChange.post({modFormattedData:h.value}).then(n=>{I(n.message)}).finally(()=>{z.value=!1})},E=u(!1),L=u({total:0,rows:[]}),pe=u(),m=u({page:1,pageSize:30,searchText:"",searchType:"text"}),U=()=>{E.value=!0,ie.modSearch.get(m.value).then(n=>{L.value.rows=n.data.rows,L.value.total=n.data.total,m.value.searchType==="id"&&Be(ue.value==="zh"?"ID搜索不显示评分":"Search by ID will not display the vote data")}).finally(()=>{E.value=!1})},fe=n=>{U()},_e=n=>{U()},le=u([]),P=u(!1),O=()=>{P.value=!0,ie.modInfoDownloaded.get().then(n=>{le.value=n.data}).finally(()=>{P.value=!1})},R=u(!1),he=()=>{R.value=!0,k.mod.sync.post().then(n=>{I(n.message),O()}).finally(()=>{R.value=!1})},V=u(!1),ve=n=>{let s=n.cmd,f=n.row;switch(V.value=!0,s){case"enable":be(f);break;case"delete":ye(f);break;default:V.value=!1,Ee("error")}},be=n=>{const f={isUgc:n.file_url==="",id:n.id};k.mod.enable.post(f).then(x=>{I(x.message)}).finally(()=>{V.value=!1})},ye=n=>{const f={isUgc:n.file_url==="",id:n.id};k.mod.delete.post(f).then(x=>{I(x.message),O()}).finally(()=>{V.value=!1})},K=u(!1),we=()=>{K.value=!0;const s={isUgc:j.value==="",id:v.value};k.mod.disable.post(s).then(f=>{I(f.message),ee()}).finally(()=>{K.value=!1})};return(n,s)=>{const f=o("el-option"),x=o("el-select"),C=o("el-button"),ke=o("el-input"),$=o("el-form-item"),ae=o("el-form"),X=o("el-scrollbar"),xe=o("el-pagination"),N=o("el-card"),H=o("el-tab-pane"),ne=o("el-tooltip"),Ce=o("el-alert"),T=o("el-table-column"),S=o("el-tag"),Se=o("arrow-down"),Me=o("el-icon"),oe=o("el-dropdown-item"),ze=o("el-dropdown-menu"),De=o("el-dropdown"),Ue=o("el-table"),J=o("el-col"),de=o("el-row"),Ve=o("el-image"),Te=o("el-divider"),Q=o("el-result"),Fe=o("el-tabs"),B=Ae("loading");return i(),b("div",Re,[t(Fe,{modelValue:Z.value,"onUpdate:modelValue":s[6]||(s[6]=l=>Z.value=l),onTabClick:ce},{default:e(()=>[t(H,{label:a(d)("setting.mod.tab.download"),name:"Download"},{default:e(()=>[A((i(),g(N,{style:{height:"78vh"},shadow:"never"},{default:e(()=>[p("div",null,[t(ae,{ref_key:"modSearchFormRef",ref:pe,model:m.value,inline:!0,onKeyup:qe(U,["enter"])},{default:e(()=>[t($,null,{default:e(()=>[t(ke,{modelValue:m.value.searchText,"onUpdate:modelValue":s[1]||(s[1]=l=>m.value.searchText=l),style:M(a(_)?"width: 75vw;":"width: 50vw;")},{prepend:e(()=>[t(x,{modelValue:m.value.searchType,"onUpdate:modelValue":s[0]||(s[0]=l=>m.value.searchType=l),style:{width:"85px"}},{default:e(()=>[t(f,{label:n.$t("setting.mod.download.searchTypeText"),value:"text"},null,8,["label"]),t(f,{label:n.$t("setting.mod.download.searchTypeId"),value:"id"},null,8,["label"])]),_:1},8,["modelValue"])]),append:e(()=>[t(C,{type:"primary",onClick:U},{default:e(()=>[c(r(a(d)("setting.mod.download.search")),1)]),_:1})]),_:1},8,["modelValue","style"])]),_:1})]),_:1},8,["model"])]),p("div",null,[t(X,{"max-height":"60vh"},{default:e(()=>[p("div",Ke,[(i(!0),b(F,null,q(L.value.rows,l=>(i(),g(Pe,{mod:l},null,8,["mod"]))),256))])]),_:1})]),p("div",Xe,[t(xe,{"current-page":m.value.page,"onUpdate:currentPage":s[2]||(s[2]=l=>m.value.page=l),"page-size":m.value.pageSize,"onUpdate:pageSize":s[3]||(s[3]=l=>m.value.pageSize=l),"page-sizes":[10,20,30,40,50,100],layout:"total, sizes, prev, pager, next",total:L.value.total,onSizeChange:s[4]||(s[4]=l=>fe(m.value.pageSize)),onCurrentChange:s[5]||(s[5]=l=>_e(m.value.page))},null,8,["current-page","page-size","total"])])]),_:1})),[[B,E.value]])]),_:1},8,["label"]),t(H,{label:a(d)("setting.mod.tab.add"),name:"Add"},{default:e(()=>[t(de,{gutter:10},{default:e(()=>[t(J,{span:24},{default:e(()=>[A((i(),g(N,{style:{height:"70vh"},shadow:"never"},{header:e(()=>[p("div",He,[p("span",null,r(a(d)("setting.mod.add.header.title")),1),p("div",null,[t(C,{onClick:O},{default:e(()=>[c(r(a(d)("setting.mod.add.header.refresh")),1)]),_:1}),t(ne,{effect:"light","show-after":500,content:a(d)("setting.mod.add.header.syncTooltip"),placement:"top"},{default:e(()=>[t(C,{type:"primary",loading:R.value,onClick:he},{default:e(()=>[c(r(a(d)("setting.mod.add.header.sync")),1)]),_:1},8,["loading"])]),_:1},8,["content"])])])]),default:e(()=>[t(Ce,{closable:!1,effect:re.value?"light":"dark",type:"warning"},{default:e(()=>[c(r(a(d)("setting.mod.add.alert")),1)]),_:1},8,["effect"]),t(Ue,{data:le.value,border:"",style:{height:"55vh","margin-top":"10px"}},{default:e(()=>[t(T,{label:a(d)("setting.mod.add.table.name"),prop:"name"},null,8,["label"]),t(T,{label:"ID",prop:"id"}),t(T,{label:"UGC"},{default:e(l=>[l.row.file_url===""?(i(),g(S,{key:0,type:"primary"},{default:e(()=>[c(r(a(d)("setting.mod.add.table.ugc.yes")),1)]),_:1})):(i(),g(S,{key:1,type:"info"},{default:e(()=>[c(r(a(d)("setting.mod.add.table.ugc.no")),1)]),_:1}))]),_:1}),t(T,{label:a(d)("setting.mod.add.table.size")},{default:e(l=>[c(r(a(Ge)(l.row.size)),1)]),_:1},8,["label"]),t(T,{label:a(d)("setting.mod.add.table.action")},{default:e(l=>[t(De,{onCommand:ve,trigger:"click"},{dropdown:e(()=>[t(ze,null,{default:e(()=>[t(oe,{command:{cmd:"enable",row:l.row}},{default:e(()=>[c(r(a(d)("setting.mod.add.table.enable")),1)]),_:2},1032,["command"]),t(oe,{command:{cmd:"delete",row:l.row}},{default:e(()=>[c(r(a(d)("setting.mod.add.table.delete")),1)]),_:2},1032,["command"])]),_:2},1024)]),default:e(()=>[t(C,{type:"primary",link:"",loading:V.value},{default:e(()=>[c(r(a(d)("setting.mod.add.table.action")),1),t(Me,{class:"el-icon--right"},{default:e(()=>[t(Se)]),_:1})]),_:1},8,["loading"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})),[[B,P.value]])]),_:1})]),_:1})]),_:1},8,["label"]),t(H,{label:a(d)("setting.mod.tab.setting"),name:"Setting"},{default:e(()=>[t(de,{gutter:10},{default:e(()=>[t(J,{lg:8,md:8,sm:24,span:8,xs:24},{default:e(()=>[A((i(),g(N,{style:M(a(_)?"height: 50vh":"height: 70vh"),shadow:"never"},{default:e(()=>[t(X,{"max-height":a(_)?"45vh":"65vh"},{default:e(()=>[h.value?(i(!0),b(F,{key:0},q(h.value,(l,y)=>(i(),b(F,null,[p("div",Je,[p("div",null,[t(Ve,{src:l.preview_url,fit:"fill",onClick:W=>te(l.id,l.file_url),style:{width:"75px",height:"75px"}},null,8,["src","onClick"])]),p("div",Qe,[t(C,{link:"",type:"primary",onClick:W=>te(l.id,l.file_url)},{default:e(()=>[c(r(l.name),1)]),_:2},1032,["onClick"]),p("div",null,[l.enable?(i(),g(S,{key:0,type:"success"},{default:e(()=>[c(r(a(d)("setting.mod.setting.left.enable")),1)]),_:1})):w("",!0),l.enable?w("",!0):(i(),g(S,{key:1,type:"info"},{default:e(()=>[c(r(a(d)("setting.mod.setting.left.disable")),1)]),_:1}))])])]),y!==h.value.length-1?(i(),g(Te,{key:0})):w("",!0)],64))),256)):(i(),b("div",{key:1,class:"fcc",style:M(a(_)?"height: 50vh":"height: 70vh")},[t(Q,{icon:"warning",title:a(d)("setting.mod.setting.left.result")},null,8,["title"])],4))]),_:1},8,["max-height"])]),_:1},8,["style"])),[[B,G.value]])]),_:1}),t(J,{lg:16,md:16,sm:24,span:16,xs:24},{default:e(()=>[A((i(),g(N,{style:M(a(_)?"height: 50vh; margin-top: 10px":"height: 70vh"),shadow:"never"},{header:e(()=>[p("div",We,[p("span",null,r(a(d)("setting.mod.setting.right.header.title")),1),t(C,{type:"danger",disabled:v.value===0,loading:K.value,onClick:we},{default:e(()=>[c(r(a(d)("setting.mod.setting.right.header.disable")),1)]),_:1},8,["disabled","loading"])])]),default:e(()=>[v.value!==0?(i(),g(X,{key:0,"max-height":a(_)?"45vh":"65vh"},{default:e(()=>[D.value.configOptions.length!==0?(i(),g(ae,{key:0,ref:"modSettingFormRef",size:a(_)?"small":"large","label-position":a(_)?"top":"left","label-width":a(_)?"70":"auto"},{default:e(()=>[t($,{label:"ID"},{default:e(()=>[t(S,null,{default:e(()=>[c(r(D.value.id),1)]),_:1})]),_:1}),t($,{label:a(d)("setting.mod.setting.right.name")},{default:e(()=>[t(S,{type:"info"},{default:e(()=>[c(r(h.value[h.value.findIndex(l=>l.id===v.value)].name),1)]),_:1})]),_:1},8,["label"]),(i(!0),b(F,null,q(D.value.configOptions,l=>(i(),g(ne,{"show-after":500,effect:"light",content:l.hover,placement:"top"},{default:e(()=>[t($,{label:l.label},{default:e(()=>[t(x,{modelValue:h.value[h.value.findIndex(y=>y.id===v.value)].configurationOptions[l.name],"onUpdate:modelValue":y=>h.value[h.value.findIndex(W=>W.id===v.value)].configurationOptions[l.name]=y,onChange:me},{default:e(()=>[(i(!0),b(F,null,q(l.options,y=>(i(),g(f,{label:y.description,value:y.data},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1032,["content"]))),256))]),_:1},8,["size","label-position","label-width"])):w("",!0),D.value.configOptions.length===0?(i(),b("div",{key:1,class:"fcc",style:M(a(_)?"height: 40vh; margin-top: 10px":"height: 60vh")},[t(Q,{icon:"info",title:a(d)("setting.mod.setting.right.result")},null,8,["title"])],4)):w("",!0)]),_:1},8,["max-height"])):w("",!0),v.value===0?(i(),b("div",{key:1,class:"fcc",style:M(a(_)?"height: 40vh; margin-top: 10px":"height: 60vh")},[t(Q,{icon:"info",title:a(d)("setting.mod.setting.right.result2")},null,8,["title"])],4)):w("",!0)]),_:1},8,["style"])),[[B,z.value]])]),_:1})]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])])}}}),ot=Ie(Ze,[["__scopeId","data-v-2372d818"]]);export{ot as default};
