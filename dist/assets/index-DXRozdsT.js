import{o as W,u as q,g as L,D as z,G as E,b as G,H,r as c,c as J,a1 as S,w as M,I as K,J as b,K as O,e as i,f as g,l as j,t as s,i as o,n as B,m as y,k as e,j as a,p as d,q as $,a0 as F}from"./index-BBdhuqe3.js";const Q={class:"page-div"},U={class:"tip_warning"},X={class:"tip_success",style:{"margin-top":"20px"}},Y={key:0,class:"tip_error",style:{"margin-top":"20px"}},Z={key:0},ee=F({name:"Clusters"}),le=Object.assign(ee,{setup(te){W(()=>{V(),R()});const{t:l}=q(),I=L(),_=z();E();const w=G(),h=H("refresh"),f=c(!1),m=c(!1),N=J(()=>f.value||m.value),P=c([]),V=()=>{f.value=!0,S.clusters.get().then(u=>{P.value=u.data}).finally(()=>{f.value=!1})},v=c([]),k=c(0),C=c(0),R=()=>{m.value=!0,S.clustersWorldPort.get().then(u=>{v.value=u.data;let p=[];for(let r of v.value)if(r.worldPort!==null)for(let n of r.worldPort)p.push(n);k.value=p.length,C.value=new Set(p).size}).finally(()=>{m.value=!1})},T=()=>{setTimeout(()=>{_.meta.isKeepAlive&&w.removeKeepAliveName(_.name),h(!1),K(()=>{_.meta.isKeepAlive&&w.addKeepAliveName(_.name),h(!0)})},0)};return M(()=>I.selectedDstCluster,u=>{u&&K(()=>{T()})},{immediate:!1}),(u,p)=>{const r=b("el-tag"),n=b("el-table-column"),x=b("el-table"),D=O("loading");return i(),g("div",Q,[j("div",U,s(o(l)("clusters.tip1")),1),B((i(),y(x,{data:P.value,border:""},{default:e(()=>[a(n,{label:o(l)("clusters.table.name")},{default:e(t=>[a(r,{type:"primary"},{default:e(()=>[d(s(t.row.clusterName),1)]),_:2},1024)]),_:1},8,["label"]),a(n,{label:o(l)("clusters.table.displayName")},{default:e(t=>[a(r,{type:"success"},{default:e(()=>[d(s(t.row.clusterDisplayName),1)]),_:2},1024)]),_:1},8,["label"]),a(n,{label:o(l)("clusters.table.world")},{default:e(t=>[a(r,{type:"info"},{default:e(()=>{var A;return[d(s(((A=t.row.worlds)==null?void 0:A.length)||0),1)]}),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[D,N.value]]),j("div",X,s(o(l)("clusters.tip2")),1),C.value!==k.value?(i(),g("div",Y,s(o(l)("clusters.tip3")),1)):$("",!0),B((i(),y(x,{data:v.value,border:""},{default:e(()=>[a(n,{label:o(l)("clusters.table.name")},{default:e(t=>[a(r,{type:"primary"},{default:e(()=>[d(s(t.row.clusterName),1)]),_:2},1024)]),_:1},8,["label"]),a(n,{label:o(l)("clusters.table.displayName")},{default:e(t=>[a(r,{type:"success"},{default:e(()=>[d(s(t.row.clusterDisplayName),1)]),_:2},1024)]),_:1},8,["label"]),a(n,{label:o(l)("clusters.table.port")},{default:e(t=>[t.row.worldPort?(i(),g("span",Z,s(t.row.worldPort.join(", ")),1)):(i(),y(r,{key:1,type:"info"},{default:e(()=>[d(s(o(l)("clusters.table.none")),1)]),_:1}))]),_:1},8,["label"])]),_:1},8,["data"])),[[D,N.value]])])}}});export{le as default};
