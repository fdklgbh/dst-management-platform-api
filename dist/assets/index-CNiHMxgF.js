import{o as ne,g as ue,c as re,a4 as de,u as ie,r as V,Q as C,J as u,e as p,f as I,j as e,k as l,l as c,t as d,i as o,p as _,m as b,q as k,F as me,v as ce,a0 as pe,ah as j,W as B,A as E,E as _e,B as fe}from"./index-EHyLukih.js";import{S as ve}from"./index-D27vnnvf.js";const be={class:"page-div"},ge={class:"card-header"},we={class:"tip"},ye={style:{"margin-top":"5px"}},he={style:{"margin-top":"5px"}},Ve={class:"tip"},ke={class:"el-form-item-msg"},xe={style:{display:"flex","justify-content":"flex-end","padding-top":"10px"}},Ue=pe({name:"Users"}),Fe=Object.assign(Ue,{setup(Ce){ne(()=>{x()});const N=ue(),m=re(()=>N.language),A=de(),{t:s}=ie(),D=A.userInfo,q=V([]),x=()=>{C.userList.get().then(r=>{q.value=r.data})},O=r=>{if(r.type==="update"){H(j(r.data));return}r.type==="delete"&&Q(j(r.data))},f=V(),a=V({username:"",nickname:"",password:"",disabled:!1,role:"Non-admin",clusterPermission:null}),R={username:[{required:!0,message:s("users.formValidateMsg.username")}],nickname:[{required:!0,message:s("users.formValidateMsg.nickname")}],password:[{required:!0,message:s("users.formValidateMsg.password")}],disabled:[{required:!0,message:s("users.formValidateMsg.disabled")}]},g=V(!1),w=V(!1),y=V(!1),$=()=>{f.value&&f.value.clearValidate(),y.value=!0,g.value=!0},G=()=>{f.value.validate(r=>{if(r){w.value=!0;const n={username:a.value.username,nickname:a.value.nickname,password:B(a.value.password),disabled:a.value.disabled,role:a.value.role,clusterPermission:a.value.clusterPermission};C.user.post(n).then(i=>{g.value=!1,E(i.message),x()}).finally(()=>{w.value=!1})}})},H=r=>{a.value=r,y.value=!1,g.value=!0},J=()=>{f.value.validate(r=>{if(r){w.value=!0;const n={username:a.value.username,nickname:a.value.nickname,password:B("nicai"),disabled:a.value.disabled,role:a.value.role,clusterPermission:a.value.clusterPermission};C.user.put(n).then(i=>{g.value=!1,f.value&&f.value.resetFields(),E(i.message),x()}).finally(()=>{w.value=!1})}})},Q=r=>{_e.confirm(m.value==="zh"?"将执行 删除 操作，是否继续？":"The DELETE operation will be performed. Do you want to continue?",m.value==="zh"?"请确认您的操作":"Please confirm your operation",{confirmButtonText:m.value==="zh"?"确定":"confirm",cancelButtonText:m.value==="zh"?"取消":"cancel",type:"warning",beforeClose:(n,i,U)=>{if(n==="confirm"){i.confirmButtonLoading=!0;const P={username:r.username,nickname:r.nickname,password:B("nicai"),disabled:r.disabled};C.user.delete(P).then(v=>{E(v.message),x(),U()}).finally(()=>{i.confirmButtonLoading=!1})}else U()}}).then(()=>{}).catch(()=>{fe(s("home.canceled"))})},W=()=>{a.value={username:"",nickname:"",password:"",disabled:!1,role:"Non-admin",clusterPermission:null}};return(r,n)=>{const i=u("el-button"),U=u("el-collapse-item"),P=u("el-collapse"),v=u("el-table-column"),F=u("el-tag"),K=u("arrow-down"),X=u("el-icon"),L=u("el-dropdown-item"),Y=u("el-dropdown-menu"),Z=u("el-dropdown"),ee=u("el-table"),le=u("el-card"),S=u("el-col"),M=u("el-row"),z=u("el-input"),h=u("el-form-item"),ae=u("el-option"),se=u("el-select"),T=u("el-switch"),te=u("el-form"),oe=u("el-dialog");return p(),I("div",be,[e(M,{gutter:10},{default:l(()=>[e(S,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:l(()=>[e(le,{shadow:"never",style:{"min-height":"70vh"}},{header:l(()=>[c("div",ge,[c("span",null,d(o(s)("users.accountTitle")),1),e(i,{disabled:o(D).role!=="admin",type:"success",onClick:$},{default:l(()=>[_(d(o(s)("users.actions.create")),1)]),_:1},8,["disabled"])])]),default:l(()=>[e(P,null,{default:l(()=>[e(U,{title:"Tips"},{default:l(()=>[c("div",we,[c("div",null,d(o(s)("users.tip_1")),1),c("div",ye,d(o(s)("users.tip_2")),1),c("div",he,d(o(s)("users.tip_3")),1)]),c("div",Ve,[c("div",null,d(o(s)("users.tip_4")),1)])]),_:1})]),_:1}),e(ee,{data:q.value,border:"",style:{"margin-top":"10px"}},{default:l(()=>[e(v,{label:o(s)("users.username"),prop:"username"},null,8,["label"]),e(v,{label:o(s)("users.nickname"),prop:"nickname"},null,8,["label"]),e(v,{label:o(s)("users.role"),prop:"role"},{default:l(t=>[e(F,{type:t.row.role==="admin"?"primary":"info"},{default:l(()=>[_(d(t.row.role),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(v,{label:o(s)("users.disabled")},{default:l(t=>[t.row.disabled?k("",!0):(p(),b(F,{key:0,type:"success"},{default:l(()=>[_(d(m.value==="zh"?"启用":"Enabled"),1)]),_:1})),t.row.disabled?(p(),b(F,{key:1,type:"danger"},{default:l(()=>[_(d(m.value==="zh"?"禁用":"Disabled"),1)]),_:1})):k("",!0)]),_:1},8,["label"]),e(v,{label:o(s)("setting.button.actions"),prop:"actions"},{default:l(t=>[e(Z,{disabled:o(D).role!=="admin",trigger:"hover",onCommand:O},{dropdown:l(()=>[e(Y,null,{default:l(()=>[e(L,{command:{type:"update",data:t.row}},{default:l(()=>[_(d(o(s)("users.actions.update")),1)]),_:2},1032,["command"]),e(L,{command:{type:"delete",data:t.row},disabled:t.row.role==="admin"},{default:l(()=>[_(d(o(s)("users.actions.delete")),1)]),_:2},1032,["command","disabled"])]),_:2},1024)]),default:l(()=>[e(i,{disabled:o(D).role!=="admin",link:"",type:"primary"},{default:l(()=>[_(d(o(s)("setting.button.actions"))+" ",1),e(X,{class:"el-icon--right"},{default:l(()=>[e(K)]),_:1})]),_:1},8,["disabled"])]),_:2},1032,["disabled"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})]),_:1})]),_:1}),e(oe,{modelValue:g.value,"onUpdate:modelValue":n[7]||(n[7]=t=>g.value=t),width:"60%",onClosed:W},{default:l(()=>[e(te,{ref_key:"userDialogFormRef",ref:f,model:a.value,rules:R,"validate-on-rule-change":!1,"label-width":"100",style:{"margin-top":"20px"}},{default:l(()=>[y.value?(p(),b(h,{key:0,label:o(s)("users.username"),prop:"username"},{default:l(()=>[e(z,{modelValue:a.value.username,"onUpdate:modelValue":n[0]||(n[0]=t=>a.value.username=t)},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0),e(h,{label:o(s)("users.nickname"),prop:"nickname"},{default:l(()=>[e(z,{modelValue:a.value.nickname,"onUpdate:modelValue":n[1]||(n[1]=t=>a.value.nickname=t)},null,8,["modelValue"])]),_:1},8,["label"]),y.value?(p(),b(h,{key:1,label:o(s)("users.password"),prop:"password"},{default:l(()=>[e(z,{modelValue:a.value.password,"onUpdate:modelValue":n[2]||(n[2]=t=>a.value.password=t),autocomplete:"new-password","show-password":""},null,8,["modelValue"]),e(ve,{modelValue:a.value.password,"onUpdate:modelValue":n[3]||(n[3]=t=>a.value.password=t)},null,8,["modelValue"]),c("div",ke,d(o(s)("users.suggestedPassword")),1)]),_:1},8,["label"])):k("",!0),e(h,{label:o(s)("users.clusterPermission"),prop:"clusterPermission"},{default:l(()=>[e(se,{modelValue:a.value.clusterPermission,"onUpdate:modelValue":n[4]||(n[4]=t=>a.value.clusterPermission=t),multiple:"","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":3,disabled:a.value.role==="admin"},{default:l(()=>[(p(!0),I(me,null,ce(o(N).dstClusters,t=>(p(),b(ae,{label:t.clusterDisplayName,value:t.clusterName},null,8,["label","value"]))),256))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"]),e(M,null,{default:l(()=>[e(S,{span:12},{default:l(()=>[e(h,{label:o(s)("users.disabled"),prop:"disabled"},{default:l(()=>[e(T,{modelValue:a.value.disabled,"onUpdate:modelValue":n[5]||(n[5]=t=>a.value.disabled=t),"active-text":m.value==="zh"?"启用":"Enable","active-value":!1,"inactive-text":m.value==="zh"?"禁用":"Disable","inactive-value":!0,"inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1}),e(S,{span:12},{default:l(()=>[e(h,{label:o(s)("users.admin"),prop:"role"},{default:l(()=>[e(T,{modelValue:a.value.role,"onUpdate:modelValue":n[6]||(n[6]=t=>a.value.role=t),"active-text":m.value==="zh"?"是":"Enable","inactive-text":m.value==="zh"?"否":"Disable","active-value":"admin","inactive-value":"Non-admin","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1})]),_:1}),c("div",xe,[y.value?(p(),b(i,{key:0,loading:w.value,type:"primary",onClick:G},{default:l(()=>[_(d(o(s)("users.submit")),1)]),_:1},8,["loading"])):k("",!0),y.value?k("",!0):(p(),b(i,{key:1,loading:w.value,type:"primary",onClick:J},{default:l(()=>[_(d(o(s)("users.submit")),1)]),_:1},8,["loading"]))])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{Fe as default};
