import{u as R,g as F,c as V,a as L,r as b,o as X,b as H,B as n,d,e as x,f as t,w as e,p as C,j as i,i as u,t as s,m as o,k as $,n as S,X as J,$ as I,ag as K,y as Q}from"./index-D-wNonYu.js";const W={class:"page-div"},Y={class:"card-header"},Z={class:"card-header"},ee={style:{"margin-top":"5px"}},te={class:"card-header"},le={style:{"margin-top":"10px"}},se={key:0},ae={key:1},oe=J({name:"toolsInstall"}),re=Object.assign(oe,{setup(ne){const{t:r}=R(),z=F(),y=V(()=>z.language),{isMobile:k}=L(),D=V(()=>z.isDark),_=b(!1),p=b(0),m=b({zh:"",en:""}),a=b({}),M=()=>{I.osInfo.get().then(l=>{a.value=l.data,a.value.Uptime=K(l.data.Uptime,y.value)})},B=()=>{I.install.post().then(l=>{Q(l.message),_.value=!0,O()})},T=()=>{I.installStatus.get().then(l=>{const h=l.data;p.value=h.process,m.value.zh=h.zh,m.value.en=h.en,(p.value===100||p.value===0)&&g()})};let f=null;const O=()=>{f=setInterval(()=>{T()},1e3)},g=()=>{f&&(clearInterval(f),f=null)};return X(()=>{M()}),H(()=>{g(),window.removeEventListener("beforeunload",g)}),(l,h)=>{const c=n("el-descriptions-item"),j=n("el-descriptions"),w=n("el-card"),v=n("el-col"),N=n("el-button"),U=n("el-result"),q=n("el-text"),P=n("el-row"),A=n("el-alert"),E=n("el-tag"),G=n("el-progress");return d(),x("div",W,[t(P,{gutter:20},{default:e(()=>[t(v,{span:12,lg:12,md:12,sm:24,xs:24},{default:e(()=>[t(w,{shadow:"never",style:C(i(k)?"min-height: 300px":"min-height: 500px")},{header:e(()=>[u("span",Y,s(i(r)("tools.install.systemInfo")),1)]),default:e(()=>[t(j,{border:"",column:1},{default:e(()=>[t(c,{label:l.$t("tools.install.architecture")},{default:e(()=>[o(s(a.value.Architecture),1)]),_:1},8,["label"]),t(c,{label:l.$t("tools.install.osType")},{default:e(()=>[o(s(a.value.OS),1)]),_:1},8,["label"]),t(c,{label:l.$t("tools.install.osName")},{default:e(()=>[o(s(a.value.Platform),1)]),_:1},8,["label"]),t(c,{label:l.$t("tools.install.osVersion")},{default:e(()=>[o(s(a.value.PlatformVersion),1)]),_:1},8,["label"]),t(c,{label:"CPU"},{default:e(()=>[o(s(a.value.CPUModel),1)]),_:1}),t(c,{label:i(r)("tools.install.cpuCore")},{default:e(()=>[o(s(a.value.CPUCores),1)]),_:1},8,["label"]),t(c,{label:l.$t("tools.install.memory")},{default:e(()=>[o(s((a.value.MemorySize/1024**3).toFixed(2))+" GB",1)]),_:1},8,["label"]),t(c,{label:l.$t("tools.install.uptime")},{default:e(()=>[o(s(a.value.Uptime),1)]),_:1},8,["label"])]),_:1})]),_:1},8,["style"])]),_:1}),t(v,{span:12,lg:12,md:12,sm:24,xs:24,style:C(i(k)?"margin-top: 20px":"margin-top: 0px")},{default:e(()=>[t(w,{shadow:"never",style:C(i(k)?"min-height: 300px":"min-height: 500px")},{header:e(()=>[u("span",Z,s(l.$t("tools.install.installCheck")),1)]),default:e(()=>[a.value.Platform==="ubuntu"||a.value.Platform==="centos"||a.value.Platform==="rocky"?(d(),$(U,{key:0,icon:"success",title:l.$t("tools.install.checkPass"),"sub-title":l.$t("tools.install.checkPassDesc")},{extra:e(()=>[t(N,{type:"primary",loading:_.value,onClick:B},{default:e(()=>[o(s(i(r)("tools.install.install")),1)]),_:1},8,["loading"])]),_:1},8,["title","sub-title"])):(d(),$(U,{key:1,icon:"warning",title:l.$t("tools.install.checkNotPass"),"sub-title":l.$t("tools.install.checkNotPassDesc")},{extra:e(()=>[u("div",null,[t(N,{type:"warning",loading:_.value,disabled:a.value.Platform==="darwin",onClick:B},{default:e(()=>[o(s(i(r)("tools.install.install")),1)]),_:1},8,["loading","disabled"])]),u("div",ee,[t(q,{type:"info"},{default:e(()=>[o(s(i(r)("tools.install.macosTip")),1)]),_:1})])]),_:1},8,["title","sub-title"]))]),_:1},8,["style"])]),_:1},8,["style"])]),_:1}),t(P,{gutter:20},{default:e(()=>[t(v,{span:24,lg:24,md:24,sm:24,xs:24,style:{"margin-top":"20px"}},{default:e(()=>[t(A,{effect:D.value?"light":"dark",type:"success",closable:!1},{default:e(()=>[o(s(i(r)("tools.install.installTip")),1)]),_:1},8,["effect"])]),_:1})]),_:1}),_.value?(d(),$(P,{key:0,gutter:20},{default:e(()=>[t(v,{span:24,lg:24,md:24,sm:24,xs:24,style:{"margin-top":"20px"}},{default:e(()=>[t(w,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[u("div",te,[u("span",null,s(i(r)("tools.install.installProgress")),1),t(E,{type:"warning",style:{"font-weight":"lighter"}},{default:e(()=>[o(s(i(r)("tools.install.noClose")),1)]),_:1})])]),default:e(()=>[t(G,{percentage:p.value,status:p.value===100?"success":"","stroke-width":15,striped:"","striped-flow":""},null,8,["percentage","status"]),u("div",le,[y.value==="zh"?(d(),x("span",se,s(m.value.zh),1)):S("",!0),y.value==="en"?(d(),x("span",ae,s(m.value.en),1)):S("",!0)])]),_:1})]),_:1})]),_:1})):S("",!0)])}}});export{re as default};
