import{s as h}from"./index-BKIM-Nyb.js";import{u as we,a as $e,g as Le,c as ae,o as Ce,y as b,r as m,B as c,C as De,d as u,e as v,f as t,w as e,p as F,j as s,i as p,m as d,t as o,k as f,F as j,v as q,a8 as xe,l as ne,a7 as ze,X as Be,A as Fe}from"./index-iCREqSRD.js";const Ae={class:"page-div"},Pe={class:"card-header"},Ve={key:0},Ne={key:1},Se={class:"card-header"},Te={key:0},Ue={style:{"margin-top":"20px"}},We={class:"card-header"},Ie={key:0},Me={style:{"margin-top":"20px"}},Re={class:"card-header"},Ee={key:0},je={style:{"margin-top":"20px"}},qe={class:"card-header"},Ge={class:"fcc"},He={class:"el-upload__text"},Ke={class:"el-upload__tip"},Oe=Be({name:"settingsPlayer"}),Ye=Object.assign(Oe,{setup(Qe){const{t:i}=we(),{isMobile:$}=$e(),G=Le(),L=ae(()=>G.isDark),A=ae(()=>G.language);Ce(()=>{g()});const g=(l=!1)=>{h.player.list.get().then(n=>{T.value=n.data.players,U.value=n.data.uidMap,C.value=[];for(let r of n.data.adminList)r!==""&&C.value.push(r);D.value=[];for(let r of n.data.blockList)r!==""&&D.value.push(r);x.value=[];for(let r of n.data.whiteList)r!==""&&x.value.push(r);if(l){let r;A.value==="zh"?r="刷新成功":r="Refresh Success",b(r)}})},H=m("players"),T=m([]),U=m({}),C=m([]),D=m([]),x=m([]),P=l=>{for(let n of C.value)if(n===l)return!0},K=l=>{for(let n of D.value)if(n===l)return!0},O=l=>{for(let n of x.value)if(n===l)return!0},Q=l=>{switch(l.type){case"admin":se(l.uid);break;case"block":ie(l.uid);break;case"white":re(l.uid);break;case"kick":ce(l.uid);break}},se=l=>{h.player.addAdmin.post({uid:l}).then(n=>{b(n.message),g()})},oe=l=>{h.player.deleteAdmin.post({uid:l}).then(n=>{b(n.message),g()})},ie=l=>{h.player.addBlock.post({uid:l}).then(n=>{b(n.message),g()})},de=l=>{h.player.deleteBlock.post({uid:l}).then(n=>{b(n.message),g()})},re=l=>{h.player.addWhite.post({uid:l}).then(n=>{b(n.message),g()})},ue=l=>{h.player.deleteWhite.post({uid:l}).then(n=>{b(n.message),g()})},ce=l=>{h.player.kick.post({uid:l}).then(n=>{b(n.message)})},W=l=>l in U.value?" ["+U.value[l]+"]":A.value==="zh"?" [暂未获取到]":" [Not yet obtained]",pe=(l,n)=>{l.paneName==="history"&&X()},I=m([]),M=m(!1),X=(l=!1)=>{M.value=!0,I.value=[],h.player.history.get().then(n=>{for(let r of n.data)r.uid.length===11&&I.value.push(r);if(l){let r;A.value==="zh"?r="刷新成功":r="Refresh Success",b(r)}}).finally(()=>{M.value=!1})},R=m(),V=m(!1),w=m(!1),fe=()=>{R.value&&R.value.clearFiles(),V.value=!0,w.value=!1},ge=l=>/\.xls|xlsx$/i.test(l.name)?!0:(Fe(A.value==="zh"?"请上传Excel文件":"Please upload a Excel file"),!1),me=l=>{w.value=!0;const n=new FormData;n.append("file",l.file),h.player.addBlockUpload.post(n).then(r=>{g(),b(r.message)}).finally(()=>{V.value=!1,w.value=!1})};return(l,n)=>{const r=c("el-button"),_=c("el-table-column"),y=c("el-tag"),J=c("arrow-down"),N=c("el-icon"),k=c("el-dropdown-item"),Y=c("el-dropdown-menu"),Z=c("el-dropdown"),ee=c("el-table"),S=c("el-result"),z=c("el-card"),B=c("el-tab-pane"),E=c("el-alert"),_e=c("el-tooltip"),he=c("el-tabs"),be=c("el-col"),ye=c("el-row"),ve=c("el-upload"),ke=c("el-dialog"),te=De("loading");return u(),v("div",Ae,[t(ye,{gutter:10},{default:e(()=>[t(be,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[t(he,{modelValue:H.value,"onUpdate:modelValue":n[5]||(n[5]=a=>H.value=a),onTabClick:pe},{default:e(()=>[t(B,{label:l.$t("setting.players"),name:"players"},{default:e(()=>[t(z,{style:F(s($)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:e(()=>[p("div",Pe,[d(o(s(i)("setting.players"))+" ",1),p("div",null,[t(r,{size:"default",onClick:n[0]||(n[0]=a=>g(!0))},{default:e(()=>[d(o(s(i)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[T.value?(u(),f(ee,{key:0,data:T.value,border:"",size:"small",style:{width:"100%"}},{default:e(()=>[t(_,{label:l.$t("setting.nickName"),prop:"nickName"},null,8,["label"]),t(_,{label:l.$t("setting.role"),prop:"prefab"},{default:e(a=>[a.row.prefab===""?(u(),v("span",Ve,o(s(i)("setting.roleFail")),1)):(u(),v("span",Ne,o(a.row.prefab),1))]),_:1},8,["label"]),t(_,{label:l.$t("setting.age"),prop:"age"},{default:e(a=>[a.row.age?(u(),f(y,{key:0,type:"success"},{default:e(()=>[d(o(a.row.age),1)]),_:2},1024)):(u(),f(y,{key:1,type:"warning"},{default:e(()=>[d(o(s(i)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),t(_,{label:"UID",prop:"uid"}),t(_,{label:l.$t("setting.button.actions"),prop:"actions"},{default:e(a=>[t(Z,{trigger:"hover",onCommand:Q},{dropdown:e(()=>[t(Y,null,{default:e(()=>[t(k,{command:{type:"admin",uid:a.row.uid},disabled:P(a.row.uid)},{default:e(()=>[d(o(s(i)("setting.addAdmin")),1)]),_:2},1032,["command","disabled"]),t(k,{command:{type:"block",uid:a.row.uid},disabled:K(a.row.uid)},{default:e(()=>[d(o(s(i)("setting.addBlock")),1)]),_:2},1032,["command","disabled"]),t(k,{command:{type:"white",uid:a.row.uid},disabled:O(a.row.uid)},{default:e(()=>[d(o(s(i)("setting.addWhite")),1)]),_:2},1032,["command","disabled"]),t(k,{command:{type:"kick",uid:a.row.uid},disabled:P(a.row.uid),divided:""},{default:e(()=>[d(o(s(i)("setting.kick")),1)]),_:2},1032,["command","disabled"])]),_:2},1024)]),default:e(()=>[t(r,{link:"",type:"primary"},{default:e(()=>[d(o(s(i)("setting.button.actions"))+" ",1),t(N,{class:"el-icon--right"},{default:e(()=>[t(J)]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])):(u(),f(S,{key:1,title:l.$t("setting.noPlayersFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1},8,["style"])]),_:1},8,["label"]),t(B,{label:l.$t("setting.adminList"),name:"adminList"},{default:e(()=>[t(z,{style:F(s($)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:e(()=>[p("div",Se,[d(o(s(i)("setting.adminList"))+" ",1),p("div",null,[t(r,{size:"default",onClick:n[1]||(n[1]=a=>g(!0))},{default:e(()=>[d(o(s(i)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[C.value.length>0?(u(),v("div",Te,[t(E,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[d(o(s(i)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),p("div",Ue,[(u(!0),v(j,null,q(C.value,a=>(u(),f(y,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:le=>oe(a)},{default:e(()=>[d(o(a+W(a)),1)]),_:2},1032,["effect","onClose"]))),256))])])):(u(),f(S,{key:1,title:l.$t("setting.noAdminFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1},8,["style"])]),_:1},8,["label"]),t(B,{label:l.$t("setting.blockList"),name:"blockList"},{default:e(()=>[t(z,{style:F(s($)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:e(()=>[p("div",We,[d(o(s(i)("setting.blockList"))+" ",1),p("div",null,[t(r,{type:"success",onClick:fe},{default:e(()=>[d(o(s(i)("setting.blockListItems.uploadButton")),1)]),_:1}),t(r,{size:"default",onClick:n[2]||(n[2]=a=>g(!0))},{default:e(()=>[d(o(s(i)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[D.value.length>0?(u(),v("div",Ie,[t(E,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[d(o(s(i)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),p("div",Me,[(u(!0),v(j,null,q(D.value,a=>(u(),f(y,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:le=>de(a)},{default:e(()=>[d(o(a+W(a)),1)]),_:2},1032,["effect","onClose"]))),256))])])):(u(),f(S,{key:1,title:l.$t("setting.noBlockFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1},8,["style"])]),_:1},8,["label"]),t(B,{label:l.$t("setting.whiteList"),name:"whiteList"},{default:e(()=>[t(z,{style:F(s($)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:e(()=>[p("div",Re,[d(o(s(i)("setting.whiteList"))+" ",1),p("div",null,[t(r,{size:"default",onClick:n[3]||(n[3]=a=>g(!0))},{default:e(()=>[d(o(s(i)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[x.value.length>0?(u(),v("div",Ee,[t(E,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[d(o(s(i)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),p("div",je,[(u(!0),v(j,null,q(x.value,a=>(u(),f(y,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:le=>ue(a)},{default:e(()=>[d(o(a+W(a)),1)]),_:2},1032,["effect","onClose"]))),256))])])):(u(),f(S,{key:1,title:l.$t("setting.noWhiteFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1},8,["style"])]),_:1},8,["label"]),t(B,{label:s(i)("setting.historyPlayer"),name:"history"},{default:e(()=>[t(z,{style:F(s($)?"min-height: 500px":"min-height: 700px"),shadow:"never"},{header:e(()=>[p("div",qe,[t(_e,{content:s(i)("setting.historyPlayerTip"),effect:"light",placement:"top"},{default:e(()=>[p("div",Ge,[d(o(s(i)("setting.historyPlayer"))+" ",1),t(N,null,{default:e(()=>[t(s(xe))]),_:1})])]),_:1},8,["content"]),t(r,{size:"default",onClick:n[4]||(n[4]=a=>X(!0))},{default:e(()=>[d(o(s(i)("setting.refresh")),1)]),_:1})])]),default:e(()=>[ne((u(),f(ee,{ref:"tableRef",data:I.value,"max-height":s($)?450:550,border:""},{default:e(()=>[t(_,{label:l.$t("setting.nickName"),prop:"nickname"},null,8,["label"]),t(_,{label:l.$t("setting.role"),prop:"prefab"},{default:e(a=>[a.row.prefab?(u(),f(y,{key:0,type:"success"},{default:e(()=>[d(o(a.row.prefab),1)]),_:2},1024)):(u(),f(y,{key:1,type:"warning"},{default:e(()=>[d(o(s(i)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),t(_,{label:l.$t("setting.age"),prop:"age"},{default:e(a=>[a.row.age?(u(),f(y,{key:0,type:"success"},{default:e(()=>[d(o(a.row.age),1)]),_:2},1024)):(u(),f(y,{key:1,type:"warning"},{default:e(()=>[d(o(s(i)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),t(_,{label:"UID",prop:"uid"}),t(_,{label:l.$t("setting.button.actions"),prop:"actions"},{default:e(a=>[t(Z,{trigger:"hover",onCommand:Q},{dropdown:e(()=>[t(Y,null,{default:e(()=>[t(k,{command:{type:"admin",uid:a.row.uid},disabled:P(a.row.uid)},{default:e(()=>[d(o(s(i)("setting.addAdmin")),1)]),_:2},1032,["command","disabled"]),t(k,{command:{type:"block",uid:a.row.uid},disabled:K(a.row.uid)},{default:e(()=>[d(o(s(i)("setting.addBlock")),1)]),_:2},1032,["command","disabled"]),t(k,{command:{type:"white",uid:a.row.uid},disabled:O(a.row.uid)},{default:e(()=>[d(o(s(i)("setting.addWhite")),1)]),_:2},1032,["command","disabled"]),t(k,{command:{type:"kick",uid:a.row.uid},disabled:P(a.row.uid),divided:""},{default:e(()=>[d(o(s(i)("setting.kick")),1)]),_:2},1032,["command","disabled"])]),_:2},1024)]),default:e(()=>[t(r,{link:"",type:"primary"},{default:e(()=>[d(o(s(i)("setting.button.actions"))+" ",1),t(N,{class:"el-icon--right"},{default:e(()=>[t(J)]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data","max-height"])),[[te,M.value]])]),_:1},8,["style"])]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(ke,{modelValue:V.value,"onUpdate:modelValue":n[6]||(n[6]=a=>V.value=a),"close-on-click-modal":!w.value,"close-on-press-escape":!w.value,"show-close":!w.value,title:s(i)("setting.blockListItems.uploadButton"),width:"45%"},{default:e(()=>[ne((u(),f(ve,{ref_key:"uploadRef",ref:R,"before-upload":ge,"http-request":me,limit:1,drag:""},{tip:e(()=>[p("div",Ke,o(s(i)("setting.blockListItems.tips")),1)]),default:e(()=>[t(N,{class:"el-icon--upload"},{default:e(()=>[t(s(ze))]),_:1}),p("div",He,[d(o(s(i)("setting.import.dialog.text1"))+" ",1),p("em",null,o(s(i)("setting.import.dialog.text2")),1)])]),_:1})),[[te,w.value]])]),_:1},8,["modelValue","close-on-click-modal","close-on-press-escape","show-close","title"])])}}});export{Ye as default};
