import{u as Ve,a as Ne,g as Fe,D as Ie,G as Be,b as Pe,H as Re,c as pe,o as Ue,a1 as x,A as z,r as g,w as Ae,I as X,J as f,K as Ke,e as r,f as y,j as a,k as e,l as m,p as o,t as n,i,m as c,F as Y,x as Z,v as ee,a9 as Se,n as me,a8 as Te,a0 as Me,C as qe}from"./index-xsEJLFvK.js";const Ee={class:"page-div"},je={class:"card-header"},He={key:0},We={key:1},Ge={class:"card-header"},Je={key:0},Oe={style:{"margin-top":"20px"}},Qe={class:"card-header"},Xe={key:0},Ye={style:{"margin-top":"20px"}},Ze={class:"card-header"},et={key:0},tt={style:{"margin-top":"20px"}},lt={class:"card-header"},at={class:"fcc"},st={class:"el-upload__text"},nt={class:"el-upload__tip"},ot=Me({name:"settingsPlayer"}),ut=Object.assign(ot,{setup(it){const{t:d}=Ve(),{isMobile:ge}=Ne(),h=Fe(),R=Ie();Be();const te=Pe(),le=Re("refresh"),L=pe(()=>h.isDark),k=pe(()=>h.language);Ue(()=>{w()});const w=(s=!1)=>{x.player.list.get({clusterName:h.selectedDstCluster}).then(l=>{M.value=l.data.players,q.value=l.data.uidMap,V.value=[];for(let u of l.data.adminList)u!==""&&V.value.push(u);N.value=[];for(let u of l.data.blockList)u!==""&&N.value.push(u);F.value=[];for(let u of l.data.whiteList)u!==""&&F.value.push(u);if(s){let u;k.value==="zh"?u="刷新成功":u="Refresh Success",z(u)}})},ae=g("players"),M=g([]),q=g({}),V=g([]),N=g([]),F=g([]),U=s=>{for(let l of V.value)if(l===s)return!0},se=s=>{for(let l of N.value)if(l===s)return!0},ne=s=>{for(let l of F.value)if(l===s)return!0},oe=s=>{switch(s.type){case"admin":C(s.type,"add",s.uid);break;case"block":C(s.type,"add",s.uid);break;case"white":C(s.type,"add",s.uid);break;case"kick":_e(s.uid);break}},C=(s,l,u)=>{const p={clusterName:h.selectedDstCluster,listName:s,type:l,uid:u};x.player.change.post(p).then(_=>{z(_.message),w()})},_e=s=>{const l={clusterName:h.selectedDstCluster,uid:s};x.player.kick.post(l).then(u=>{z(u.message)})},E=s=>s in q.value?" ["+q.value[s]+"]":k.value==="zh"?" [暂未获取到]":" [Not yet obtained]",ve=(s,l)=>{s.paneName==="history"&&W()},j=g([]),H=g(!1),W=(s=!1)=>{H.value=!0,j.value=[];const l={clusterName:h.selectedDstCluster};x.player.history.get(l).then(u=>{for(let p of u.data)p.uid.length===11&&j.value.push(p);if(s){let p;k.value==="zh"?p="刷新成功":p="Refresh Success",z(p)}}).finally(()=>{H.value=!1})},G=g(),A=g(!1),$=g(!1),ye=()=>{G.value&&G.value.clearFiles(),A.value=!0,$.value=!1},he=s=>/\.xls|xlsx$/i.test(s.name)?!0:(qe(k.value==="zh"?"请上传Excel文件":"Please upload a Excel file"),!1),be=s=>{$.value=!0;const l=new FormData;l.append("file",s.file),x.player.addBlockUpload.post(l).then(u=>{w(),z(u.message)}).finally(()=>{A.value=!1,$.value=!1})},ke=()=>{setTimeout(()=>{R.meta.isKeepAlive&&te.removeKeepAliveName(R.name),le(!1),X(()=>{R.meta.isKeepAlive&&te.addKeepAliveName(R.name),le(!0)})},0)},I=g(!1),K=g(),v=g(""),J=()=>{I.value=!0,X(()=>{K.value.input.focus()})},D=s=>{v.value&&C(s,"add",v.value),I.value=!1,v.value=""},we=()=>{const s={clusterName:h.selectedDstCluster};x.player.historyClean.post(s).then(l=>{z(l.message)}).finally(()=>{W(!1)})};return Ae(()=>h.selectedDstCluster,s=>{s&&X(()=>{ke()})},{immediate:!1}),(s,l)=>{const u=f("el-button"),p=f("el-table-column"),_=f("el-tag"),ie=f("arrow-down"),S=f("el-icon"),b=f("el-dropdown-item"),de=f("el-dropdown-menu"),ue=f("el-dropdown"),re=f("el-table"),T=f("el-result"),B=f("el-card"),P=f("el-tab-pane"),O=f("el-alert"),Q=f("el-input"),Ce=f("el-tooltip"),$e=f("el-tabs"),Le=f("el-col"),De=f("el-row"),xe=f("el-upload"),ze=f("el-dialog"),ce=Ke("loading");return r(),y("div",Ee,[a(De,{gutter:10},{default:e(()=>[a(Le,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[a($e,{modelValue:ae.value,"onUpdate:modelValue":l[14]||(l[14]=t=>ae.value=t),onTabClick:ve},{default:e(()=>[a(P,{label:s.$t("setting.players"),name:"players"},{default:e(()=>[a(B,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[m("div",je,[o(n(i(d)("setting.players"))+" ",1),m("div",null,[a(u,{size:"default",onClick:l[0]||(l[0]=t=>w(!0))},{default:e(()=>[o(n(i(d)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[M.value?(r(),c(re,{key:0,data:M.value,border:"",size:"small",style:{width:"100%"}},{default:e(()=>[a(p,{label:s.$t("setting.nickName"),prop:"nickName"},null,8,["label"]),a(p,{label:s.$t("setting.role"),prop:"prefab"},{default:e(t=>[t.row.prefab===""?(r(),y("span",He,n(i(d)("setting.roleFail")),1)):(r(),y("span",We,n(t.row.prefab),1))]),_:1},8,["label"]),a(p,{label:s.$t("setting.age"),prop:"age"},{default:e(t=>[t.row.age?(r(),c(_,{key:0,type:"success"},{default:e(()=>[o(n(t.row.age),1)]),_:2},1024)):(r(),c(_,{key:1,type:"warning"},{default:e(()=>[o(n(i(d)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(p,{label:"UID",prop:"uid"}),a(p,{label:s.$t("setting.button.actions"),prop:"actions"},{default:e(t=>[a(ue,{trigger:"hover",onCommand:oe},{dropdown:e(()=>[a(de,null,{default:e(()=>[a(b,{command:{type:"admin",uid:t.row.uid},disabled:U(t.row.uid)},{default:e(()=>[o(n(i(d)("setting.addAdmin")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"block",uid:t.row.uid},disabled:se(t.row.uid)},{default:e(()=>[o(n(i(d)("setting.addBlock")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"white",uid:t.row.uid},disabled:ne(t.row.uid)},{default:e(()=>[o(n(i(d)("setting.addWhite")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"kick",uid:t.row.uid},disabled:U(t.row.uid),divided:""},{default:e(()=>[o(n(i(d)("setting.kick")),1)]),_:2},1032,["command","disabled"])]),_:2},1024)]),default:e(()=>[a(u,{link:"",type:"primary"},{default:e(()=>[o(n(i(d)("setting.button.actions"))+" ",1),a(S,{class:"el-icon--right"},{default:e(()=>[a(ie)]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])):(r(),c(T,{key:1,title:s.$t("setting.noPlayersFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1})]),_:1},8,["label"]),a(P,{label:s.$t("setting.adminList"),name:"adminList"},{default:e(()=>[a(B,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[m("div",Ge,[o(n(i(d)("setting.adminList"))+" ",1),m("div",null,[a(u,{size:"default",onClick:l[1]||(l[1]=t=>w(!0))},{default:e(()=>[o(n(i(d)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[V.value.length>0?(r(),y("div",Je,[a(O,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[o(n(i(d)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),m("div",Oe,[(r(!0),y(Y,null,Z(V.value,t=>(r(),c(_,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:fe=>C("admin","delete",t)},{default:e(()=>[o(n(t+E(t)),1)]),_:2},1032,["effect","onClose"]))),256)),I.value?(r(),c(Q,{key:0,ref_key:"InputRef",ref:K,modelValue:v.value,"onUpdate:modelValue":l[2]||(l[2]=t=>v.value=t),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[3]||(l[3]=ee(t=>D("admin"),["enter"])),onBlur:l[4]||(l[4]=t=>D("admin"))},null,8,["modelValue"])):(r(),c(u,{key:1,onClick:J,style:{margin:"5px 5px 0 0"}},{default:e(()=>[o(n(k.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])])):(r(),c(T,{key:1,title:s.$t("setting.noAdminFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1})]),_:1},8,["label"]),a(P,{label:s.$t("setting.blockList"),name:"blockList"},{default:e(()=>[a(B,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[m("div",Qe,[o(n(i(d)("setting.blockList"))+" ",1),m("div",null,[a(u,{type:"success",onClick:ye},{default:e(()=>[o(n(i(d)("setting.blockListItems.uploadButton")),1)]),_:1}),a(u,{size:"default",onClick:l[5]||(l[5]=t=>w(!0))},{default:e(()=>[o(n(i(d)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[N.value.length>0?(r(),y("div",Xe,[a(O,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[o(n(i(d)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),m("div",Ye,[(r(!0),y(Y,null,Z(N.value,t=>(r(),c(_,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:fe=>C("block","delete",t)},{default:e(()=>[o(n(t+E(t)),1)]),_:2},1032,["effect","onClose"]))),256)),I.value?(r(),c(Q,{key:0,ref_key:"InputRef",ref:K,modelValue:v.value,"onUpdate:modelValue":l[6]||(l[6]=t=>v.value=t),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[7]||(l[7]=ee(t=>D("block"),["enter"])),onBlur:l[8]||(l[8]=t=>D("block"))},null,8,["modelValue"])):(r(),c(u,{key:1,onClick:J,style:{margin:"5px 5px 0 0"}},{default:e(()=>[o(n(k.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])])):(r(),c(T,{key:1,title:s.$t("setting.noBlockFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1})]),_:1},8,["label"]),a(P,{label:s.$t("setting.whiteList"),name:"whiteList"},{default:e(()=>[a(B,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[m("div",Ze,[o(n(i(d)("setting.whiteList"))+" ",1),m("div",null,[a(u,{size:"default",onClick:l[9]||(l[9]=t=>w(!0))},{default:e(()=>[o(n(i(d)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[F.value.length>0?(r(),y("div",et,[a(O,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[o(n(i(d)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),m("div",tt,[(r(!0),y(Y,null,Z(F.value,t=>(r(),c(_,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:fe=>C("white","delete",t)},{default:e(()=>[o(n(t+E(t)),1)]),_:2},1032,["effect","onClose"]))),256)),I.value?(r(),c(Q,{key:0,ref_key:"InputRef",ref:K,modelValue:v.value,"onUpdate:modelValue":l[10]||(l[10]=t=>v.value=t),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[11]||(l[11]=ee(t=>D("white"),["enter"])),onBlur:l[12]||(l[12]=t=>D("white"))},null,8,["modelValue"])):(r(),c(u,{key:1,onClick:J,style:{margin:"5px 5px 0 0"}},{default:e(()=>[o(n(k.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])])):(r(),c(T,{key:1,title:s.$t("setting.noWhiteFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1})]),_:1},8,["label"]),a(P,{label:i(d)("setting.historyPlayer"),name:"history"},{default:e(()=>[a(B,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[m("div",lt,[a(Ce,{content:i(d)("setting.historyPlayerTip"),effect:"light",placement:"top"},{default:e(()=>[m("div",at,[o(n(i(d)("setting.historyPlayer"))+" ",1),a(S,null,{default:e(()=>[a(i(Se))]),_:1})])]),_:1},8,["content"]),m("div",null,[a(u,{size:"default",type:"danger",onClick:we},{default:e(()=>[o(n(i(d)("setting.historyClean")),1)]),_:1}),a(u,{size:"default",onClick:l[13]||(l[13]=t=>W(!0))},{default:e(()=>[o(n(i(d)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[me((r(),c(re,{ref:"tableRef",data:j.value,"max-height":i(ge)?450:550,border:""},{default:e(()=>[a(p,{label:s.$t("setting.nickName"),prop:"nickname"},null,8,["label"]),a(p,{label:s.$t("setting.role"),prop:"prefab"},{default:e(t=>[t.row.prefab?(r(),c(_,{key:0,type:"success"},{default:e(()=>[o(n(t.row.prefab),1)]),_:2},1024)):(r(),c(_,{key:1,type:"warning"},{default:e(()=>[o(n(i(d)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(p,{label:s.$t("setting.age"),prop:"age"},{default:e(t=>[t.row.age?(r(),c(_,{key:0,type:"success"},{default:e(()=>[o(n(t.row.age),1)]),_:2},1024)):(r(),c(_,{key:1,type:"warning"},{default:e(()=>[o(n(i(d)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(p,{label:"UID",prop:"uid"}),a(p,{label:s.$t("setting.button.actions"),prop:"actions"},{default:e(t=>[a(ue,{trigger:"hover",onCommand:oe},{dropdown:e(()=>[a(de,null,{default:e(()=>[a(b,{command:{type:"admin",uid:t.row.uid},disabled:U(t.row.uid)},{default:e(()=>[o(n(i(d)("setting.addAdmin")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"block",uid:t.row.uid},disabled:se(t.row.uid)},{default:e(()=>[o(n(i(d)("setting.addBlock")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"white",uid:t.row.uid},disabled:ne(t.row.uid)},{default:e(()=>[o(n(i(d)("setting.addWhite")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"kick",uid:t.row.uid},disabled:U(t.row.uid),divided:""},{default:e(()=>[o(n(i(d)("setting.kick")),1)]),_:2},1032,["command","disabled"])]),_:2},1024)]),default:e(()=>[a(u,{link:"",type:"primary"},{default:e(()=>[o(n(i(d)("setting.button.actions"))+" ",1),a(S,{class:"el-icon--right"},{default:e(()=>[a(ie)]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data","max-height"])),[[ce,H.value]])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(ze,{modelValue:A.value,"onUpdate:modelValue":l[15]||(l[15]=t=>A.value=t),"close-on-click-modal":!$.value,"close-on-press-escape":!$.value,"show-close":!$.value,title:i(d)("setting.blockListItems.uploadButton"),width:"45%"},{default:e(()=>[me((r(),c(xe,{ref_key:"uploadRef",ref:G,"before-upload":he,"http-request":be,limit:1,drag:""},{tip:e(()=>[m("div",nt,n(i(d)("setting.blockListItems.tips")),1)]),default:e(()=>[a(S,{class:"el-icon--upload"},{default:e(()=>[a(i(Te))]),_:1}),m("div",st,[o(n(i(d)("setting.import.dialog.text1"))+" ",1),m("em",null,n(i(d)("setting.import.dialog.text2")),1)])]),_:1})),[[ce,$.value]])]),_:1},8,["modelValue","close-on-click-modal","close-on-press-escape","show-close","title"])])}}});export{ut as default};
