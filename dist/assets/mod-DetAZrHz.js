import{_ as Be,o as Ne,u as Ae,a as Ee,g as Pe,c as re,r as u,z as Ge,$ as qe,B as d,C as je,d as s,e as y,f as t,w as e,j as l,l as A,k as m,i as p,q as Re,p as M,m as c,t as r,F as I,v as E,n as b,s as Ke,X as Xe,y as z,A as He}from"./index-fZn0uqSD.js";import{s as k}from"./index-BjueuODM.js";import{e as ue}from"./index-Dq-0GX-O.js";import Je from"./modInfo-C7MrXjdQ.js";const Qe={class:"page-div"},We={class:"item-container"},Ye={class:"card-footer",style:{"margin-top":"20px"}},Ze={class:"card-header"},et={style:{display:"flex"}},tt={style:{display:"flex","margin-left":"5px","flex-direction":"column","justify-content":"center"}},lt={class:"card-header"},at=Xe({name:"settingsMod"}),ot=Object.assign(at,{setup(nt){Ne(async()=>{await V(),Se()});const{t:n}=Ae(),{isMobile:_}=Ee(),ee=Pe(),ce=re(()=>ee.isDark),me=re(()=>ee.language),te=u("Download"),ge=(o,i)=>{o.paneName==="Add"&&L(),o.paneName==="Setting"&&le()},v=u([]),P=u(!1),le=()=>{P.value=!0,h.value=0,G.value="",k.mod.settingFormat.get().then(o=>{v.value=o.data}).finally(()=>{P.value=!1})},h=u(0),G=u(""),ae=(o,i)=>{h.value=o,G.value=i,pe()},D=u(!1),U=u({id:"",configOptions:[]}),pe=()=>{D.value=!0,k.mod.configOptions.get({id:h.value}).then(o=>{U.value=o.data}).finally(()=>{D.value=!1})},fe=()=>{D.value=!0,k.mod.configChange.post({modFormattedData:v.value}).then(o=>{z(o.message)}).finally(()=>{D.value=!1})},q=u(!1),O=u({total:0,rows:[]}),_e=u(),g=u({page:1,pageSize:30,searchText:"",searchType:"text"}),V=()=>{q.value=!0,ue.modSearch.get(g.value).then(o=>{O.value.rows=o.data.rows,O.value.total=o.data.total,g.value.searchType==="id"&&Ge(me.value==="zh"?"ID搜索不显示评分":"Search by ID will not display the vote data")}).finally(()=>{q.value=!1})},ve=o=>{V()},he=o=>{V()},oe=u([]),j=u(!1),L=()=>{j.value=!0,ue.modInfoDownloaded.get().then(o=>{oe.value=o.data}).finally(()=>{j.value=!1})},R=u(!1),ye=()=>{R.value=!0,k.mod.sync.post().then(o=>{z(o.message),L()}).finally(()=>{R.value=!1})},T=u(!1),be=o=>{let i=o.cmd,f=o.row;switch(T.value=!0,i){case"enable":we(f);break;case"delete":ke(f);break;default:T.value=!1,He("error")}},we=o=>{const f={isUgc:o.file_url==="",id:o.id};k.mod.enable.post(f).then(S=>{z(S.message)}).finally(()=>{T.value=!1})},ke=o=>{const f={isUgc:o.file_url==="",id:o.id};k.mod.delete.post(f).then(S=>{z(S.message),L()}).finally(()=>{T.value=!1})},K=u(!1),xe=()=>{K.value=!0;const i={isUgc:G.value==="",id:h.value};k.mod.disable.post(i).then(f=>{z(f.message),le()}).finally(()=>{K.value=!1})},X=u(""),Se=()=>{qe.osInfo.get().then(o=>{X.value=o.data.Platform})},H=u(!1),Ce=()=>{H.value=!0,k.mod.macosExport.post().then(o=>{z(o.message)}).finally(()=>{H.value=!1})};return(o,i)=>{const f=d("el-option"),S=d("el-select"),x=d("el-button"),Me=d("el-input"),$=d("el-form-item"),ne=d("el-form"),J=d("el-scrollbar"),ze=d("el-pagination"),B=d("el-card"),Q=d("el-tab-pane"),de=d("el-tooltip"),De=d("el-alert"),F=d("el-table-column"),C=d("el-tag"),Ue=d("arrow-down"),Ve=d("el-icon"),se=d("el-dropdown-item"),Te=d("el-dropdown-menu"),Fe=d("el-dropdown"),Ie=d("el-table"),W=d("el-col"),ie=d("el-row"),Oe=d("el-image"),Le=d("el-divider"),Y=d("el-result"),$e=d("el-tabs"),N=je("loading");return s(),y("div",Qe,[t($e,{modelValue:te.value,"onUpdate:modelValue":i[6]||(i[6]=a=>te.value=a),onTabClick:ge},{default:e(()=>[t(Q,{label:l(n)("setting.mod.tab.download"),name:"Download"},{default:e(()=>[A((s(),m(B,{style:{height:"78vh"},shadow:"never"},{default:e(()=>[p("div",null,[t(ne,{ref_key:"modSearchFormRef",ref:_e,model:g.value,inline:!0,onKeyup:Re(V,["enter"])},{default:e(()=>[t($,null,{default:e(()=>[t(Me,{modelValue:g.value.searchText,"onUpdate:modelValue":i[1]||(i[1]=a=>g.value.searchText=a),style:M(l(_)?"width: 75vw;":"width: 50vw;")},{prepend:e(()=>[t(S,{modelValue:g.value.searchType,"onUpdate:modelValue":i[0]||(i[0]=a=>g.value.searchType=a),style:{width:"85px"}},{default:e(()=>[t(f,{label:o.$t("setting.mod.download.searchTypeText"),value:"text"},null,8,["label"]),t(f,{label:o.$t("setting.mod.download.searchTypeId"),value:"id"},null,8,["label"])]),_:1},8,["modelValue"])]),append:e(()=>[t(x,{type:"primary",onClick:V},{default:e(()=>[c(r(l(n)("setting.mod.download.search")),1)]),_:1})]),_:1},8,["modelValue","style"])]),_:1})]),_:1},8,["model"])]),p("div",null,[t(J,{"max-height":"60vh"},{default:e(()=>[p("div",We,[(s(!0),y(I,null,E(O.value.rows,a=>(s(),m(Je,{mod:a},null,8,["mod"]))),256))])]),_:1})]),p("div",Ye,[t(ze,{"current-page":g.value.page,"onUpdate:currentPage":i[2]||(i[2]=a=>g.value.page=a),"page-size":g.value.pageSize,"onUpdate:pageSize":i[3]||(i[3]=a=>g.value.pageSize=a),"page-sizes":[10,20,30,40,50,100],layout:"total, sizes, prev, pager, next",total:O.value.total,onSizeChange:i[4]||(i[4]=a=>ve(g.value.pageSize)),onCurrentChange:i[5]||(i[5]=a=>he(g.value.page))},null,8,["current-page","page-size","total"])])]),_:1})),[[N,q.value]])]),_:1},8,["label"]),t(Q,{label:l(n)("setting.mod.tab.add"),name:"Add"},{default:e(()=>[t(ie,{gutter:10},{default:e(()=>[t(W,{span:24},{default:e(()=>[A((s(),m(B,{style:{height:"70vh"},shadow:"never"},{header:e(()=>[p("div",Ze,[p("span",null,r(l(n)("setting.mod.add.header.title")),1),p("div",null,[t(x,{onClick:L},{default:e(()=>[c(r(l(n)("setting.mod.add.header.refresh")),1)]),_:1}),t(de,{effect:"light","show-after":500,content:l(n)("setting.mod.add.header.syncTooltip"),placement:"top"},{default:e(()=>[t(x,{type:"primary",loading:R.value,onClick:ye},{default:e(()=>[c(r(l(n)("setting.mod.add.header.sync")),1)]),_:1},8,["loading"])]),_:1},8,["content"]),X.value==="darwin"?(s(),m(x,{key:0,onClick:Ce,loading:H.value,type:"success"},{default:e(()=>[c(r(l(n)("setting.mod.add.header.export")),1)]),_:1},8,["loading"])):b("",!0)])])]),default:e(()=>[t(De,{closable:!1,effect:ce.value?"light":"dark",type:"warning"},{default:e(()=>[c(r(l(n)("setting.mod.add.alert")),1)]),_:1},8,["effect"]),t(Ie,{data:oe.value,border:"",style:{height:"55vh","margin-top":"10px"}},{default:e(()=>[t(F,{label:l(n)("setting.mod.add.table.name"),prop:"name"},null,8,["label"]),t(F,{label:"ID",prop:"id"}),t(F,{label:"UGC"},{default:e(a=>[a.row.file_url===""?(s(),m(C,{key:0,type:"primary"},{default:e(()=>[c(r(l(n)("setting.mod.add.table.ugc.yes")),1)]),_:1})):(s(),m(C,{key:1,type:"info"},{default:e(()=>[c(r(l(n)("setting.mod.add.table.ugc.no")),1)]),_:1}))]),_:1}),t(F,{label:l(n)("setting.mod.add.table.size")},{default:e(a=>[c(r(l(Ke)(a.row.size)),1)]),_:1},8,["label"]),t(F,{label:l(n)("setting.mod.add.table.action")},{default:e(a=>[t(Fe,{onCommand:be,trigger:"click"},{dropdown:e(()=>[t(Te,null,{default:e(()=>[t(se,{command:{cmd:"enable",row:a.row}},{default:e(()=>[c(r(l(n)("setting.mod.add.table.enable")),1)]),_:2},1032,["command"]),t(se,{command:{cmd:"delete",row:a.row}},{default:e(()=>[c(r(l(n)("setting.mod.add.table.delete")),1)]),_:2},1032,["command"])]),_:2},1024)]),default:e(()=>[t(x,{type:"primary",link:"",loading:T.value},{default:e(()=>[c(r(l(n)("setting.mod.add.table.action")),1),t(Ve,{class:"el-icon--right"},{default:e(()=>[t(Ue)]),_:1})]),_:1},8,["loading"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])]),_:1})),[[N,j.value]])]),_:1})]),_:1})]),_:1},8,["label"]),X.value!=="darwin"?(s(),m(Q,{key:0,label:l(n)("setting.mod.tab.setting"),name:"Setting"},{default:e(()=>[t(ie,{gutter:10},{default:e(()=>[t(W,{lg:8,md:8,sm:24,span:8,xs:24},{default:e(()=>[A((s(),m(B,{style:M(l(_)?"height: 50vh":"height: 70vh"),shadow:"never"},{default:e(()=>[t(J,{"max-height":l(_)?"45vh":"65vh"},{default:e(()=>[v.value?(s(!0),y(I,{key:0},E(v.value,(a,w)=>(s(),y(I,null,[p("div",et,[p("div",null,[t(Oe,{src:a.preview_url,fit:"fill",onClick:Z=>ae(a.id,a.file_url),style:{width:"75px",height:"75px"}},null,8,["src","onClick"])]),p("div",tt,[t(x,{link:"",type:"primary",onClick:Z=>ae(a.id,a.file_url)},{default:e(()=>[c(r(a.name),1)]),_:2},1032,["onClick"]),p("div",null,[a.enable?(s(),m(C,{key:0,type:"success"},{default:e(()=>[c(r(l(n)("setting.mod.setting.left.enable")),1)]),_:1})):b("",!0),a.enable?b("",!0):(s(),m(C,{key:1,type:"info"},{default:e(()=>[c(r(l(n)("setting.mod.setting.left.disable")),1)]),_:1}))])])]),w!==v.value.length-1?(s(),m(Le,{key:0})):b("",!0)],64))),256)):(s(),y("div",{key:1,class:"fcc",style:M(l(_)?"height: 50vh":"height: 70vh")},[t(Y,{icon:"warning",title:l(n)("setting.mod.setting.left.result")},null,8,["title"])],4))]),_:1},8,["max-height"])]),_:1},8,["style"])),[[N,P.value]])]),_:1}),t(W,{lg:16,md:16,sm:24,span:16,xs:24},{default:e(()=>[A((s(),m(B,{style:M(l(_)?"height: 50vh; margin-top: 10px":"height: 70vh"),shadow:"never"},{header:e(()=>[p("div",lt,[p("span",null,r(l(n)("setting.mod.setting.right.header.title")),1),t(x,{type:"danger",disabled:h.value===0,loading:K.value,onClick:xe},{default:e(()=>[c(r(l(n)("setting.mod.setting.right.header.disable")),1)]),_:1},8,["disabled","loading"])])]),default:e(()=>[h.value!==0?(s(),m(J,{key:0,"max-height":l(_)?"45vh":"65vh"},{default:e(()=>[U.value.configOptions.length!==0?(s(),m(ne,{key:0,ref:"modSettingFormRef",size:l(_)?"small":"large","label-position":l(_)?"top":"left","label-width":l(_)?"70":"auto"},{default:e(()=>[t($,{label:"ID"},{default:e(()=>[t(C,null,{default:e(()=>[c(r(U.value.id),1)]),_:1})]),_:1}),t($,{label:l(n)("setting.mod.setting.right.name")},{default:e(()=>[t(C,{type:"info"},{default:e(()=>[c(r(v.value[v.value.findIndex(a=>a.id===h.value)].name),1)]),_:1})]),_:1},8,["label"]),(s(!0),y(I,null,E(U.value.configOptions,a=>(s(),m(de,{"show-after":500,effect:"light",content:a.hover,placement:"top"},{default:e(()=>[t($,{label:a.label},{default:e(()=>[t(S,{modelValue:v.value[v.value.findIndex(w=>w.id===h.value)].configurationOptions[a.name],"onUpdate:modelValue":w=>v.value[v.value.findIndex(Z=>Z.id===h.value)].configurationOptions[a.name]=w,onChange:fe},{default:e(()=>[(s(!0),y(I,null,E(a.options,w=>(s(),m(f,{label:w.description,value:w.data},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1032,["content"]))),256))]),_:1},8,["size","label-position","label-width"])):b("",!0),U.value.configOptions.length===0?(s(),y("div",{key:1,class:"fcc",style:M(l(_)?"height: 40vh; margin-top: 10px":"height: 60vh")},[t(Y,{icon:"info",title:l(n)("setting.mod.setting.right.result")},null,8,["title"])],4)):b("",!0)]),_:1},8,["max-height"])):b("",!0),h.value===0?(s(),y("div",{key:1,class:"fcc",style:M(l(_)?"height: 40vh; margin-top: 10px":"height: 60vh")},[t(Y,{icon:"info",title:l(n)("setting.mod.setting.right.result2")},null,8,["title"])],4)):b("",!0)]),_:1},8,["style"])),[[N,D.value]])]),_:1})]),_:1})]),_:1},8,["label"])):b("",!0)]),_:1},8,["modelValue"])])}}}),ut=Be(ot,[["__scopeId","data-v-16255d02"]]);export{ut as default};
