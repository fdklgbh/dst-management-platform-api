import{a3 as Xe,a4 as Mt,u as Gt,o as Pt,r as ee,a as jt,g as qt,c as zt,A as O,d as ie,e as Wt,f as u,w as d,j as y,l as ce,p as xe,i as ft,m as fe,t as pe,n as de,V as Kt,z as Qe,x as Ye}from"./index-Er8_s2TA.js";import{s as Ze}from"./index-Cu2mHlCZ.js";import{s as Re}from"./index-OegvBw2x.js";var Me={exports:{}};Me.exports;(function(Ce,N){(function(L,a,o){var D=N&&!N.nodeType&&N,c=Ce&&!Ce.nodeType&&Ce,x=D&&c&&typeof Xe=="object"&&Xe,ke=c&&c.exports===D&&D;x&&(x.global===x||x.window===x||x.self===x)&&(L=x),o(D&&c?ke?c.exports:D:L[a]={})})(Xe,"luaparse",function(L){L.version="0.3.1";var a,o,D,c,x,ke=L.defaultOptions={wait:!1,comments:!0,scope:!1,locations:!1,ranges:!1,onCreateNode:null,onCreateScope:null,onDestroyScope:null,onLocalDeclaration:null,luaVersion:"5.1",encodingMode:"none"};function Oe(e,t){return t=t||0,e<128?String.fromCharCode(e):e<2048?String.fromCharCode(t|192|e>>6,t|128|e&63):e<65536?String.fromCharCode(t|224|e>>12,t|128|e>>6&63,t|128|e&63):e<1114112?String.fromCharCode(t|240|e>>18,t|128|e>>12&63,t|128|e>>6&63,t|128|e&63):null}function Ne(e,t){for(var n=e.toString(16);n.length<t;)n="0"+n;return n}function w(e){return function(t){var n=e.exec(t);if(!n)return t;m(null,h.invalidCodeUnit,Ne(n[0].charCodeAt(0),4).toUpperCase())}}var De={"pseudo-latin1":{fixup:w(/[^\x00-\xff]/),encodeByte:function(e){return e===null?"":String.fromCharCode(e)},encodeUTF8:function(e){return Oe(e)}},"x-user-defined":{fixup:w(/[^\x00-\x7f\uf780-\uf7ff]/),encodeByte:function(e){return e===null?"":e>=128?String.fromCharCode(e|63232):String.fromCharCode(e)},encodeUTF8:function(e){return Oe(e,63232)}},none:{discardStrings:!0,fixup:function(e){return e},encodeByte:function(e){return""},encodeUTF8:function(e){return""}}},le=1,U=2,J=4,q=8,R=16,W=32,me=64,M=128,ge=256;L.tokenTypes={EOF:le,StringLiteral:U,Keyword:J,Identifier:q,NumericLiteral:R,Punctuator:W,BooleanLiteral:me,NilLiteral:M,VarargLiteral:ge};var h=L.errors={unexpected:"unexpected %1 '%2' near '%3'",unexpectedEOF:"unexpected symbol near '<eof>'",expected:"'%1' expected near '%2'",expectedToken:"%1 expected near '%2'",unfinishedString:"unfinished string near '%1'",malformedNumber:"malformed number near '%1'",decimalEscapeTooLarge:"decimal escape too large near '%1'",invalidEscape:"invalid escape sequence near '%1'",hexadecimalDigitExpected:"hexadecimal digit expected near '%1'",braceExpected:"missing '%1' near '%2'",tooLargeCodepoint:"UTF-8 value too large near '%1'",unfinishedLongString:"unfinished long string (starting at line %1) near '%2'",unfinishedLongComment:"unfinished long comment (starting at line %1) near '%2'",ambiguousSyntax:"ambiguous syntax (function call x new statement) near '%1'",noLoopToBreak:"no loop to break near '%1'",labelAlreadyDefined:"label '%1' already defined on line %2",labelNotVisible:"no visible label '%1' for <goto>",gotoJumpInLocalScope:"<goto %1> jumps into the scope of local '%2'",cannotUseVararg:"cannot use '...' outside a vararg function near '%1'",invalidCodeUnit:"code unit U+%1 is not allowed in the current encoding mode"},g=L.ast={labelStatement:function(e){return{type:"LabelStatement",label:e}},breakStatement:function(){return{type:"BreakStatement"}},gotoStatement:function(e){return{type:"GotoStatement",label:e}},returnStatement:function(e){return{type:"ReturnStatement",arguments:e}},ifStatement:function(e){return{type:"IfStatement",clauses:e}},ifClause:function(e,t){return{type:"IfClause",condition:e,body:t}},elseifClause:function(e,t){return{type:"ElseifClause",condition:e,body:t}},elseClause:function(e){return{type:"ElseClause",body:e}},whileStatement:function(e,t){return{type:"WhileStatement",condition:e,body:t}},doStatement:function(e){return{type:"DoStatement",body:e}},repeatStatement:function(e,t){return{type:"RepeatStatement",condition:e,body:t}},localStatement:function(e,t){return{type:"LocalStatement",variables:e,init:t}},assignmentStatement:function(e,t){return{type:"AssignmentStatement",variables:e,init:t}},callStatement:function(e){return{type:"CallStatement",expression:e}},functionStatement:function(e,t,n,i){return{type:"FunctionDeclaration",identifier:e,isLocal:n,parameters:t,body:i}},forNumericStatement:function(e,t,n,i,l){return{type:"ForNumericStatement",variable:e,start:t,end:n,step:i,body:l}},forGenericStatement:function(e,t,n){return{type:"ForGenericStatement",variables:e,iterators:t,body:n}},chunk:function(e){return{type:"Chunk",body:e}},identifier:function(e){return{type:"Identifier",name:e}},literal:function(e,t,n){return e=e===U?"StringLiteral":e===R?"NumericLiteral":e===me?"BooleanLiteral":e===M?"NilLiteral":"VarargLiteral",{type:e,value:t,raw:n}},tableKey:function(e,t){return{type:"TableKey",key:e,value:t}},tableKeyString:function(e,t){return{type:"TableKeyString",key:e,value:t}},tableValue:function(e){return{type:"TableValue",value:e}},tableConstructorExpression:function(e){return{type:"TableConstructorExpression",fields:e}},binaryExpression:function(e,t,n){var i=e==="and"||e==="or"?"LogicalExpression":"BinaryExpression";return{type:i,operator:e,left:t,right:n}},unaryExpression:function(e,t){return{type:"UnaryExpression",operator:e,argument:t}},memberExpression:function(e,t,n){return{type:"MemberExpression",indexer:t,identifier:n,base:e}},indexExpression:function(e,t){return{type:"IndexExpression",base:e,index:t}},callExpression:function(e,t){return{type:"CallExpression",base:e,arguments:t}},tableCallExpression:function(e,t){return{type:"TableCallExpression",base:e,arguments:t}},stringCallExpression:function(e,t){return{type:"StringCallExpression",base:e,argument:t}},comment:function(e,t){return{type:"Comment",value:e,raw:t}}};function v(e){if($){var t=z.pop();t.complete(),t.bless(e)}return o.onCreateNode&&o.onCreateNode(e),e}var Ee=Array.prototype.slice,Le=function(e,t){for(var n=0,i=e.length;n<i;++n)if(e[n]===t)return n;return-1};Array.prototype.indexOf&&(Le=function(e,t){return e.indexOf(t)});function f(e,t,n){for(var i=0,l=e.length;i<l;++i)if(e[i][t]===n)return i;return-1}function p(e){var t=Ee.call(arguments,1);return e=e.replace(/%(\d)/g,function(n,i){return""+t[i-1]||""}),e}var te=function(e){for(var t=Ee.call(arguments,1),n,i,l=0,b=t.length;l<b;++l){n=t[l];for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};Object.assign&&(te=Object.assign),L.SyntaxError=SyntaxError;function Ie(e){return Object.create?Object.create(e,{line:{writable:!0,value:e.line},index:{writable:!0,value:e.index},column:{writable:!0,value:e.column}}):e}function m(e){var t=p.apply(null,Ee.call(arguments,1)),n,i;throw e===null||typeof e.line>"u"?(i=r-B+1,n=Ie(new SyntaxError(p("[%1:%2] %3",C,i,t))),n.index=r,n.line=C,n.column=i):(i=e.range[0]-e.lineStart,n=Ie(new SyntaxError(p("[%1:%2] %3",e.line,i,t))),n.line=e.line,n.index=e.range[0],n.column=i),n}function re(e){var t=a.slice(e.range[0],e.range[1]);return t||e.value}function K(e,t){m(t,h.expectedToken,e,re(t))}function X(e){var t=re(Q);if(typeof e.type<"u"){var n;switch(e.type){case U:n="string";break;case J:n="keyword";break;case q:n="identifier";break;case R:n="number";break;case W:n="symbol";break;case me:n="boolean";break;case M:return m(e,h.unexpected,"symbol","nil",t);case le:return m(e,h.unexpectedEOF)}return m(e,h.unexpected,n,re(e),t)}return m(e,h.unexpected,"symbol",e,t)}var r,s,P,Q,be,_,C,B;L.lex=we;function we(){for(Ae();a.charCodeAt(r)===45&&a.charCodeAt(r+1)===45;)bt(),Ae();if(r>=D)return{type:le,value:"<eof>",line:C,lineStart:B,range:[r,r]};var e=a.charCodeAt(r),t=a.charCodeAt(r+1);if(_=r,St(e))return Ge();switch(e){case 39:case 34:return je();case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return tt();case 46:return oe(t)?tt():t===46?a.charCodeAt(r+2)===46?Pe():V(".."):V(".");case 61:return V(t===61?"==":"=");case 62:return c.bitwiseOperators&&t===62?V(">>"):V(t===61?">=":">");case 60:return c.bitwiseOperators&&t===60?V("<<"):V(t===61?"<=":"<");case 126:if(t===61)return V("~=");if(!c.bitwiseOperators)break;return V("~");case 58:return c.labels&&t===58?V("::"):V(":");case 91:return t===91||t===61?S():V("[");case 47:return c.integerDivision&&t===47?V("//"):V("/");case 38:case 124:if(!c.bitwiseOperators)break;case 42:case 94:case 37:case 44:case 123:case 125:case 93:case 40:case 41:case 59:case 35:case 45:case 43:return V(a.charAt(r))}return X(a.charAt(r))}function se(){var e=a.charCodeAt(r),t=a.charCodeAt(r+1);return Fe(e)?(e===10&&t===13&&++r,e===13&&t===10&&++r,++C,B=++r,!0):!1}function Ae(){for(;r<D;){var e=a.charCodeAt(r);if(yt(e))++r;else if(!se())break}}function Ge(){for(var e,t;xt(a.charCodeAt(++r)););return e=x.fixup(a.slice(_,r)),kt(e)?t=J:e==="true"||e==="false"?(t=me,e=e==="true"):e==="nil"?(t=M,e=null):t=q,{type:t,value:e,line:C,lineStart:B,range:[_,r]}}function V(e){return r+=e.length,{type:W,value:e,line:C,lineStart:B,range:[_,r]}}function Pe(){return r+=3,{type:ge,value:"...",line:C,lineStart:B,range:[_,r]}}function je(){for(var e=a.charCodeAt(r++),t=C,n=B,i=r,l=x.discardStrings?null:"",b;b=a.charCodeAt(r++),e!==b;)if((r>D||Fe(b))&&(l+=a.slice(i,r-1),m(null,h.unfinishedString,a.slice(_,r-1))),b===92){if(!x.discardStrings){var k=a.slice(i,r-1);l+=x.fixup(k)}var T=ht();x.discardStrings||(l+=T),i=r}return x.discardStrings||(l+=x.encodeByte(null),l+=x.fixup(a.slice(i,r-1))),{type:U,value:l,line:t,lineStart:n,lastLine:C,lastLineStart:B,range:[_,r]}}function S(){var e=C,t=B,n=rt(!1);return n===!1&&m(s,h.expected,"[",re(s)),{type:U,value:x.discardStrings?null:x.fixup(n),line:e,lineStart:t,lastLine:C,lastLineStart:B,range:[_,r]}}function tt(){var e=a.charAt(r),t=a.charAt(r+1),n=e==="0"&&"xX".indexOf(t||null)>=0?mt():gt(),i=pt(),l=dt();return l&&(i||n.hasFractionPart)&&m(null,h.malformedNumber,a.slice(_,r)),{type:R,value:n.value,line:C,lineStart:B,range:[_,r]}}function pt(){if(c.imaginaryNumbers)return"iI".indexOf(a.charAt(r)||null)>=0?(++r,!0):!1}function dt(){if(c.integerSuffixes){if("uU".indexOf(a.charAt(r)||null)>=0)if(++r,"lL".indexOf(a.charAt(r)||null)>=0){if(++r,"lL".indexOf(a.charAt(r)||null)>=0)return++r,"ULL";m(null,h.malformedNumber,a.slice(_,r))}else m(null,h.malformedNumber,a.slice(_,r));else if("lL".indexOf(a.charAt(r)||null)>=0){if(++r,"lL".indexOf(a.charAt(r)||null)>=0)return++r,"LL";m(null,h.malformedNumber,a.slice(_,r))}}}function mt(){var e=0,t=1,n=1,i,l,b,k;for(k=r+=2,ve(a.charCodeAt(r))||m(null,h.malformedNumber,a.slice(_,r));ve(a.charCodeAt(r));)++r;i=parseInt(a.slice(k,r),16);var T=!1;if(a.charAt(r)==="."){for(T=!0,l=++r;ve(a.charCodeAt(r));)++r;e=a.slice(l,r),e=l===r?0:parseInt(e,16)/Math.pow(16,r-l)}var Be=!1;if("pP".indexOf(a.charAt(r)||null)>=0){for(Be=!0,++r,"+-".indexOf(a.charAt(r)||null)>=0&&(n=a.charAt(r++)==="+"?1:-1),b=r,oe(a.charCodeAt(r))||m(null,h.malformedNumber,a.slice(_,r));oe(a.charCodeAt(r));)++r;t=a.slice(b,r),t=Math.pow(2,t*n)}return{value:(i+e)*t,hasFractionPart:T||Be}}function gt(){for(;oe(a.charCodeAt(r));)++r;var e=!1;if(a.charAt(r)===".")for(e=!0,++r;oe(a.charCodeAt(r));)++r;var t=!1;if("eE".indexOf(a.charAt(r)||null)>=0)for(t=!0,++r,"+-".indexOf(a.charAt(r)||null)>=0&&++r,oe(a.charCodeAt(r))||m(null,h.malformedNumber,a.slice(_,r));oe(a.charCodeAt(r));)++r;return{value:parseFloat(a.slice(_,r)),hasFractionPart:e||t}}function vt(){var e=r++;for(a.charAt(r++)!=="{"&&m(null,h.braceExpected,"{","\\"+a.slice(e,r)),ve(a.charCodeAt(r))||m(null,h.hexadecimalDigitExpected,"\\"+a.slice(e,r));a.charCodeAt(r)===48;)++r;for(var t=r;ve(a.charCodeAt(r));)++r,r-t>6&&m(null,h.tooLargeCodepoint,"\\"+a.slice(e,r));var n=a.charAt(r++);n!=="}"&&(n==='"'||n==="'"?m(null,h.braceExpected,"}","\\"+a.slice(e,r--)):m(null,h.hexadecimalDigitExpected,"\\"+a.slice(e,r)));var i=parseInt(a.slice(t,r-1)||"0",16),l="\\"+a.slice(e,r);return i>1114111&&m(null,h.tooLargeCodepoint,l),x.encodeUTF8(i,l)}function ht(){var e=r;switch(a.charAt(r)){case"a":return++r,"\x07";case"n":return++r,`
`;case"r":return++r,"\r";case"t":return++r,"	";case"v":return++r,"\v";case"b":return++r,"\b";case"f":return++r,"\f";case"\r":case`
`:return se(),`
`;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;oe(a.charCodeAt(r))&&r-e<3;)++r;var t=a.slice(e,r),n=parseInt(t,10);return n>255&&m(null,h.decimalEscapeTooLarge,"\\"+n),x.encodeByte(n,"\\"+t);case"z":if(c.skipWhitespaceEscape)return++r,Ae(),"";break;case"x":if(c.hexEscapes){if(ve(a.charCodeAt(r+1))&&ve(a.charCodeAt(r+2)))return r+=3,x.encodeByte(parseInt(a.slice(e+1,r),16),"\\"+a.slice(e,r));m(null,h.hexadecimalDigitExpected,"\\"+a.slice(e,r+2))}break;case"u":if(c.unicodeEscapes)return vt();break;case"\\":case'"':case"'":return a.charAt(r++)}return c.strictEscapes&&m(null,h.invalidEscape,"\\"+a.slice(e,r+1)),a.charAt(r++)}function bt(){_=r,r+=2;var e=a.charAt(r),t="",n=!1,i=r,l=B,b=C;if(e==="["&&(t=rt(!0),t===!1?t=e:n=!0),!n){for(;r<D&&!Fe(a.charCodeAt(r));)++r;o.comments&&(t=a.slice(i,r))}if(o.comments){var k=g.comment(t,a.slice(_,r));o.locations&&(k.loc={start:{line:b,column:_-l},end:{line:C,column:r-B}}),o.ranges&&(k.range=[_,r]),o.onCreateNode&&o.onCreateNode(k),be.push(k)}}function rt(e){var t=0,n="",i=!1,l,b,k=C;for(++r;a.charAt(r+t)==="=";)++t;if(a.charAt(r+t)!=="[")return!1;for(r+=t+1,Fe(a.charCodeAt(r))&&se(),b=r;r<D;){for(;Fe(a.charCodeAt(r));)se();if(l=a.charAt(r++),l==="]"){i=!0;for(var T=0;T<t;++T)a.charAt(r+T)!=="="&&(i=!1);a.charAt(r+t)!=="]"&&(i=!1)}if(i)return n+=a.slice(b,r-1),r+=t+1,n}m(null,e?h.unfinishedLongComment:h.unfinishedLongString,k,"<eof>")}function E(){P=s,s=Q,Q=we()}function F(e){return e===s.value?(E(),!0):!1}function A(e){e===s.value?E():m(s,h.expected,e,re(s))}function yt(e){return e===9||e===32||e===11||e===12}function Fe(e){return e===10||e===13}function oe(e){return e>=48&&e<=57}function ve(e){return e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70}function St(e){return!!(e>=65&&e<=90||e>=97&&e<=122||e===95||c.extendedIdentifiers&&e>=128)}function xt(e){return!!(e>=65&&e<=90||e>=97&&e<=122||e===95||e>=48&&e<=57||c.extendedIdentifiers&&e>=128)}function kt(e){switch(e.length){case 2:return e==="do"||e==="if"||e==="in"||e==="or";case 3:return e==="and"||e==="end"||e==="for"||e==="not";case 4:return e==="else"||e==="then"?!0:c.labels&&!c.contextualGoto?e==="goto":!1;case 5:return e==="break"||e==="local"||e==="until"||e==="while";case 6:return e==="elseif"||e==="repeat"||e==="return";case 8:return e==="function"}return!1}function Et(e){return W===e.type?"#-~".indexOf(e.value)>=0:J===e.type?e.value==="not":!1}function Lt(e){if(le===e.type)return!0;if(J!==e.type)return!1;switch(e.value){case"else":case"elseif":case"end":case"until":return!0;default:return!1}}var he,ye,Te;function H(){var e=he[ye++].slice();he.push(e),o.onCreateScope&&o.onCreateScope()}function Y(){he.pop(),--ye,o.onDestroyScope&&o.onDestroyScope()}function qe(e){o.onLocalDeclaration&&o.onLocalDeclaration(e),Le(he[ye],e)===-1&&he[ye].push(e)}function _e(e){qe(e.name),Ve(e,!0)}function Ve(e,t){!t&&f(Te,"name",e.name)===-1&&Te.push(e),e.isLocal=t}function ze(e){return Le(he[ye],e)!==-1}var z=[],$;function ne(){return new Ue(s)}function Ue(e){o.locations&&(this.loc={start:{line:e.line,column:e.range[0]-e.lineStart},end:{line:0,column:0}}),o.ranges&&(this.range=[e.range[0],0])}Ue.prototype.complete=function(){o.locations&&(this.loc.end.line=P.lastLine||P.line,this.loc.end.column=P.range[1]-(P.lastLineStart||P.lineStart)),o.ranges&&(this.range[1]=P.range[1])},Ue.prototype.bless=function(e){if(this.loc){var t=this.loc;e.loc={start:{line:t.start.line,column:t.start.column},end:{line:t.end.line,column:t.end.column}}}this.range&&(e.range=[this.range[0],this.range[1]])};function Se(){$&&z.push(ne())}function j(e){$&&z.push(e)}function ae(){this.scopes=[],this.pendingGotos=[]}ae.prototype.isInLoop=function(){for(var e=this.scopes.length;e-- >0;)if(this.scopes[e].isLoop)return!0;return!1},ae.prototype.pushScope=function(e){var t={labels:{},locals:[],deferredGotos:[],isLoop:!!e};this.scopes.push(t)},ae.prototype.popScope=function(){for(var e=0;e<this.pendingGotos.length;++e){var t=this.pendingGotos[e];t.maxDepth>=this.scopes.length&&--t.maxDepth<=0&&m(t.token,h.labelNotVisible,t.target)}this.scopes.pop()},ae.prototype.addGoto=function(e,t){for(var n=[],i=0;i<this.scopes.length;++i){var l=this.scopes[i];if(n.push(l.locals.length),Object.prototype.hasOwnProperty.call(l.labels,e))return}this.pendingGotos.push({maxDepth:this.scopes.length,target:e,token:t,localCounts:n})},ae.prototype.addLabel=function(e,t){var n=this.currentScope();if(Object.prototype.hasOwnProperty.call(n.labels,e))m(t,h.labelAlreadyDefined,e,n.labels[e].line);else{for(var i=[],l=0;l<this.pendingGotos.length;++l){var b=this.pendingGotos[l];if(b.maxDepth>=this.scopes.length&&b.target===e){b.localCounts[this.scopes.length-1]<n.locals.length&&n.deferredGotos.push(b);continue}i.push(b)}this.pendingGotos=i}n.labels[e]={localCount:n.locals.length,line:t.line}},ae.prototype.addLocal=function(e,t){this.currentScope().locals.push({name:e,token:t})},ae.prototype.currentScope=function(){return this.scopes[this.scopes.length-1]},ae.prototype.raiseDeferredErrors=function(){for(var e=this.currentScope(),t=e.deferredGotos,n=0;n<t.length;++n){var i=t[n];m(i.token,h.gotoJumpInLocalScope,i.target,e.locals[i.localCounts[this.scopes.length-1]].name)}};function ue(){this.level=0,this.loopLevels=[]}ue.prototype.isInLoop=function(){return!!this.loopLevels.length},ue.prototype.pushScope=function(e){++this.level,e&&this.loopLevels.push(this.level)},ue.prototype.popScope=function(){var e=this.loopLevels,t=e.length;t&&e[t-1]===this.level&&e.pop(),--this.level},ue.prototype.addGoto=ue.prototype.addLabel=function(){throw new Error("This should never happen")},ue.prototype.addLocal=ue.prototype.raiseDeferredErrors=function(){};function nt(){return c.labels?new ae:new ue}function wt(){E(),Se(),o.scope&&H();var e=nt();e.allowVararg=!0,e.pushScope();var t=Z(e);return e.popScope(),o.scope&&Y(),le!==s.type&&X(s),$&&!t.length&&(P=s),v(g.chunk(t))}function Z(e){for(var t=[],n;!Lt(s);){if(s.value==="return"||!c.relaxedBreak&&s.value==="break"){t.push(at(e));break}n=at(e),F(";"),n&&t.push(n)}return t}function at(e){if(Se(),W===s.type&&F("::"))return At(e);if(c.emptyStatement&&F(";")){$&&z.pop();return}if(e.raiseDeferredErrors(),J===s.type)switch(s.value){case"local":return E(),It(e);case"if":return E(),Nt(e);case"return":return E(),Ot(e);case"function":E();var t=Ut();return We(t);case"while":return E(),Vt(e);case"for":return E(),Dt(e);case"repeat":return E(),Ct(e);case"break":return E(),e.isInLoop()||m(s,h.noLoopToBreak,s.value),Ft();case"do":return E(),_t(e);case"goto":return E(),it(e)}return c.contextualGoto&&s.type===q&&s.value==="goto"&&Q.type===q&&Q.value!=="goto"?(E(),it(e)):($&&z.pop(),Tt(e))}function At(e){var t=s,n=G();return o.scope&&(qe("::"+t.value+"::"),Ve(n,!0)),A("::"),e.addLabel(t.value,t),v(g.labelStatement(n))}function Ft(){return v(g.breakStatement())}function it(e){var t=s.value,n=P,i=G();return e.addGoto(t,n),v(g.gotoStatement(i))}function _t(e){o.scope&&H(),e.pushScope();var t=Z(e);return e.popScope(),o.scope&&Y(),A("end"),v(g.doStatement(t))}function Vt(e){var t=I(e);A("do"),o.scope&&H(),e.pushScope(!0);var n=Z(e);return e.popScope(),o.scope&&Y(),A("end"),v(g.whileStatement(t,n))}function Ct(e){o.scope&&H(),e.pushScope(!0);var t=Z(e);A("until"),e.raiseDeferredErrors();var n=I(e);return e.popScope(),o.scope&&Y(),v(g.repeatStatement(n,t))}function Ot(e){var t=[];if(s.value!=="end"){var n=$e(e);for(n!=null&&t.push(n);F(",");)n=I(e),t.push(n);F(";")}return v(g.returnStatement(t))}function Nt(e){var t=[],n,i,l;for($&&(l=z[z.length-1],z.push(l)),n=I(e),A("then"),o.scope&&H(),e.pushScope(),i=Z(e),e.popScope(),o.scope&&Y(),t.push(v(g.ifClause(n,i))),$&&(l=ne());F("elseif");)j(l),n=I(e),A("then"),o.scope&&H(),e.pushScope(),i=Z(e),e.popScope(),o.scope&&Y(),t.push(v(g.elseifClause(n,i))),$&&(l=ne());return F("else")&&($&&(l=new Ue(P),z.push(l)),o.scope&&H(),e.pushScope(),i=Z(e),e.popScope(),o.scope&&Y(),t.push(v(g.elseClause(i)))),A("end"),v(g.ifStatement(t))}function Dt(e){var t=G(),n;if(o.scope&&(H(),_e(t)),F("=")){var i=I(e);A(",");var l=I(e),b=F(",")?I(e):null;return A("do"),e.pushScope(!0),n=Z(e),e.popScope(),A("end"),o.scope&&Y(),v(g.forNumericStatement(t,i,l,b,n))}else{for(var k=[t];F(",");)t=G(),o.scope&&_e(t),k.push(t);A("in");var T=[];do{var Be=I(e);T.push(Be)}while(F(","));return A("do"),e.pushScope(!0),n=Z(e),e.popScope(),A("end"),o.scope&&Y(),v(g.forGenericStatement(k,T,n))}}function It(e){var t,n=P;if(q===s.type){var i=[],l=[];do t=G(),i.push(t),e.addLocal(t.name,n);while(F(","));if(F("="))do{var b=I(e);l.push(b)}while(F(","));if(o.scope)for(var k=0,T=i.length;k<T;++k)_e(i[k]);return v(g.localStatement(i,l))}if(F("function"))return t=G(),e.addLocal(t.name,n),o.scope&&(_e(t),H()),We(t,!0);K("<name>",s)}function Tt(e){var t,n,i,l,b,k=[];$&&(n=ne());do{if($&&(t=ne()),q===s.type)b=s.value,l=G(),o.scope&&Ve(l,ze(b)),i=!0;else if(s.value==="(")E(),l=I(e),A(")"),i=!1;else return X(s);e:for(;;){switch(U===s.type?'"':s.value){case".":case"[":i=!0;break;case":":case"(":case"{":case'"':i=null;break;default:break e}l=st(l,t,e)}if(k.push(l),s.value!==",")break;if(!i)return X(s);E()}while(!0);if(k.length===1&&i===null)return j(t),v(g.callStatement(k[0]));if(!i)return X(s);A("=");var T=[];do T.push(I(e));while(F(","));return j(n),v(g.assignmentStatement(k,T))}function G(){Se();var e=s.value;return q!==s.type&&K("<name>",s),E(),v(g.identifier(e))}function We(e,t){var n=nt();n.pushScope();var i=[];if(A("("),!F(")"))for(;;){if(q===s.type){var l=G();if(o.scope&&_e(l),i.push(l),F(","))continue}else ge===s.type?(n.allowVararg=!0,i.push(Je(n))):K("<name> or '...'",s);A(")");break}var b=Z(n);return n.popScope(),A("end"),o.scope&&Y(),t=t||!1,v(g.functionStatement(e,i,t,b))}function Ut(){var e,t,n;for($&&(n=ne()),e=G(),o.scope&&(Ve(e,ze(e.name)),H());F(".");)j(n),t=G(),e=v(g.memberExpression(e,".",t));return F(":")&&(j(n),t=G(),e=v(g.memberExpression(e,":",t)),o.scope&&qe("self")),e}function lt(e){for(var t=[],n,i;;){if(Se(),W===s.type&&F("["))n=I(e),A("]"),A("="),i=I(e),t.push(v(g.tableKey(n,i)));else if(q===s.type)Q.value==="="?(n=G(),E(),i=I(e),t.push(v(g.tableKeyString(n,i)))):(i=I(e),t.push(v(g.tableValue(i))));else{if((i=$e(e))==null){z.pop();break}t.push(v(g.tableValue(i)))}if(",;".indexOf(s.value)>=0){E();continue}break}return A("}"),v(g.tableConstructorExpression(t))}function $e(e){var t=Ke(0,e);return t}function I(e){var t=$e(e);if(t==null)K("<expression>",s);else return t}function $t(e){var t=e.charCodeAt(0),n=e.length;if(n===1)switch(t){case 94:return 12;case 42:case 47:case 37:return 10;case 43:case 45:return 9;case 38:return 6;case 126:return 5;case 124:return 4;case 60:case 62:return 3}else if(n===2)switch(t){case 47:return 10;case 46:return 8;case 60:case 62:return e==="<<"||e===">>"?7:3;case 61:case 126:return 3;case 111:return 1}else if(t===97&&e==="and")return 2;return 0}function Ke(e,t){var n=s.value,i,l;if($&&(l=ne()),Et(s)){Se(),E();var b=Ke(10,t);b==null&&K("<expression>",s),i=v(g.unaryExpression(n,b))}if(i==null&&(i=Je(t),i==null&&(i=Bt(t))),i==null)return null;for(var k;n=s.value,k=W===s.type||J===s.type?$t(n):0,!(k===0||k<=e);){(n==="^"||n==="..")&&--k,E();var T=Ke(k,t);T==null&&K("<expression>",s),$&&z.push(l),i=v(g.binaryExpression(n,i,T))}return i}function st(e,t,n){var i,l;if(W===s.type)switch(s.value){case"[":return j(t),E(),i=I(n),A("]"),v(g.indexExpression(e,i));case".":return j(t),E(),l=G(),v(g.memberExpression(e,".",l));case":":return j(t),E(),l=G(),e=v(g.memberExpression(e,":",l)),j(t),He(e,n);case"(":case"{":return j(t),He(e,n)}else if(U===s.type)return j(t),He(e,n);return null}function Bt(e){var t,n,i;if($&&(i=ne()),q===s.type)n=s.value,t=G(),o.scope&&Ve(t,ze(n));else if(F("("))t=I(e),A(")");else return null;for(;;){var l=st(t,i,e);if(l===null)break;t=l}return t}function He(e,t){if(W===s.type)switch(s.value){case"(":c.emptyStatement||s.line!==P.line&&m(null,h.ambiguousSyntax,s.value),E();var n=[],i=$e(t);for(i!=null&&n.push(i);F(",");)i=I(t),n.push(i);return A(")"),v(g.callExpression(e,n));case"{":Se(),E();var l=lt(t);return v(g.tableCallExpression(e,l))}else if(U===s.type)return v(g.stringCallExpression(e,Je(t)));K("function arguments",s)}function Je(e){var t=U|R|me|M|ge,n=s.value,i=s.type,l;if($&&(l=ne()),i===ge&&!e.allowVararg&&m(s,h.cannotUseVararg,s.value),i&t){j(l);var b=a.slice(s.range[0],s.range[1]);return E(),v(g.literal(i,n,b))}else{if(J===i&&n==="function")return j(l),E(),o.scope&&H(),We(null);if(F("{"))return j(l),lt(e)}}L.parse=Rt;var ot={"5.1":{},"5.2":{labels:!0,emptyStatement:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0,relaxedBreak:!0},"5.3":{labels:!0,emptyStatement:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0,unicodeEscapes:!0,bitwiseOperators:!0,integerDivision:!0,relaxedBreak:!0},LuaJIT:{labels:!0,contextualGoto:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0,unicodeEscapes:!0,imaginaryNumbers:!0,integerSuffixes:!0}};function Rt(e,t){if(typeof t>"u"&&typeof e=="object"&&(t=e,e=void 0),t||(t={}),a=e||"",o=te({},ke,t),r=0,C=1,B=0,D=a.length,he=[[]],ye=0,Te=[],z=[],!Object.prototype.hasOwnProperty.call(ot,o.luaVersion))throw new Error(p("Lua version '%1' not supported",o.luaVersion));if(c=te({},ot[o.luaVersion]),o.extendedIdentifiers!==void 0&&(c.extendedIdentifiers=!!o.extendedIdentifiers),!Object.prototype.hasOwnProperty.call(De,o.encodingMode))throw new Error(p("Encoding mode '%1' not supported",o.encodingMode));return x=De[o.encodingMode],o.comments&&(be=[]),o.wait?L:ct()}L.write=ut;function ut(e){return a+=String(e),D=a.length,L}L.end=ct;function ct(e){typeof e<"u"&&ut(e),a&&a.substr(0,2)==="#!"&&(a=a.replace(/^.*/,function(n){return n.replace(/./g," ")})),D=a.length,$=o.locations||o.ranges,Q=we();var t=wt();if(o.comments&&(t.comments=be),o.scope&&(t.globals=Te),z.length>0)throw new Error("Location tracking failed. This is most likely a bug in luaparse");return t}})})(Me,Me.exports);var Ht=Me.exports;const et=Mt(Ht),Jt={class:"page-div"},Xt={class:"el-form-item-msg"},Qt={style:{display:"flex","justify-content":"flex-end"}},Yt=Kt({name:"settingsRoom"}),rr=Object.assign(Yt,{setup(Ce){const{t:N}=Gt();Pt(()=>{h()});const L=ee(!1),{isMobile:a}=jt(),o=qt(),D=zt(()=>o.isDark),c=ee(0),x=f=>{c.value>f&&(c.value=f)},ke=()=>{c.value--},Oe=()=>{if(c.value===0)Ne.value.validate(f=>{f&&c.value++});else if(c.value===1)le.value.validate(f=>{if(f)try{et.parse(U.value.groundSetting),c.value++}catch{Qe(N("setting.luaError"))}});else if(c.value===2)if(R.value)try{et.parse(R.value.caveSetting),c.value++}catch{Qe(N("setting.luaError"))}else c.value++;else if(c.value===3)if(M.value)try{et.parse(M.value.modSetting),c.value++}catch{Qe(N("setting.luaError"))}else c.value++},Ne=ee(),w=ee({name:"",description:"",gameMode:"",pvp:!1,playerNum:6,backDays:10,vote:!0,password:"",token:""}),De={name:[{required:!0,message:N("setting.roomBaseFormRules.name"),trigger:"blur"}],token:[{required:!0,message:N("setting.roomBaseFormRules.token"),trigger:"blur"}]},le=ee(),U=ee({groundSetting:""}),J={groundSetting:[{required:!0,message:N("setting.roomGroundFormRules.groundSetting"),trigger:"blur"}]},q=ee(),R=ee({caveSetting:""}),W={caveSetting:[{required:!0,message:N("setting.roomCaveFormRules.caveSetting"),trigger:"blur"}]},me=ee(),M=ee({modSetting:""}),ge={modSetting:[{required:!0,message:N("setting.roomModFormRules.modSetting"),trigger:"blur"}]},h=()=>{Re.room.get().then(f=>{w.value=f.data.base,U.value.groundSetting=f.data.ground,R.value.caveSetting=f.data.cave,M.value.modSetting=f.data.mod})},g=f=>{switch(f){case"save":v();break;case"saveAndRestart":Ee();break;case"generateNewWorld":Le();break}},v=()=>{const f={base:w.value,ground:U.value.groundSetting,cave:R.value.caveSetting,mod:M.value.modSetting};L.value=!0,Re.save.post(f).then(p=>{Ye(p.message),L.value=!1}).finally(()=>{L.value=!1})},Ee=()=>{const f={base:w.value,ground:U.value.groundSetting,cave:R.value.caveSetting,mod:M.value.modSetting};L.value=!0,Re.saveAndRestart.post(f).then(p=>{Ye(p.message),L.value=!1}).finally(()=>{L.value=!1})},Le=()=>{const f={base:w.value,ground:U.value.groundSetting,cave:R.value.caveSetting,mod:M.value.modSetting};L.value=!0,Re.saveAndGenerate.post(f).then(p=>{L.value=!1,Ye(p.message)}).finally(()=>{L.value=!1})};return(f,p)=>{const te=O("el-step"),Ie=O("el-steps"),m=O("el-card"),re=O("el-col"),K=O("el-row"),X=O("el-input"),r=O("el-form-item"),s=O("el-radio"),P=O("el-radio-group"),Q=O("el-switch"),be=O("el-slider"),_=O("el-link"),C=O("el-form"),B=O("el-alert"),we=O("el-result"),se=O("el-button"),Ae=O("arrow-down"),Ge=O("el-icon"),V=O("el-dropdown-item"),Pe=O("el-dropdown-menu"),je=O("el-dropdown");return ie(),Wt("div",Jt,[u(K,{gutter:10},{default:d(()=>[u(re,{span:24,lg:24,md:24,sm:24,xs:24,style:{"margin-top":"10px"}},{default:d(()=>[u(m,{shadow:"never"},{default:d(()=>[u(Ie,{active:c.value,"align-center":"","finish-status":"success"},{default:d(()=>[u(te,{onClick:p[0]||(p[0]=S=>x(0)),title:y(a)?f.$t("setting.roomSettingMobile"):f.$t("setting.roomSetting")},null,8,["title"]),u(te,{onClick:p[1]||(p[1]=S=>x(1)),title:y(a)?f.$t("setting.groundSettingMobile"):f.$t("setting.groundSetting")},null,8,["title"]),u(te,{onClick:p[2]||(p[2]=S=>x(2)),title:y(a)?f.$t("setting.caveSettingMobile"):f.$t("setting.caveSetting")},null,8,["title"]),u(te,{onClick:p[3]||(p[3]=S=>x(3)),title:y(a)?f.$t("setting.modSettingMobile"):f.$t("setting.modSetting")},null,8,["title"]),u(te,{onClick:p[4]||(p[4]=S=>x(4)),title:y(a)?f.$t("setting.finishSettingMobile"):f.$t("setting.finishSetting")},null,8,["title"])]),_:1},8,["active"])]),_:1})]),_:1})]),_:1}),u(K,{gutter:10,style:{"margin-top":"5px"}},{default:d(()=>[u(re,{span:24,lg:24,md:24,sm:24,xs:24},{default:d(()=>[c.value===0?(ie(),ce(m,{key:0,shadow:"never",style:xe(y(a)?"min-height: 400px":"min-height: 600px")},{default:d(()=>[u(C,{ref_key:"roomBaseFormRef",ref:Ne,"label-position":y(a)?"top":"left",model:w.value,rules:De,"label-width":y(a)?"70":"auto",size:y(a)?"small":"large"},{default:d(()=>[u(r,{label:f.$t("setting.baseForm.room"),prop:"name"},{default:d(()=>[u(X,{modelValue:w.value.name,"onUpdate:modelValue":p[5]||(p[5]=S=>w.value.name=S)},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:f.$t("setting.baseForm.description"),prop:"description"},{default:d(()=>[u(X,{modelValue:w.value.description,"onUpdate:modelValue":p[6]||(p[6]=S=>w.value.description=S)},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:f.$t("setting.baseForm.gameMode.name"),prop:"gameMode"},{default:d(()=>[u(P,{modelValue:w.value.gameMode,"onUpdate:modelValue":p[7]||(p[7]=S=>w.value.gameMode=S)},{default:d(()=>[u(s,{label:f.$t("setting.baseForm.gameMode.endless"),value:"endless"},null,8,["label"]),u(s,{label:f.$t("setting.baseForm.gameMode.survival"),value:"survival"},null,8,["label"]),u(s,{label:f.$t("setting.baseForm.gameMode.lavaarena"),value:"lavaarena"},null,8,["label"]),u(s,{label:f.$t("setting.baseForm.gameMode.quagmire"),value:"quagmire"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),u(r,{label:f.$t("setting.baseForm.pvp"),prop:"pvp"},{default:d(()=>[u(Q,{modelValue:w.value.pvp,"onUpdate:modelValue":p[8]||(p[8]=S=>w.value.pvp=S)},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:f.$t("setting.baseForm.playerNum"),prop:"playerNum"},{default:d(()=>[u(be,{modelValue:w.value.playerNum,"onUpdate:modelValue":p[9]||(p[9]=S=>w.value.playerNum=S),size:"small","show-input":"",min:2,max:100},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:f.$t("setting.baseForm.backDays"),prop:"backDays"},{default:d(()=>[u(be,{modelValue:w.value.backDays,"onUpdate:modelValue":p[10]||(p[10]=S=>w.value.backDays=S),size:"small","show-input":"",min:5,max:50},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:f.$t("setting.baseForm.vote"),prop:"vote"},{default:d(()=>[u(Q,{modelValue:w.value.vote,"onUpdate:modelValue":p[11]||(p[11]=S=>w.value.vote=S)},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:f.$t("setting.baseForm.password")},{default:d(()=>[u(X,{modelValue:w.value.password,"onUpdate:modelValue":p[12]||(p[12]=S=>w.value.password=S)},null,8,["modelValue"])]),_:1},8,["label"]),u(r,{label:f.$t("setting.baseForm.token"),prop:"token"},{default:d(()=>[u(X,{modelValue:w.value.token,"onUpdate:modelValue":p[13]||(p[13]=S=>w.value.token=S),"show-password":""},null,8,["modelValue"]),ft("div",Xt,[u(_,{underline:!1,target:"_blank",href:"https://accounts.klei.com"},{default:d(()=>[fe(pe(y(N)("setting.baseForm.tokenHelp")),1)]),_:1})])]),_:1},8,["label"])]),_:1},8,["label-position","model","label-width","size"])]),_:1},8,["style"])):de("",!0),c.value===1?(ie(),ce(m,{key:1,shadow:"never",style:xe(y(a)?"min-height: 400px":"min-height: 600px")},{default:d(()=>[u(C,{ref_key:"roomGroundFormRef",ref:le,model:U.value,rules:J,"label-width":y(a)?"70":"100",size:y(a)?"small":"large"},{default:d(()=>[u(r,{"label-position":"top",prop:"groundSetting"},{default:d(()=>[u(Ze,{ref:"editor",modelValue:U.value.groundSetting,"onUpdate:modelValue":p[14]||(p[14]=S=>U.value.groundSetting=S),mode:"lua",theme:D.value?"darcula":"idea",height:y(a)?320:500,style:{width:"100%"}},null,8,["modelValue","theme","height"])]),_:1})]),_:1},8,["model","label-width","size"])]),_:1},8,["style"])):de("",!0),c.value===2?(ie(),ce(m,{key:2,shadow:"never",style:xe(y(a)?"min-height: 400px":"min-height: 600px")},{default:d(()=>[u(B,{effect:D.value?"light":"dark",type:"success",closable:!1},{default:d(()=>[fe(pe(y(N)("setting.cavesTip")),1)]),_:1},8,["effect"]),u(C,{ref_key:"roomCaveFormRef",ref:q,model:R.value,rules:W,"label-width":y(a)?"70":"100",size:y(a)?"small":"large",style:{"margin-top":"10px"}},{default:d(()=>[u(r,{"label-position":"top",prop:"caveSetting"},{default:d(()=>[u(Ze,{ref:"editor",modelValue:R.value.caveSetting,"onUpdate:modelValue":p[15]||(p[15]=S=>R.value.caveSetting=S),mode:"lua",theme:D.value?"darcula":"idea",height:y(a)?320:500,style:{width:"100%"}},null,8,["modelValue","theme","height"])]),_:1})]),_:1},8,["model","label-width","size"])]),_:1},8,["style"])):de("",!0),c.value===3?(ie(),ce(m,{key:3,shadow:"never",style:xe(y(a)?"min-height: 400px":"min-height: 600px")},{default:d(()=>[u(C,{ref_key:"roomModFormRef",ref:me,model:M.value,rules:ge,"label-width":y(a)?"70":"100",size:y(a)?"small":"large"},{default:d(()=>[u(r,{"label-position":"top",prop:"modSetting"},{default:d(()=>[u(Ze,{ref:"editor",modelValue:M.value.modSetting,"onUpdate:modelValue":p[16]||(p[16]=S=>M.value.modSetting=S),mode:"lua",theme:D.value?"darcula":"idea",height:y(a)?320:500,style:{width:"100%"}},null,8,["modelValue","theme","height"])]),_:1})]),_:1},8,["model","label-width","size"])]),_:1},8,["style"])):de("",!0),c.value===4?(ie(),ce(m,{key:4,shadow:"never",style:xe(y(a)?"min-height: 400px":"min-height: 600px")},{default:d(()=>[u(we,{icon:"success",title:f.$t("setting.finish.title"),"sub-title":f.$t("setting.finish.description"),style:xe(y(a)?"margin-top: 20%":"margin-top: 15%")},null,8,["title","sub-title","style"])]),_:1},8,["style"])):de("",!0)]),_:1})]),_:1}),u(K,{gutter:10},{default:d(()=>[u(re,{span:24,lg:24,md:24,sm:24,xs:24},{default:d(()=>[u(m,{shadow:"never"},{default:d(()=>[ft("div",Qt,[c.value>0?(ie(),ce(se,{key:0,onClick:ke},{default:d(()=>[fe(pe(y(N)("setting.button.prev")),1)]),_:1})):de("",!0),c.value<4?(ie(),ce(se,{key:1,type:"primary",onClick:Oe},{default:d(()=>[fe(pe(y(N)("setting.button.next")),1)]),_:1})):de("",!0),c.value===4?(ie(),ce(je,{key:2,onCommand:g,trigger:"click",style:{"margin-left":"12px"}},{dropdown:d(()=>[u(Pe,null,{default:d(()=>[u(V,{command:"save"},{default:d(()=>[fe(pe(y(N)("setting.button.save")),1)]),_:1}),u(V,{command:"saveAndRestart"},{default:d(()=>[fe(pe(y(N)("setting.button.saveAndRestart")),1)]),_:1}),u(V,{command:"generateNewWorld"},{default:d(()=>[fe(pe(y(N)("setting.button.generateNewWorld")),1)]),_:1})]),_:1})]),default:d(()=>[u(se,{type:"warning",loading:L.value},{default:d(()=>[fe(pe(y(N)("setting.button.actions")),1),u(Ge,{class:"el-icon--right"},{default:d(()=>[u(Ae)]),_:1})]),_:1},8,["loading"])]),_:1})):de("",!0)])]),_:1})]),_:1})]),_:1})])}}});export{rr as default};
