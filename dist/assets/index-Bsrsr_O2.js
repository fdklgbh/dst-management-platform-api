import{o as F,u as G,g as H,G as J,H as O,b as Q,I as U,c as D,r as f,a2 as v,w as X,J as K,K as _,L as Y,e as m,f as j,l as x,t as n,i as r,n as M,m as h,k as e,j as s,p as i,q as Z,a1 as ee,E as te,B as le,C as se}from"./index-7NUCbB-L.js";const ae={class:"page-div"},oe={class:"tip_warning"},re={class:"tip_success",style:{"margin-top":"20px"}},ne={class:"fcc",style:{"font-size":"20px"}},ce={key:0},ue=ee({name:"Clusters"}),fe=Object.assign(ue,{setup(ie){F(()=>{T(),L()});const{t:l}=G(),u=H(),p=J();O();const P=Q(),B=U("refresh"),V=D(()=>u.isDark),b=D(()=>u.language),y=f(!1),w=f(!1),z=D(()=>y.value||w.value),S=f([]),T=()=>{y.value=!0,v.clusters.get().then(c=>{S.value=c.data}).finally(()=>{y.value=!1})},C=f([]),A=f(0),E=f(0),L=()=>{w.value=!0,v.clustersWorldPort.get().then(c=>{C.value=c.data;let d=[];for(let a of C.value)if(a.worldPort!==null)for(let o of a.worldPort)d.push(o);A.value=d.length,E.value=new Set(d).size}).finally(()=>{w.value=!1})},q=()=>{v.clusters.get().then(c=>{u.dstClusters=c.data,u.selectedDstCluster===null&&u.dstClusters!==null&&(u.selectedDstCluster=u.dstClusters[0].clusterName)})},R=c=>{te.confirm(b.value==="zh"?"将执行 删除集群 操作，是否继续？":"The cluster DELETE operation will be performed. Do you want to continue?",b.value==="zh"?"请确认您的操作":"Please confirm your operation",{confirmButtonText:b.value==="zh"?"确定":"confirm",cancelButtonText:b.value==="zh"?"取消":"cancel",type:"warning",beforeClose:(d,a,o)=>{if(d==="confirm"){a.confirmButtonLoading=!0;const N={clusterName:c};v.cluster.delete(N).then(g=>{le(g.message),T(),L(),q(),o()}).catch(()=>{}).finally(()=>{a.confirmButtonLoading=!1})}else o()}}).then(()=>{}).catch(()=>{se(l("home.canceled"))})},W=()=>{setTimeout(()=>{p.meta.isKeepAlive&&P.removeKeepAliveName(p.name),B(!1),K(()=>{p.meta.isKeepAlive&&P.addKeepAliveName(p.name),B(!0)})},0)};return X(()=>u.selectedDstCluster,c=>{c&&K(()=>{W()})},{immediate:!1}),(c,d)=>{const a=_("el-tag"),o=_("el-table-column"),N=_("el-button"),g=_("el-table"),$=_("el-alert"),I=Y("loading");return m(),j("div",ae,[x("div",oe,n(r(l)("clusters.tip1")),1),M((m(),h(g,{data:S.value,border:""},{default:e(()=>[s(o,{label:r(l)("clusters.table.name")},{default:e(t=>[s(a,{type:"primary"},{default:e(()=>[i(n(t.row.clusterName),1)]),_:2},1024)]),_:1},8,["label"]),s(o,{label:r(l)("clusters.table.displayName")},{default:e(t=>[s(a,{type:"success"},{default:e(()=>[i(n(t.row.clusterDisplayName),1)]),_:2},1024)]),_:1},8,["label"]),s(o,{label:r(l)("clusters.table.world")},{default:e(t=>[s(a,{type:"info"},{default:e(()=>{var k;return[i(n(((k=t.row.worlds)==null?void 0:k.length)||0),1)]}),_:2},1024)]),_:1},8,["label"]),s(o,{label:r(l)("clusters.table.actions")},{default:e(t=>[s(N,{size:"small",type:"danger",onClick:k=>R(t.row.clusterName)},{default:e(()=>[i(n(r(l)("clusters.table.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[I,z.value]]),x("div",re,n(r(l)("clusters.tip2")),1),E.value!==A.value?(m(),h($,{key:0,effect:V.value?"light":"dark",type:"error",closable:!1,style:{"margin-bottom":"10px"}},{title:e(()=>[x("div",ne,n(r(l)("clusters.tip3")),1)]),_:1},8,["effect"])):Z("",!0),M((m(),h(g,{data:C.value,border:""},{default:e(()=>[s(o,{label:r(l)("clusters.table.name")},{default:e(t=>[s(a,{type:"primary"},{default:e(()=>[i(n(t.row.clusterName),1)]),_:2},1024)]),_:1},8,["label"]),s(o,{label:r(l)("clusters.table.displayName")},{default:e(t=>[s(a,{type:"success"},{default:e(()=>[i(n(t.row.clusterDisplayName),1)]),_:2},1024)]),_:1},8,["label"]),s(o,{label:r(l)("clusters.table.port")},{default:e(t=>[t.row.worldPort?(m(),j("span",ce,n(t.row.worldPort.join(", ")),1)):(m(),h(a,{key:1,type:"info"},{default:e(()=>[i(n(r(l)("clusters.table.none")),1)]),_:1}))]),_:1},8,["label"])]),_:1},8,["data"])),[[I,z.value]])])}}});export{fe as default};
