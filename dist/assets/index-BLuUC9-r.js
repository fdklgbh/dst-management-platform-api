import{h as B,_ as Be,o as Ee,u as Le,a as De,g as Ue,c as pe,E as Pe,r as v,b as Ae,d as p,e as J,f as l,w as e,i as _,t as n,j as t,k as g,l as N,m as u,n as w,p as fe,q as ve,s as Me,F as Fe,v as Re,x as Ne,y as Q,z as qe,A as X,B as m,C as ge}from"./index-CcJ6F69l.js";import{e as Y}from"./index-QSJXlzNi.js";const $={roomInfo:{url:"/home/room_info",get:async function(y){return await B.get(this.url,y)}},sysInfo:{url:"/home/sys_info",get:async function(y){return await B.get(this.url,y)}},exec:{url:"/home/exec",post:async function(y){return await B.post(this.url,y)}},interface:{announce:{url:"/home/announce",post:async function(y){return await B.post(this.url,y)}},console:{url:"/home/console",post:async function(y){return await B.post(this.url,y)}}}},Ke={class:"page-div"},Ge={class:"card-header"},Oe={key:1,class:"fcc",style:{height:"150px"}},je={class:"card-header"},He={class:"fcc"},We={class:"percentage-value"},Je={class:"percentage-value"},Qe={class:"percentage-label"},Xe={class:"card-header"},Ye={class:"card-header"},Ze={__name:"index",setup(y){Ee(()=>{he(),be(),_e(),ye(),we()});const{t:o}=Le(),{isMobile:x}=De(),E=Ue();pe(()=>E.isDark);const h=pe(()=>E.language),he=()=>{E.needUpdatePassword&&(Pe({title:o("home.updatePasswordTitle"),message:o("home.updatePassword"),type:"warning"}),E.needUpdatePassword=!1)};v(!1);const q=v(!1),K=v(!1),V=v({server:0,local:0}),L=v(""),_e=()=>{q.value=!0,Y.dstVersion.get().then(d=>{V.value=d.data}).finally(()=>{q.value=!1})},ye=()=>{K.value=!0,Y.connectionCode.get().then(d=>{L.value=d.data}).finally(()=>{K.value=!1})},c=v({roomSettingBase:{},seasonInfo:{season:{},cycles:0,elapsedDays:0,seasonLength:{summer:15,autumn:20,spring:20,winter:15},phase:{}},modsCount:0}),be=()=>{$.roomInfo.get().then(d=>{c.value=d.data})},Z=d=>c.value.seasonInfo.cycles>-1?`(${c.value.seasonInfo.elapsedDays}/${c.value.seasonInfo.seasonLength[d]})`:"",r=v({cpu:0,memory:0,master:0,caves:0}),ke=()=>{$.sysInfo.get().then(d=>{r.value=d.data})},ee=[{color:"#5cb87a",percentage:20},{color:"#1989fa",percentage:40},{color:"#e6a23c",percentage:60},{color:"#f56c6c",percentage:80},{color:"#6f7ad3",percentage:100}];let D=null;const we=()=>{D=setInterval(()=>{!U.value&&!P.value&&ke()},2e3)},le=()=>{D&&(clearInterval(D),D=null)},U=v(!1),P=v(!1),ae=d=>{if(r.value.master,d==="master"){const a={type:"masterSwitch",info:r.value.master};U.value=!0,$.exec.post(a).finally(()=>{U.value=!1})}else{const a={type:"cavesSwitch",info:r.value.caves};P.value=!0,$.exec.post(a).finally(()=>{P.value=!1})}},f=(d,a)=>{const A={startup:{en:"STARTUP",zh:"启动"},rollback:{en:"ROLLBACK",zh:"回档"},shutdown:{en:"SHUTDOWN",zh:"关闭"},restart:{en:"RESTART",zh:"重启"},update:{en:"UPDATE GAME",zh:"更新游戏"},reset:{en:"RESET GAME",zh:"重置游戏"},delete:{en:"DELETE GAME",zh:"删除世界"}};Ne.confirm(h.value==="zh"?`将执行 ${A[d].zh} 操作，是否继续？`:`The ${A[d].en} operation will be performed. Do you want to continue?`,h.value==="zh"?"请确认您的操作":"Please confirm your operation",{confirmButtonText:h.value==="zh"?"确定":"confirm",cancelButtonText:h.value==="zh"?"取消":"cancel",type:"warning",beforeClose:(W,i,b)=>{if(W==="confirm"){i.confirmButtonLoading=!0;const M={type:d,info:a};$.exec.post(M).then(k=>{Q(k.message),b()}).catch(()=>{}).finally(()=>{i.confirmButtonLoading=!1})}else b()}}).then(()=>{}).catch(()=>{qe(o("home.canceled"))})},G=v(!1),S=v({message:""}),te=()=>{if(S.value.message===""){X(h.value==="zh"?"请输入要宣告的内容":"Please enter the content to be announced");return}G.value=!0,$.interface.announce.post(S.value).then(d=>{Q(d.message),S.value.message=""}).finally(()=>{G.value=!1})},O=v(!1),z=v({cmd:"",world:""}),oe=()=>{if(z.value.world===""){X(h.value==="zh"?"请选择地面或洞穴":"Please select a world from ground and cave");return}if(z.value.cmd===""){X(h.value==="zh"?"请输入要执行的命令":"Please enter the command to execute");return}O.value=!0,$.interface.console.post(z.value).then(d=>{Q(d.message),z.value.cmd=""}).finally(()=>{O.value=!1})},j=v(!1),H=v(!1),ne=v([]),ze=()=>{j.value=!0,H.value=!0,Y.modInfo.get().then(d=>{ne.value=d.data}).finally(()=>{H.value=!1})};return Ae(()=>{le(),window.removeEventListener("beforeunload",le)}),(d,a)=>{const A=m("DocumentCopy"),W=m("el-icon"),i=m("el-button"),b=m("el-descriptions-item"),M=m("el-tooltip"),k=m("el-tag"),Ce=m("el-descriptions"),xe=m("el-result"),F=m("el-card"),C=m("el-col"),se=m("el-progress"),de=m("el-row"),ue=m("el-switch"),I=m("el-form-item"),R=m("el-form"),ie=m("el-input"),re=m("el-option"),Ie=m("el-select"),T=m("el-table-column"),$e=m("el-image"),Ve=m("el-table"),Se=m("el-dialog"),me=ge("copy"),ce=ge("loading");return p(),J("div",Ke,[l(de,{gutter:10},{default:e(()=>[l(C,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[_("div",Ge,n(t(o)("home.roomInfo")),1)]),default:e(()=>[c.value.roomSettingBase.name!==""?(p(),g(Ce,{key:0,column:t(x)?1:2},{default:e(()=>[l(b,{label:t(o)("home.roomName")},{default:e(()=>[N((p(),g(i,{link:"",type:"primary"},{default:e(()=>[u(n(c.value.roomSettingBase.name)+" ",1),l(W,{style:{"margin-left":"3px"}},{default:e(()=>[l(A)]),_:1})]),_:1})),[[me,c.value.roomSettingBase.name]])]),_:1},8,["label"]),l(b,{label:t(o)("home.connectionCode")},{default:e(()=>[l(M,{effect:"light",content:L.value,placement:"top"},{default:e(()=>[N((p(),g(i,{disabled:L.value==="",link:"",loading:K.value,type:"primary"},{default:e(()=>[u(n(t(o)("home.copy")),1)]),_:1},8,["disabled","loading"])),[[me,L.value]])]),_:1},8,["content"])]),_:1},8,["label"]),l(b,{label:t(o)("home.cycles")},{default:e(()=>[l(k,{type:c.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[u(n(c.value.seasonInfo.cycles),1)]),_:1},8,["type"])]),_:1},8,["label"]),l(b,{label:t(o)("home.phase")},{default:e(()=>[h.value==="en"?(p(),g(k,{key:0,type:c.value.seasonInfo.phase.en==="Failed to retrieve"?"danger":"success"},{default:e(()=>[u(n(c.value.seasonInfo.phase.en),1)]),_:1},8,["type"])):w("",!0),h.value==="zh"?(p(),g(k,{key:1,type:c.value.seasonInfo.phase.zh==="获取失败"?"danger":"success"},{default:e(()=>[u(n(c.value.seasonInfo.phase.zh),1)]),_:1},8,["type"])):w("",!0)]),_:1},8,["label"]),l(b,{label:t(o)("home.season")},{default:e(()=>[h.value==="en"?(p(),g(k,{key:0,type:c.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[u(n(c.value.seasonInfo.season.en)+" "+n(Z(c.value.seasonInfo.season.en)),1)]),_:1},8,["type"])):w("",!0),h.value==="zh"?(p(),g(k,{key:1,type:c.value.seasonInfo.cycles>-1?"success":"danger"},{default:e(()=>[u(n(c.value.seasonInfo.season.zh)+" "+n(Z(c.value.seasonInfo.season.en)),1)]),_:1},8,["type"])):w("",!0)]),_:1},8,["label"]),l(b,{label:t(o)("home.mods")},{default:e(()=>[l(k,null,{default:e(()=>[u(n(c.value.modsCount),1)]),_:1}),l(i,{link:"",type:"primary",onClick:ze,style:{"margin-left":"10px"}},{default:e(()=>[u(n(t(o)("home.modsButton")),1)]),_:1})]),_:1},8,["label"]),l(b,{label:t(o)("home.version")},{default:e(()=>[N((p(),g(k,{type:V.value.local===V.value.server?"success":"danger"},{default:e(()=>[u("("+n(V.value.local)+"/"+n(V.value.server)+")",1)]),_:1},8,["type"])),[[ce,q.value]])]),_:1},8,["label"])]),_:1},8,["column"])):w("",!0),c.value.roomSettingBase.name===""?(p(),J("div",Oe,[l(xe,{icon:"warning",title:t(o)("home.noServer")},null,8,["title"])])):w("",!0)]),_:1})]),_:1}),l(C,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{shadow:"never",style:{"min-height":"250px"}},{header:e(()=>[_("div",je,n(t(o)("home.sysInfo")),1)]),default:e(()=>[_("div",He,[l(se,{type:"dashboard",percentage:r.value.cpu,color:ee},{default:e(({percentage:s})=>[_("span",We,n(s.toFixed(1)),1),a[24]||(a[24]=_("span",{class:"percentage-label"},"CPU",-1))]),_:1},8,["percentage"]),l(se,{type:"dashboard",percentage:r.value.memory,color:ee,style:{"margin-left":"10%"}},{default:e(({percentage:s})=>[_("span",Je,n(s.toFixed(1)),1),_("span",Qe,n(t(o)("home.mem")),1)]),_:1},8,["percentage"])])]),_:1})]),_:1})]),_:1}),l(de,{gutter:10},{default:e(()=>[l(C,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{shadow:"never",style:fe(t(x)?"min-height: 300px":"min-height: 400px")},{header:e(()=>[_("div",Xe,n(t(o)("home.control")),1)]),default:e(()=>[_("div",null,[l(R,{size:"large",inline:""},{default:e(()=>[l(I,{label:d.$t("home.master")},{default:e(()=>[l(ue,{modelValue:r.value.master,"onUpdate:modelValue":a[0]||(a[0]=s=>r.value.master=s),"active-value":1,"inactive-value":0,onChange:a[1]||(a[1]=s=>ae("master")),loading:U.value,"inline-prompt":"","active-text":d.$t("home.running"),"inactive-text":d.$t("home.terminated")},null,8,["modelValue","loading","active-text","inactive-text"])]),_:1},8,["label"]),l(I,{label:d.$t("home.caves")},{default:e(()=>[l(ue,{modelValue:r.value.caves,"onUpdate:modelValue":a[2]||(a[2]=s=>r.value.caves=s),"active-value":1,"inactive-value":0,onChange:a[3]||(a[3]=s=>ae("caves")),loading:P.value,"inline-prompt":"","active-text":d.$t("home.running"),"inactive-text":d.$t("home.terminated")},null,8,["modelValue","loading","active-text","inactive-text"])]),_:1},8,["label"])]),_:1}),l(R,{size:"large"},{default:e(()=>[l(I,{label:d.$t("home.rollback")},{default:e(()=>[t(x)?(p(),g(C,{key:0},{default:e(()=>[l(i,{size:"small",disabled:r.value.master===0,onClick:a[4]||(a[4]=s=>f("rollback",1))},{default:e(()=>[u("1"+n(t(o)("home.day")),1)]),_:1},8,["disabled"]),l(i,{size:"small",disabled:r.value.master===0,onClick:a[5]||(a[5]=s=>f("rollback",2))},{default:e(()=>[u("2"+n(t(o)("home.days")),1)]),_:1},8,["disabled"]),l(i,{size:"small",disabled:r.value.master===0,onClick:a[6]||(a[6]=s=>f("rollback",3))},{default:e(()=>[u("3"+n(t(o)("home.days")),1)]),_:1},8,["disabled"])]),_:1})):w("",!0),t(x)?(p(),g(C,{key:1},{default:e(()=>[l(i,{size:"small",disabled:r.value.master===0,onClick:a[7]||(a[7]=s=>f("rollback",4))},{default:e(()=>[u("4"+n(t(o)("home.days")),1)]),_:1},8,["disabled"]),l(i,{size:"small",disabled:r.value.master===0,onClick:a[8]||(a[8]=s=>f("rollback",5))},{default:e(()=>[u("5"+n(t(o)("home.days")),1)]),_:1},8,["disabled"])]),_:1})):w("",!0),t(x)?(p(),g(C,{key:2})):w("",!0),t(x)?w("",!0):(p(),g(C,{key:3},{default:e(()=>[l(i,{size:"small",disabled:r.value.master===0,onClick:a[9]||(a[9]=s=>f("rollback",1))},{default:e(()=>[u("1"+n(t(o)("home.day")),1)]),_:1},8,["disabled"]),l(i,{size:"small",disabled:r.value.master===0,onClick:a[10]||(a[10]=s=>f("rollback",2))},{default:e(()=>[u("2"+n(t(o)("home.days")),1)]),_:1},8,["disabled"]),l(i,{size:"small",disabled:r.value.master===0,onClick:a[11]||(a[11]=s=>f("rollback",3))},{default:e(()=>[u("3"+n(t(o)("home.days")),1)]),_:1},8,["disabled"]),l(i,{size:"small",disabled:r.value.master===0,onClick:a[12]||(a[12]=s=>f("rollback",4))},{default:e(()=>[u("4"+n(t(o)("home.days")),1)]),_:1},8,["disabled"]),l(i,{size:"small",disabled:r.value.master===0,onClick:a[13]||(a[13]=s=>f("rollback",5))},{default:e(()=>[u("5"+n(t(o)("home.days")),1)]),_:1},8,["disabled"])]),_:1}))]),_:1},8,["label"])]),_:1}),l(R,{size:"large"},{default:e(()=>[l(I,null,{default:e(()=>[l(i,{type:"success",size:"default",onClick:a[14]||(a[14]=s=>f("startup",0))},{default:e(()=>[u(n(t(o)("home.startup")),1)]),_:1}),l(i,{type:"primary",size:"default",onClick:a[15]||(a[15]=s=>f("restart",0))},{default:e(()=>[u(n(t(o)("home.restart")),1)]),_:1}),l(i,{type:"warning",size:"default",onClick:a[16]||(a[16]=s=>f("update",0))},{default:e(()=>[u(n(t(o)("home.update")),1)]),_:1})]),_:1}),l(I,null,{default:e(()=>[l(i,{type:"warning",size:"default",onClick:a[17]||(a[17]=s=>f("shutdown",0))},{default:e(()=>[u(n(t(o)("home.shutdown")),1)]),_:1}),l(i,{type:"danger",size:"default",onClick:a[18]||(a[18]=s=>f("reset",0))},{default:e(()=>[u(n(t(o)("home.reset")),1)]),_:1}),l(M,{effect:"light",content:d.$t("home.deleteTips"),placement:"top"},{default:e(()=>[l(i,{color:"#626aef",size:"default",onClick:a[19]||(a[19]=s=>f("delete",0))},{default:e(()=>[u(n(t(o)("home.delete")),1)]),_:1})]),_:1},8,["content"])]),_:1})]),_:1})])]),_:1},8,["style"])]),_:1}),l(C,{span:12,lg:12,md:12,sm:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[l(F,{shadow:"never",style:fe(t(x)?"min-height: 300px":"min-height: 400px")},{header:e(()=>[_("div",Ye,n(t(o)("home.interface")),1)]),default:e(()=>[_("div",null,[l(R,{"label-position":"top"},{default:e(()=>[l(I,{label:d.$t("home.announcement")},{default:e(()=>[l(ie,{modelValue:S.value.message,"onUpdate:modelValue":a[20]||(a[20]=s=>S.value.message=s),onKeyup:ve(te,["enter"])},{append:e(()=>[l(i,{loading:G.value,onClick:te},{default:e(()=>[u(n(t(o)("home.send")),1)]),_:1},8,["loading"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(I,{label:"Console"},{default:e(()=>[l(ie,{modelValue:z.value.cmd,"onUpdate:modelValue":a[22]||(a[22]=s=>z.value.cmd=s),onKeyup:ve(oe,["enter"])},{prepend:e(()=>[l(Ie,{modelValue:z.value.world,"onUpdate:modelValue":a[21]||(a[21]=s=>z.value.world=s),style:{width:"115px"}},{default:e(()=>[l(re,{disabled:r.value.master===0,label:d.$t("home.master"),value:"master"},null,8,["disabled","label"]),l(re,{disabled:r.value.caves===0,label:d.$t("home.caves"),value:"caves"},null,8,["disabled","label"])]),_:1},8,["modelValue"])]),append:e(()=>[l(i,{loading:O.value,onClick:oe},{default:e(()=>[u(n(t(o)("home.execute")),1)]),_:1},8,["loading"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["style"])]),_:1})]),_:1}),l(Se,{modelValue:j.value,"onUpdate:modelValue":a[23]||(a[23]=s=>j.value=s),"close-on-click-modal":!1,title:t(o)("home.modsTable.title"),width:"80%"},{default:e(()=>[N((p(),g(Ve,{data:ne.value,"tooltip-effect":"light",height:"70vh",border:"",style:{width:"100%"},size:"small"},{default:e(()=>[l(T,{prop:"name",label:t(o)("home.modsTable.name")},null,8,["label"]),l(T,{prop:"preview_url",label:t(o)("home.modsTable.pics"),width:"120px"},{default:e(s=>[l($e,{style:{width:"100px",height:"100px"},src:s.row.preview_url,fit:"fill"},null,8,["src"])]),_:1},8,["label"]),l(T,{prop:"size",label:t(o)("home.modsTable.size")},{default:e(s=>[u(n(t(Me)(s.row.size)),1)]),_:1},8,["label"]),l(T,{prop:"id",label:t(o)("home.modsTable.id")},null,8,["label"]),l(T,{prop:"tags",label:t(o)("home.modsTable.tags")},{default:e(s=>[(p(!0),J(Fe,null,Re(s.row.tags,Te=>(p(),g(k,{style:{margin:"0 5px 5px 0"}},{default:e(()=>[u(n(Te.display_name),1)]),_:2},1024))),256))]),_:1},8,["label"])]),_:1},8,["data"])),[[ce,H.value]])]),_:1},8,["modelValue","title"])])}}},al=Be(Ze,[["__scopeId","data-v-35ea82a8"]]);export{al as default};
